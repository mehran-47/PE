var GraphReference=(function(){'use strict';return{'angularaxis':{'fields':{'domain':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'endpadding':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'range':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showline':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showticklabels':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickorientation':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticksuffix':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'annotation':{'fields':{'align':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'arrowcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'arrowhead':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'arrowsize':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'arrowwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ax':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ay':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'bgcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'bordercolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'borderpad':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'borderwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'font':{'types':{'object':'object'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showarrow':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'text':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'textangle':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'x':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xanchor':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xref':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'y':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'yanchor':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'yref':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'annotations':{'fields':{},'flatten':true,'type':'array'},'area':{'fields':{'angularaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'marker':{'types':{'object':'object'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'r':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'radialaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'showlegend':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'stream':{'types':{'object':'object'}},'t':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'bar':{'fields':{'error_x':{'types':{'object':'object'}},'error_y':{'types':{'object':'object'}},'marker':{'types':{'object':'object'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'orientation':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'r':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'showlegend':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'stream':{'types':{'object':'object'}},'t':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'text':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'x':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'xaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xsrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'y':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'yaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ysrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}}}},'box':{'fields':{'boxmean':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'boxpoints':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'fillcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'jitter':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'line':{'types':{'object':'object'}},'marker':{'types':{'object':'object'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'orientation':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'pointpos':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showlegend':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'stream':{'types':{'object':'object'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'whiskerwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'x':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'x0':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xsrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'y':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'yaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ysrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}}}},'colorbar':{'fields':{'bgcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'bordercolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'borderwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'dtick':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'exponentformat':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'len':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'lenmode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'nticks':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'outlinecolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'outlinewidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showexponent':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showticklabels':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'thickness':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'thicknessmode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tick0':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickangle':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickfont':{'types':{'object':'object'}},'ticklen':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickmode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticks':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticktext':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'tickvals':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'tickwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'title':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'titlefont':{'types':{'object':'object'}},'titleside':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'x':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xanchor':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xpad':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'y':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'yanchor':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ypad':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'contour':{'fields':{'autocontour':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'colorbar':{'types':{'object':'object'}},'colorscale':{'types':{'array':'style','string':'style'}},'autocolorscale':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'connectgaps':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'contours':{'types':{'object':'object'}},'dx':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'dy':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'line':{'types':{'object':'object'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'ncontours':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'reversescale':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showlegend':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'showscale':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'stream':{'types':{'object':'object'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'x':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'x0':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xtype':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'y':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'y0':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'yaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ytype':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'z':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'zauto':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'zmax':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'zmin':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'contours':{'fields':{'coloring':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'end':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showlines':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'size':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'start':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}}}},'data':{'fields':{},'flatten':true,'type':'array'},'error_x':{'fields':{'array':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'arrayminus':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'color':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'copy_ystyle':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'symmetric':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'thickness':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'value':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'valueminus':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'width':{'types':{'array':'data','boolean':'size','number':'size','string':'size'}}}},'error_y':{'fields':{'array':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'arrayminus':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'color':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'symmetric':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'thickness':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'value':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'valueminus':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'width':{'types':{'array':'data','boolean':'size','number':'size','string':'size'}}}},'error_z':{'fields':{'array':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'arrayminus':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'color':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'symmetric':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'thickness':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'value':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'valueminus':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'width':{'types':{'array':'data','boolean':'size','number':'size','string':'size'}}}},'figure':{'fields':{'data':{'types':{'object':'object'}},'layout':{'types':{'object':'object'}}}},'font':{'fields':{'color':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'family':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'outlinecolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'size':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}}}},'heatmap':{'fields':{'colorbar':{'types':{'object':'object'}},'colorscale':{'types':{'array':'style','string':'style'}},'autocolorscale':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'connectgaps':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'dx':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'dy':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'reversescale':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showlegend':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'showscale':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'stream':{'types':{'object':'object'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'x':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'x0':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xtype':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'y':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'y0':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'yaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ytype':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'z':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'zauto':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'zmax':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'zmin':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'zsmooth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}}}},'histogram':{'fields':{'autobinx':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'autobiny':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'error_x':{'types':{'object':'object'}},'error_y':{'types':{'object':'object'}},'histnorm':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'marker':{'types':{'object':'object'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'nbinsx':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'nbinsy':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showlegend':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'stream':{'types':{'object':'object'}},'text':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'x':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'xaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xbins':{'types':{'object':'object'}},'xsrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'y':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'yaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ybins':{'types':{'object':'object'}},'ysrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}}}},'histogram2d':{'fields':{'autobinx':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'autobiny':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'colorbar':{'types':{'object':'object'}},'colorscale':{'types':{'array':'style','string':'style'}},'histnorm':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'nbinsx':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'nbinsy':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'reversescale':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showlegend':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'showscale':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'stream':{'types':{'object':'object'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'x':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'xaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xbins':{'types':{'object':'object'}},'xsrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'y':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'yaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ybins':{'types':{'object':'object'}},'ysrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'zauto':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'zmax':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'zmin':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'zsmooth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}}}},'histogram2dcontour':{'fields':{'autobinx':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'autobiny':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'autocontour':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'colorbar':{'types':{'object':'object'}},'colorscale':{'types':{'array':'style','string':'style'}},'contours':{'types':{'object':'object'}},'histnorm':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'line':{'types':{'object':'object'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'nbinsx':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'nbinsy':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ncontours':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'reversescale':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showlegend':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'showscale':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'stream':{'types':{'object':'object'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'x':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'xaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xbins':{'types':{'object':'object'}},'xsrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'y':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'yaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ybins':{'types':{'object':'object'}},'ysrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'zauto':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'zmax':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'zmin':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'layout':{'fields':{'angularaxis':{'types':{'object':'object'}},'annotations':{'types':{'object':'object'}},'autosize':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'bargap':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'bargroupgap':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'barmode':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'barnorm':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'boxgap':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'boxgroupgap':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'boxmode':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'direction':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'dragmode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'font':{'types':{'object':'object'}},'height':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'hidesources':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'hovermode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'legend':{'types':{'object':'object'}},'margin':{'types':{'object':'object'}},'orientation':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'paper_bgcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'plot_bgcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'radialaxis':{'types':{'object':'object'}},'scene':{'types':{'object':'object'}},'separators':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showlegend':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'title':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'titlefont':{'types':{'object':'object'}},'width':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xaxis':{'types':{'object':'object'}},'yaxis':{'types':{'object':'object'}}}},'legend':{'fields':{'bgcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'bordercolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'borderwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'font':{'types':{'object':'object'}},'traceorder':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'x':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'xanchor':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xref':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'y':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'yanchor':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'yref':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}}}},'line':{'fields':{'color':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'dash':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'outliercolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'outlierwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'shape':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'smoothing':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'width':{'types':{'array':'data','boolean':'size','number':'size','string':'size'}}}},'margin':{'fields':{'autoexpand':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'b':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'l':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'pad':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'r':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'t':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'marker':{'fields':{'cauto':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'cmax':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'cmin':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'color':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'colorscale':{'types':{'array':'style','string':'style'}},'line':{'types':{'object':'object'}},'maxdisplayed':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'outliercolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'size':{'types':{'array':'data','boolean':'size','number':'size','string':'size'}},'sizemode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'sizeref':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'symbol':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}}}},'radialaxis':{'fields':{'domain':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'endpadding':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'orientation':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'range':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showline':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showticklabels':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticklen':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickorientation':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticksuffix':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'scatter':{'fields':{'connectgaps':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'error_x':{'types':{'object':'object'}},'error_y':{'types':{'object':'object'}},'fill':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'fillcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'line':{'types':{'object':'object'}},'marker':{'types':{'object':'object'}},'mode':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'opacity':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'r':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'showlegend':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'stream':{'types':{'object':'object'}},'t':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'text':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'textfont':{'types':{'object':'object'}},'textposition':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'x':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'xaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xsrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'y':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'yaxis':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'ysrc':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}}}},'scatter3d':{'fields':{'error_x':{'types':{'object':'object'}},'error_y':{'types':{'object':'object'}},'error_z':{'types':{'object':'object'}},'line':{'types':{'object':'object'}},'marker':{'types':{'object':'object'}},'mode':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'scene':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'stream':{'types':{'object':'object'}},'text':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'textposition':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'x':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'y':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'z':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}}}},'scene':{'fields':{'bgcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'cameraposition':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'xaxis':{'types':{'object':'object'}},'yaxis':{'types':{'object':'object'}},'zaxis':{'types':{'object':'object'}}}},'stream':{'fields':{'maxpoints':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'token':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'surface':{'fields':{'colorscale':{'types':{'array':'style','string':'style'}},'name':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'scene':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'stream':{'types':{'object':'object'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'visible':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'x':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'y':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'z':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}}}},'textfont':{'parents':['font']},'tickfont':{'parents':['font']},'titlefont':{'parents':['font']},'xaxis':{'fields':{'anchor':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'autorange':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'backgroundcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'domain':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'dtick':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'exponentformat':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'gridcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'gridwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'linecolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'linewidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'mirror':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'nticks':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'overlaying':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'position':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'range':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'rangemode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showbackground':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showexponent':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showgrid':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showline':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showspikes':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showticklabels':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'side':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'spikesides':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'spikethickness':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tick0':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickangle':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickfont':{'types':{'object':'object'}},'ticklen':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickmode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticks':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticktext':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'tickvals':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'tickwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'title':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'titlefont':{'types':{'object':'object'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'zeroline':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'zerolinecolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'zerolinewidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}}}},'xbins':{'fields':{'end':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'size':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'start':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'yaxis':{'fields':{'anchor':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'autorange':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'backgroundcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'domain':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'dtick':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'exponentformat':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'gridcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'gridwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'linecolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'linewidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'mirror':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'nticks':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'overlaying':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'position':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'range':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'rangemode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showbackground':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showexponent':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showgrid':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showline':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showspikes':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showticklabels':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'side':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'spikesides':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'spikethickness':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tick0':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickangle':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickfont':{'types':{'object':'object'}},'ticklen':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickmode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticks':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticktext':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'tickvals':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'tickwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'title':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'titlefont':{'types':{'object':'object'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'zeroline':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'zerolinecolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'zerolinewidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}}}},'ybins':{'fields':{'end':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'size':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'start':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}}}},'zaxis':{'fields':{'anchor':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'autorange':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'backgroundcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'domain':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'dtick':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'exponentformat':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'gridcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'gridwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'linecolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'linewidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'mirror':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'nticks':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'overlaying':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'position':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'range':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'rangemode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showbackground':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showexponent':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showgrid':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showline':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showspikes':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'showticklabels':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'side':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'spikesides':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'spikethickness':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tick0':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickangle':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickcolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickfont':{'types':{'object':'object'}},'ticklen':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'tickmode':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticks':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'ticktext':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'tickvals':{'types':{'array':'data','boolean':'data','number':'data','string':'data'}},'tickwidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'title':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'titlefont':{'types':{'object':'object'}},'type':{'types':{'array':'plot_info','boolean':'plot_info','number':'plot_info','string':'plot_info'}},'zeroline':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'zerolinecolor':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}},'zerolinewidth':{'types':{'array':'data','boolean':'style','number':'style','string':'style'}}}}};})();var Themes=(function(GraphReference){'use strict';var themes={};themes.ENDPOINT='/stylethemes/';themes.ALL_CATEGORIES=['style','plot_info','data','size'];themes.CARTESIAN_AXES=['xaxis','yaxis','zaxis'];themes.TILE_AXIS_UPDATE={title:'',showticklabels:false,tickmode:'auto'};themes.MAX_DATA_POINTS_BY_TYPE={heatmap:50,contour:50,surface:50,histogram:2000,histogram2d:2000,histogram2dcontour:2000,other:200};themes.DEFAULT_THEME_ID_LOCAL=-1;themes.SIZE_SCALE=4;themes.themeArray=null;themes.MARGIN_RESERVATION_NAME='themes';themes.THEME_BAR_OPEN_DELAY=800;themes.RETILE_DELAY=800;themes.reTileLock=false;themes.reTileQueue=[];themes.IGNORE_PATTERNS=[/^(?:x|y|z|(?:angular)|(?:radial))axis\d{0,2}\.range\[\d\]$/,/^(?:x|y|z|(?:angular)|(?:radial))axis\.autorange$/,/^autosize$/,/^(?:x|y|z|(?:angular)|(?:radial))axis\d{0,2}\.title$/,/^(?:x|y|z|(?:angular)|(?:radial))axis\d{0,2}\.titlefont\./,/^(?:x|y|z|(?:angular)|(?:radial))axis\d{0,2}\.showticklabels$/,/^(?:x|y|z|(?:angular)|(?:radial))axis\d{0,2}\.exponentformat$/,/^(?:x|y|z|(?:angular)|(?:radial))axis\d{0,2}\.showexponent$/,/^(?:x|y|z|(?:angular)|(?:radial))axis\d{0,2}\.tickfont\./,/^(?:x|y|z|(?:angular)|(?:radial))axis\d{0,2}\.tickangle$/,/^title$/,/^font\./,/^titlefont\./,/^annotations\[(?:-1|\d{1,3})\]\./,/^margin\./,/^width$/,/^height$/,/^separators$/];themes.enforceThese=function(args){if(args===undefined){throw new Error('No args array found.');}
function areTypes(types){if(types===undefined||!Array.isArray(types)){throw new Error('No types array found.');}
if(args.length!==types.length){throw new Error('Got '+args.length+' args. Expected '+types.length+'.');}
var allowedTypes,argType;for(var i=0;i<args.length;i++){allowedTypes=types[i].split('|');if(!args[i]){argType='undefined';}else{argType=Array.isArray(args[i])?'array':typeof args[i];}
if(allowedTypes.indexOf(argType)===-1){throw new Error('Arg '+i+' was type '+argType+'. Expecting '+types[i]+'.');}}}
function areIn(container){if(typeof container!=='object'){throw new Error('The container given is not an object.');}
if(Array.isArray(container)){args.forEach(function(arg){if(container.indexOf(arg)===-1){throw new Error('String '+arg+' was not in the given container.');}});}else{args.forEach(function(arg){if(!container.hasOwnProperty(arg)){throw new Error('String '+arg+' was not in the given container.');}});}}
return{areTypes:areTypes,areIn:areIn};};themes.enforceThis=function(arg){var args=[arg];function isType(type){themes.enforceThese(args).areTypes([type]);}
function isIn(container){themes.enforceThese(args).areIn(container);}
function isTrue(){if(!arg){throw new Error('Condition wasn\'t met.');}}
function hasOwnProperties(properties){if(!Array.isArray(properties)){throw new Error('properties must be an array');}else if(typeof arg!=='object'||(typeof arg==='object'&&Array.isArray(arg))){throw new Error('cannot test properties of non-object or array');}else{for(var i=0;i<properties.length;i+=1){if(!arg.hasOwnProperty(properties[i])){throw new Error('object did not have own property '+properties[i]);}}}}
return{isType:isType,isIn:isIn,isTrue:isTrue,hasOwnProperties:hasOwnProperties};};themes.addThemeData=function(themeArray){return new Promise(function(fulfill){themeArray.forEach(function(themeObj){themeObj.themeTypes=themes.getThemeTypes(themeObj.baseGraphObj.data);themes.themeArray.unshift(themeObj);});fulfill();});};themes.getMergedBaseGraphObj=function(userBaseGraphObj,themeBaseGraphObj){var updateBaseGraphObj,mergedBaseGraphObj,mergedDatum,mergedAnnotation;updateBaseGraphObj=themes.getUpdateGraphObj(userBaseGraphObj,themeBaseGraphObj,['style','size'],GraphReference);mergedBaseGraphObj=themes.getNestedMerge(userBaseGraphObj,updateBaseGraphObj);mergedBaseGraphObj.data=[];userBaseGraphObj.data.forEach(function(userDatum,i){if(i<updateBaseGraphObj.data.length){mergedDatum=themes.getNestedMerge(userDatum,updateBaseGraphObj.data[i]);}else{mergedDatum=userDatum;}
mergedBaseGraphObj.data.push(mergedDatum);});mergedBaseGraphObj.layout.annotations=[];if(userBaseGraphObj.layout.annotations){userBaseGraphObj.layout.annotations.forEach(function(annotation,i){if(Array.isArray(updateBaseGraphObj.layout.annotations)&&i<updateBaseGraphObj.layout.annotations.length){mergedAnnotation=themes.getNestedMerge(annotation,updateBaseGraphObj.layout.annotations[i]);}else{mergedAnnotation=annotation;}
mergedBaseGraphObj.layout.annotations.push(mergedAnnotation);});}
return mergedBaseGraphObj;};themes.getThemeTile=function(baseGraphObj,themeObj){themes.enforceThese(arguments).areTypes(['object','object']);var themeBaseGraphObj,tileBaseGraphObj;themeBaseGraphObj=themeObj.baseGraphObj;tileBaseGraphObj=themes.getMergedBaseGraphObj(baseGraphObj,themeBaseGraphObj);for(var field in tileBaseGraphObj.layout){if(tileBaseGraphObj.layout.hasOwnProperty(field)){if(themes.isAxisField(field)){tileBaseGraphObj.layout[field]=themes.getNestedMerge(tileBaseGraphObj.layout[field],themes.TILE_AXIS_UPDATE);}}}
tileBaseGraphObj.layout=themes.getScaledGraphObj(tileBaseGraphObj.layout,'layout',themes.SIZE_SCALE,GraphReference);tileBaseGraphObj.data=themes.getScaledGraphArray(tileBaseGraphObj.data,'data',themes.SIZE_SCALE,GraphReference);var graphObj={data:tileBaseGraphObj.data,layout:tileBaseGraphObj.layout,};var options={tileClass:'themes__thumb'};var plotTile=Plotly.Snapshot.clone(graphObj,options);plotTile.td.setAttribute('tileID',themeObj.idLocal);return plotTile;};themes.getScaledGraphItem=function(graphItem,graphItemType,scale,reference){themes.enforceThese(arguments).areTypes(['object|array','string','number','object']);themes.enforceThis(graphItemType).isIn(reference);var scaledItem;if(Array.isArray(graphItem)){scaledItem=themes.getScaledGraphArray(graphItem,graphItemType,scale,reference);}else{scaledItem=themes.getScaledGraphObj(graphItem,graphItemType,scale,reference);}
return scaledItem;};themes.getScaledGraphArray=function(graphArray,graphArrayType,scale,reference){themes.enforceThese(arguments).areTypes(['array','string','number','object']);themes.enforceThis(graphArrayType).isIn(reference);var scaledArray=[],childType;graphArray.forEach(function(child){childType=themes.getArrayChildType(child,graphArrayType);scaledArray.push(themes.getScaledGraphObj(child,childType,scale,reference));});return scaledArray;};themes.getScaledGraphObj=function(graphObj,graphObjType,scale,reference){themes.enforceThese(arguments).areTypes(['object','string','number','object']);themes.enforceThis(graphObjType).isIn(reference);var scaledObj={},fullReference,fieldCategories,parsedField;fullReference=themes.getFullReference(graphObjType,reference);for(var field in graphObj){if(graphObj.hasOwnProperty(field)){if(fullReference.fields.hasOwnProperty(field)){if(fullReference.fields[field].type==='object'||fullReference.fields[field].type==='array'){scaledObj[field]=themes.getScaledGraphItem(graphObj[field],field,scale,reference);}else{fieldCategories=themes.getFieldCategories(field,fullReference);if(fieldCategories.indexOf('size')>-1){if(Array.isArray(graphObj[field])){scaledObj[field]=themes.getScaledArray(graphObj[field],scale);}else{scaledObj[field]=themes.getScaledValue(graphObj[field],scale);}}else{scaledObj[field]=graphObj[field];}}}else if(graphObjType==='layout'&&themes.isEnumeratedAxis(field)){parsedField=themes.parseEnumeratedAxis(field);scaledObj[field]=themes.getScaledGraphItem(graphObj[field],parsedField.name,scale,reference);}}}
return scaledObj;};themes.getFieldCategories=function(field,fullParentReference){var fieldCategories=[];for(var type in fullParentReference.fields[field].types){if(fullParentReference.fields[field].types.hasOwnProperty(type)){fieldCategories.push(fullParentReference.fields[field].types[type]);}}
return fieldCategories;};themes.getScaledArray=function getScaledArray(arr,scale){var scaledArray,scaleArrayOrValue=function(arrayOrValue){if(Array.isArray(arrayOrValue)){return getScaledArray(arrayOrValue,scale);}else{return themes.getScaledValue(arrayOrValue,scale);}};scaledArray=arr.map(scaleArrayOrValue);return scaledArray;};themes.getScaledValue=function(value,scale){var parsedValue=parseFloat(value);if(!isNaN(parsedValue)){return parsedValue/scale;}else{return value;}};themes.getDownSampledGraphData=function(data,maxPointsByType){var newData=[],themeType,filteredData,maxPoints;filteredData=themes.getFilteredArray(data,'data',['data'],GraphReference);filteredData.forEach(function(datum,index){themeType=themes.getThemeType(data[index]);maxPoints=maxPointsByType[themeType]||maxPointsByType.other;themes.downSampleAllFields(datum,maxPoints);});for(var i=0;i<data.length;i+=1){newData.push(themes.getNestedMerge(data[i],filteredData[i]));}
return newData;};themes.downSampleAllFields=function downSampleAllFields(obj,maxPoints){for(var field in obj){if(obj.hasOwnProperty(field)){if(Array.isArray(obj[field])&&obj[field].length){obj[field]=themes.getDownSampledArray(obj[field],maxPoints);if(Array.isArray(obj[field][0])){for(var i=0;i<obj[field].length;i+=1){obj[field][i]=themes.getDownSampledArray(obj[field][i],maxPoints);}}}else if(obj[field]!==null&&typeof obj[field]==='object'){downSampleAllFields(obj[field],maxPoints);}}}};themes.getDownSampledArray=function(arr,maxPoints){themes.enforceThese(arguments).areTypes(['array','number']);var downSampleRate;function downSample(downSampledArray,currentValue,index){if(index%downSampleRate===0){downSampledArray.push(currentValue);}
return downSampledArray;}
downSampleRate=Math.ceil(arr.length/maxPoints);return arr.reduce(downSample,[]);};themes.getThemeTileDivIdLocal=function(themeTileDiv){return parseInt(themeTileDiv.getAttribute('tileID'));};themes.insertThemeTileDivIntoThemesList=function(newThemeTileDiv,themesList){var newIdLocal=themes.getThemeTileDivIdLocal(newThemeTileDiv),themesListItems=themesList.children,referenceIndex=null,oldThemeTileDiv,oldIdLocal,li;if(themesListItems.length===1){referenceIndex=1;}else{for(var i=1;i<themesListItems.length;i+=1){oldThemeTileDiv=themesListItems[i].querySelector('.themes__thumb');oldIdLocal=themes.getThemeTileDivIdLocal(oldThemeTileDiv);if(oldIdLocal===newIdLocal){throw new Error('Cannot add theme to list if it\'s already there!');}else if(oldIdLocal<newIdLocal){referenceIndex=i;break;}}}
if(referenceIndex===null){referenceIndex=themesListItems.length;}
li=document.createElement('li');li.appendChild(newThemeTileDiv);themesList.insertBefore(li,themesListItems[referenceIndex]);};themes.addThemeTileDivUserInterface=function(workspaceDiv,themeTileDiv,themeObj){var themeCaption,deleteThemeButton;themeCaption=$('<div />',{'class':'themes__theme-caption','text':themeObj.name});deleteThemeButton=$('<button />',{'class':'close','type':'button','html':'&times;','themeId':themeObj.idLocal});deleteThemeButton.click(function(event){event.stopPropagation();themes.deleteClick(this,workspaceDiv,themeObj);});themeCaption.appendTo(themeTileDiv);if(!themeObj.isDefault){deleteThemeButton.appendTo(themeTileDiv);}
$(themeTileDiv).click(function(){themes.applyClick(Tabs.get(),themeObj);});};themes.makeThemeTileDivStatic=function(themeTileDiv){var plotLinkContainer,modebar;$(themeTileDiv).find('.plot-container').removeClass('is-mainsite');plotLinkContainer=themeTileDiv.querySelector('.js-plot-link-container');Plotly.Lib.removeElement(plotLinkContainer);modebar=themeTileDiv.querySelector('.modebar');Plotly.Lib.removeElement(modebar);};themes.downSampleAndCopyCurrentGraph=function(graphDiv){var dataCategories=['data'],complimentCategories=themes.getComplimentCategories(dataCategories),downSampledData,complimentData;return new Promise(function(fulfill){downSampledData=themes.getDownSampledGraphData(graphDiv.data,themes.MAX_DATA_POINTS_BY_TYPE);complimentData=themes.getFilteredItem(graphDiv.data,'data',complimentCategories,GraphReference);Tabs.get().themes.downSampledUserBaseGraphObj={data:$.extend(true,[],downSampledData,complimentData),layout:$.extend(true,{},graphDiv.layout)};fulfill(Tabs.get().themes.downSampledUserBaseGraphObj);});};themes.getThemeTileDiv=function(graphDiv,themeObj){var themeTile;themes.enforceThis(themeObj).isType('object');themes.enforceThis(themeObj.baseGraphObj).isType('object');themeTile=themes.getThemeTile(Tabs.get().themes.downSampledUserBaseGraphObj,themeObj);Plotly.plot(themeTile.td,themeTile.data,themeTile.layout,themeTile.config);themeTile.td.state='on';return themeTile.td;};themes.getThemeObjByIdLocal=function(idLocal,themeArray){for(var i=0;i<themeArray.length;i+=1){if(themeArray[i].idLocal===idLocal){return themeArray[i];}}};themes.getThemeTileDivByIdLocal=function(idLocal,themesList){var themesListItems=themesList.children,themeTileDiv;for(var i=1;i<themesListItems.length;i+=1){themeTileDiv=themesListItems[i].querySelector('.themes__thumb');if(themes.getThemeTileDivIdLocal(themeTileDiv)===idLocal){return themeTileDiv;}}};themes.getApplicableThemes=function(graphDiv,themeArray){var userThemeTypes=themes.getThemeTypes(graphDiv.data),applicableThemeArray=[];themeArray.forEach(function(themeObj){for(var i=0;i<themeObj.themeTypes.length;i+=1){if(userThemeTypes.indexOf(themeObj.themeTypes[i])>-1){applicableThemeArray.unshift(themeObj);break;}}});return applicableThemeArray;};themes.getUpdateGraphObj=function(userBaseGraphObj,themeBaseGraphObj,categories,reference){themes.enforceThese(arguments).areTypes(['object','object','array','object']);var updateBaseGraphObj={},userData=userBaseGraphObj.data,themeData=themeBaseGraphObj.data,userLayout=userBaseGraphObj.layout,themeLayout=themeBaseGraphObj.layout;updateBaseGraphObj.data=themes.getUpdateData(themeData,userData,categories,reference);updateBaseGraphObj.layout=themes.getUpdateLayout(themeLayout,userLayout,categories,reference);return updateBaseGraphObj;};themes.getUpdateData=function(themeData,userData,categories,reference){themes.enforceThese(arguments).areTypes(['array','array','array','object']);var updateData=[],usedIndices=[],resultDatum,userDatumType,themeDatumType;for(var i=0;i<userData.length;i++){resultDatum={};if(userData[i].visible===false){updateData.push({});}else{userDatumType=themes.getThemeType(userData[i]);for(var j=0;j<themeData.length;j++){themeDatumType=themes.getThemeType(themeData[j]);if(usedIndices.indexOf(j)>-1||userDatumType!==themeDatumType||themeData[j].visible===false){continue;}
usedIndices.push(j);resultDatum=themes.getSafeItem(themeData[j],userData[i],userDatumType,categories,reference);break;}
updateData.push(resultDatum);}}
return updateData;};themes.getUpdateLayout=function(themeLayout,userLayout,categories,reference){themes.enforceThese(arguments).areTypes(['object','object','array','object']);var rewiredThemeLayout=themes.getNestedMerge({},themeLayout),updateAnnotations,updateLayout,axisMaps;axisMaps=themes.getSafeAxisMappings(userLayout,themeLayout);axisMaps.forEach(function(axisMap){if(axisMap.new){rewiredThemeLayout[axisMap.new]=rewiredThemeLayout[axisMap.old];}
delete rewiredThemeLayout[axisMap.old];});if(Array.isArray(userLayout.annotations)&&Array.isArray(themeLayout.annotations)){updateAnnotations=themes.getUpdateAnnotations(userLayout.annotations,themeLayout.annotations,categories,reference);}
updateLayout=themes.getSafeItem(rewiredThemeLayout,userLayout,'layout',categories,reference);updateLayout.annotations=updateAnnotations;if(!updateAnnotations){delete updateLayout.annotations;}
return updateLayout;};themes.getUpdateAnnotations=function(userAnnotations,themeAnnotations,categories,reference){themes.enforceThese(arguments).areTypes(['array','array','array','object']);var updateAnnotations=[];for(var i=0;i<userAnnotations.length;i++){if(i<themeAnnotations.length){updateAnnotations.push(themes.getSafeItem(themeAnnotations[i],userAnnotations[i],'annotation',categories,reference));}}
return updateAnnotations;};themes.getComplimentCategories=function(categories){var complimentCategories=[];themes.ALL_CATEGORIES.forEach(function(type){if(categories.indexOf(type)===-1){complimentCategories.push(type);}});return complimentCategories;};themes.getSafeItem=function(themeGraphItem,userGraphItem,graphItemType,categories,reference){themes.enforceThese(arguments).areTypes(['object','object','string','array','object']);themes.enforceThis(graphItemType).isIn(reference);var safeItem={},categoriesCompliment,filteredThemeItem,filteredUserItem;filteredThemeItem=themes.getFilteredItem(themeGraphItem,graphItemType,categories,reference);categoriesCompliment=themes.getComplimentCategories(categories);filteredUserItem=themes.getFilteredItem(userGraphItem,graphItemType,categoriesCompliment,reference);safeItem=themes.getNestedMerge(safeItem,filteredThemeItem);safeItem=themes.getNestedMerge(safeItem,filteredUserItem);safeItem=themes.getFilteredItem(safeItem,graphItemType,categories,reference);return safeItem;};themes.getSafeAxisMappings=function(userLayout,themeLayout){var userField,themeField,parsedUserAxesFields={},parsedThemeAxesFields={},newMapping,axisMaps=[];for(userField in userLayout){if(userLayout.hasOwnProperty(userField)&&(themes.isAxisField(userField)||themes.isEnumeratedAxis(userField))){parsedUserAxesFields[userField]=themes.parseEnumeratedAxis(userField);}}
for(themeField in themeLayout){if(themeLayout.hasOwnProperty(themeField)&&(themes.isAxisField(themeField)||themes.isEnumeratedAxis(themeField))){parsedThemeAxesFields[themeField]=themes.parseEnumeratedAxis(themeField);}}
for(themeField in parsedThemeAxesFields){if(parsedThemeAxesFields.hasOwnProperty(themeField)){newMapping={new:false,old:themeField};for(userField in parsedUserAxesFields){if(parsedUserAxesFields.hasOwnProperty(userField)){if(parsedUserAxesFields[userField].name===parsedThemeAxesFields[themeField].name&&parsedUserAxesFields[userField].number===parsedThemeAxesFields[themeField].number){newMapping.new=userField;}}}
if(newMapping.new!==newMapping.old){axisMaps.push(newMapping);}}}
return axisMaps;};themes.getFullReference=function getFullReference(graphObjType,reference){themes.enforceThese(arguments).areTypes(['string','object']);themes.enforceThis(graphObjType).isIn(reference);var fullReference={},parentReference,parents;parents=reference[graphObjType].parents||[];parents.forEach(function(parent){if(reference[parent].parents){throw new Error('Multi-level inheritance not yet supported.');}
parentReference=getFullReference(parent,reference);fullReference=themes.getNestedMerge(fullReference,parentReference);});fullReference.parents=reference[graphObjType].parents||[];fullReference.type=reference[graphObjType].type||'object';fullReference.fields=themes.getNestedMerge(fullReference.fields||{},reference[graphObjType].fields||{});for(var field in fullReference.fields){if(fullReference.fields.hasOwnProperty(field)&&fullReference.fields[field].types.object==='object'){fullReference.fields[field]=getFullReference(field,reference);}}
return fullReference;};themes.getNestedMerge=function getNestedMerge(oldObj,newObj){themes.enforceThese(arguments).areTypes(['object','object']);var mergedObj={},oldObjKeys=Object.keys(oldObj),newObjKeys=Object.keys(newObj),i,key;for(i=0;i<oldObjKeys.length;i+=1){key=oldObjKeys[i];mergedObj[key]=oldObj[key];}
for(i=0;i<newObjKeys.length;i+=1){key=newObjKeys[i];if(oldObjKeys.indexOf(key)===-1){mergedObj[key]=newObj[key];}else if(!Array.isArray(newObj[key])&&typeof newObj[key]==='object'){mergedObj[key]=getNestedMerge(oldObj[key],newObj[key]);}else{mergedObj[key]=newObj[key];}}
return mergedObj;};themes.getThemeType=function(datum){themes.enforceThis(datum).isType('object');var themeType='scatter';if(datum.hasOwnProperty('type')&&datum.type!==undefined){themeType=datum.type;}
return themeType;};themes.getThemeTypes=function(userData){if(userData===undefined){return[];}
themes.enforceThis(userData).isType('array');var themeType,themeTypes=[];for(var i=0;i<userData.length;i++){if(userData[i].visible!==false){themeType=themes.getThemeType(userData[i]);if(themeTypes.indexOf(themeType)===-1){themeTypes.push(themeType);}}}
return themeTypes;};themes.getFilteredItem=function(graphItem,graphItemType,categories,reference){themes.enforceThese(arguments).areTypes(['object|array','string','array','object']);themes.enforceThis(graphItemType).isIn(reference);var filteredItem;if(Array.isArray(graphItem)){filteredItem=themes.getFilteredArray(graphItem,graphItemType,categories,reference);}else{filteredItem=themes.getFilteredObj(graphItem,graphItemType,categories,reference);}
return filteredItem;};themes.getFilteredObj=function(graphObj,graphObjType,categories,reference){themes.enforceThese(arguments).areTypes(['object','string','array','object']);themes.enforceThis(graphObjType).isIn(reference);var filteredObj={},fullReference,fieldCategory,datumType,parsedField;fullReference=themes.getFullReference(graphObjType,reference);for(var field in graphObj){if(graphObj.hasOwnProperty(field)){if(fullReference.fields.hasOwnProperty(field)){if(fullReference.fields[field].type==='object'||fullReference.fields[field].type==='array'){filteredObj[field]=themes.getFilteredItem(graphObj[field],field,categories,reference);}else{datumType=Array.isArray(graphObj[field])?'array':typeof graphObj[field];fieldCategory=fullReference.fields[field].types[datumType];if(categories.indexOf(fieldCategory)>-1){filteredObj[field]=graphObj[field];}}}else if(graphObjType==='layout'&&themes.isEnumeratedAxis(field)){parsedField=themes.parseEnumeratedAxis(field);filteredObj[field]=themes.getFilteredItem(graphObj[field],parsedField.name,categories,reference);}}}
return filteredObj;};themes.isAxisField=function(field){return(themes.CARTESIAN_AXES.indexOf(field.slice(0,5))>-1);};themes.isEnumeratedAxis=function(field){return(themes.CARTESIAN_AXES.indexOf(field.slice(0,5))>-1&&!isNaN(field.slice(5)));};themes.parseEnumeratedAxis=function(field){themes.enforceThis(themes.isAxisField(field)).isTrue();return{name:field.slice(0,5),number:parseInt(field.slice(5)||1,10)};};themes.getFilteredArray=function(graphArray,graphArrayType,categories,reference){themes.enforceThese(arguments).areTypes(['array','string','array','object']);themes.enforceThis(graphArrayType).isIn(reference);var filteredArray=[],childType;graphArray.forEach(function(child){childType=themes.getArrayChildType(child,graphArrayType);filteredArray.push(themes.getFilteredItem(child,childType,categories,reference));});return filteredArray;};themes.getArrayChildType=function(child,parentType){themes.enforceThese(arguments).areTypes(['object','string']);var childType;if(parentType==='annotations'){return'annotation';}else if(parentType==='data'){if(child.type!==undefined){childType=child.type;}else{childType='scatter';}}else{throw new Error('parentType is not data or annotations');}
return childType;};themes.getFlatGraphItem=function(graphItem,graphItemType,reference){themes.enforceThese(arguments).areTypes(['object|array','string','object']);themes.enforceThis(graphItemType).isIn(reference);var flatItem;if(Array.isArray(graphItem)){flatItem=themes.getFlatGraphArray(graphItem,graphItemType,reference);}else{flatItem=themes.getFlatGraphObj(graphItem,graphItemType,reference);}
return flatItem;};themes.getFlatGraphObj=function(graphObj,graphObjType,reference){themes.enforceThese(arguments).areTypes(['object','string','object']);themes.enforceThis(graphObjType).isIn(reference);var flatObj={},subFlatObj;for(var field in graphObj){if(graphObj.hasOwnProperty(field)){if(reference.hasOwnProperty(field)){subFlatObj=themes.getFlatGraphItem(graphObj[field],field,reference);for(var subField in subFlatObj){if(subFlatObj.hasOwnProperty(subField)){flatObj[field+'.'+subField]=subFlatObj[subField];}}}else if(graphObjType==='layout'&&field.slice(1,5)==='axis'&&reference[graphObjType].fields.hasOwnProperty(field.slice(0,5))&&reference[graphObjType].fields[field.slice(0,5)].types.object==='object'){subFlatObj=themes.getFlatGraphItem(graphObj[field],field.slice(0,5),reference);for(var axisField in subFlatObj){if(subFlatObj.hasOwnProperty(axisField)){flatObj[field+'.'+axisField]=subFlatObj[axisField];}}}else{flatObj[field]=graphObj[field];}}}
return flatObj;};themes.getFlatGraphArray=function(graphArray,graphArrayType,reference){themes.enforceThese(arguments).areTypes(['array','string','object']);themes.enforceThis(graphArrayType).isIn(reference);var flatObj={},subFlatObj,childType;for(var i=0;i<graphArray.length;i++){childType=themes.getArrayChildType(graphArray[i],graphArrayType);subFlatObj=themes.getFlatGraphItem(graphArray[i],childType,reference);for(var subField in subFlatObj){if(subFlatObj.hasOwnProperty(subField)){flatObj[i+'.'+subField]=subFlatObj[subField];}}}
return flatObj;};themes.wrapColorscale=function wrapColorscale(obj){for(var field in obj){if(obj.hasOwnProperty(field)&&field==='colorscale'&&Array.isArray(obj[field])){obj[field]=[obj[field]];}else if(obj[field]&&typeof obj[field]==='object'){wrapColorscale(obj[field]);}}};themes.extractTheme=function(baseGraphObj,categories,reference){themes.enforceThese(arguments).areTypes(['object','array','object']);var themeBaseGraphObj={},objType,filteredDatum,filteredLayout;if(baseGraphObj.data!==undefined&&baseGraphObj.data.length){themeBaseGraphObj.data=[];for(var i=0;i<baseGraphObj.data.length;i++){objType=themes.getArrayChildType(baseGraphObj.data[i],'data');filteredDatum=themes.getFilteredObj(baseGraphObj.data[i],objType,categories,reference);if(objType==='scatter'&&(filteredDatum.mode===undefined)){filteredDatum.mode='lines+markers';}
if(objType==='scatter'&&(filteredDatum.type===undefined)){filteredDatum.type='scatter';}
if(baseGraphObj.data[i].visible!==false){themeBaseGraphObj.data.push(filteredDatum);}}}
if(baseGraphObj.layout!==undefined){filteredLayout=themes.getFilteredObj(baseGraphObj.layout,'layout',categories,reference);themeBaseGraphObj.layout=filteredLayout;}
return themeBaseGraphObj;};themes.getGraphObjFromCurrentTab=function(graphDiv){Plotly.Plots.supplyDefaults(graphDiv);return{data:graphDiv._fullData,layout:graphDiv._fullLayout};};themes.postToPlotly=function(payload){return Promise.resolve($.post(themes.ENDPOINT,payload,null,'json'));};themes.getThemesIcon=function(workspaceDiv){return workspaceDiv.querySelector('.js-toggle-theme-bar');};themes.getThemeBar=function(workspaceDiv){return workspaceDiv.querySelector('.theme-bar');};themes.getThemesList=function(workspaceDiv){return themes.getThemeBar(workspaceDiv).querySelector('.themes__list');};themes.getThemeBarHardClose=function(workspaceDiv){return themes.getThemeBar(workspaceDiv).querySelector('.js-theme-bar-close');};themes.getNameThemeModal=function(workspaceDiv){return workspaceDiv.querySelector('.nameThemeModal');};themes.getThemeSaveThumb=function(workspaceDiv){return workspaceDiv.querySelector('.themes__save-thumb');};themes.getThemeSaveInput=function(workspaceDiv){return workspaceDiv.querySelector('.js-theme-input');};themes.getSaveThemeButton=function(workspaceDiv){return workspaceDiv.querySelector('.js-themes-save-button');};themes.init=function(currentTab){var delayThemeBarOpen=true,disableThemeWarning=true,themeDataLoaded,opened;var workspaceDiv=Tabs.getWorkspace();var graphDiv=Tabs.getGraph();$($('script#load-themes').html()).appendTo($(workspaceDiv));$(themes.getThemeSaveThumb(workspaceDiv)).click(function saveClick(){$(themes.getThemeSaveInput(workspaceDiv)).val('');$(themes.getNameThemeModal(workspaceDiv)).modal('show');});$(themes.getNameThemeModal(workspaceDiv)).keypress(function(e){if(e.which!==13)return;var saveButton=$(themes.getSaveThemeButton(workspaceDiv));if(saveButton.hasClass('btn--inactive'))return;e.preventDefault();saveButton.removeClass('btn--cta');saveButton.addClass('btn--inactive');Themes.saveTheme(graphDiv,workspaceDiv).then(function(){saveButton.addClass('btn--cta');saveButton.removeClass('btn--inactive');});});$(themes.getSaveThemeButton(workspaceDiv)).click(function(){var saveButton=$(this);if(saveButton.hasClass('btn--inactive'))return;saveButton.removeClass('btn--cta');saveButton.addClass('btn--inactive');Themes.saveTheme(graphDiv,workspaceDiv).then(function(){saveButton.addClass('btn--cta');saveButton.removeClass('btn--inactive');});});$(themes.getThemesIcon(currentTab)).click(function(){Themes.toggle(Tabs.get());});$(themes.getThemeBarHardClose(currentTab)).click(function(){Themes.closeThemeBar(Tabs.get());});currentTab.themes={visible:false};if(themes.themeArray===null){themes.themeArray=[];themeDataLoaded=themes.load();}else{themeDataLoaded=Promise.resolve();}
themes.addListeners(currentTab);};themes.addListeners=function(currentTab){$(currentTab).off({plotly_restyle:themes.plotChangeHandler,plotly_relayout:themes.plotChangeHandler,plotly_redraw:themes.plotChangeHandler});$(currentTab).on('plotly_restyle plotly_relayout plotly_redraw',{currentTab:currentTab},themes.plotChangeHandler);};themes.reTileWhenReady=function(graphDiv,workspaceDiv){var attributes=['data','layout'];themes.waitForObjAttributes(graphDiv,attributes).then(function(){themes.reTile(graphDiv,workspaceDiv);}).catch(function(err){console.log(err,err.stack);});};themes.waitForCallbackSuccess=function(callback,maxWait,waitTime,waitScale){waitTime=waitTime||1;maxWait=maxWait||5*60*1000;waitScale=waitScale||1.1;if(waitScale<1){throw new Error('waitScale param must be > 1');}
return new Promise(function(fulfill,reject){var delayAndCallback=function delayAndCallback(elapsedTime){elapsedTime=(elapsedTime||0)+waitTime;if(elapsedTime>=maxWait){reject('some attributes still undefined after max wait');}
if(!callback()){setTimeout(function(){delayAndCallback();},waitTime);}else{fulfill(true);}
waitTime*=waitScale;};delayAndCallback();});};themes.waitForObjAttributes=function(obj,attributes,maxWait,waitTime,waitScale){var callback=function(){return attributes.reduce(function(allHere,attr){return allHere&&obj.hasOwnProperty(attr);},true);};return themes.waitForCallbackSuccess(callback,maxWait,waitTime,waitScale);};themes.waitForChildElements=function(parent,childElements,maxWait,waitTime,waitScale){var callback=function(){return childElements.reduce(function(allHere,childElement){return allHere&&parent.querySelector(childElement);},true);};return themes.waitForCallbackSuccess(callback,maxWait,waitTime,waitScale);};themes.openThemeBar=function(tabDiv,disableThemeWarning,delay){var workspaceDiv=Tabs.getWorkspace();var graphDiv=Tabs.getGraph();var themeBar=themes.getThemeBar(workspaceDiv),fullLayout=graphDiv._fullLayout;if(graphDiv.toolPanel.isPolar(graphDiv)||fullLayout._hasGL3D||fullLayout._hasGeo||fullLayout._hasPie){if(!disableThemeWarning){Workspace.PopActions.showDialogue('Polar Plots, 3D, geographic plots, and pie charts are not yet themable.',{duration:3000});}
return false;}
else{$(themes.getThemesIcon(workspaceDiv)).addClass('active');setTimeout(function(){$(themeBar).slideLeftShow(function(){resizeCenter();});},delay?(themes.THEME_BAR_OPEN_DELAY||0):0);tabDiv.themes.visible=true;return true;}};themes.closeThemeBar=function(tabDiv){var workspaceDiv=Tabs.getWorkspace();var themeBar=themes.getThemeBar(workspaceDiv);$(themes.getThemesIcon(workspaceDiv)).removeClass('active');$(themeBar).slideLeftHide(function(){resizeCenter();});tabDiv.themes.visible=false;};themes.toggle=function(tabDiv,disableThemeWarning){var graphDiv=Tabs.getGraph();var workspaceDiv=Tabs.getWorkspace();var opened;if(tabDiv.themes.visible){themes.closeThemeBar(tabDiv);}else{opened=themes.openThemeBar(tabDiv,disableThemeWarning);if(opened){themes.reTileWhenReady(graphDiv,workspaceDiv);}}};themes.load=function(){var getThemesPayload={origin:'getThemes'},getDefaultsPayload={origin:'getDefaults'},themeArray=[],defaultThemesFound,userThemesFound,themesPostPromise,defaultsPostPromise;themes.themeArray=[];themesPostPromise=themes.postToPlotly(getThemesPayload);defaultsPostPromise=themes.postToPlotly(getDefaultsPayload);defaultThemesFound=defaultsPostPromise.then(function(arr){return arr;}).catch(function(err){console.log(err);return[];});userThemesFound=themesPostPromise.then(function(arr){return arr;}).catch(function(err){console.log(err);return[];});return Promise.all([defaultThemesFound,userThemesFound]).then(function(values){themeArray=values[0].concat(values[1]);return themes.addThemeData(themeArray);});};themes.getPlotlyDefaultThemeObj=function(baseGraphObj,handleThemeObj){themes.enforceThis(baseGraphObj).hasOwnProperties(['layout','data']);var categories=['data','plot_info'],filteredLayout,filteredData,defaultBaseGraphObj,mockGraph;filteredLayout=themes.getFilteredObj(baseGraphObj.layout,'layout',categories,GraphReference);filteredData=themes.getFilteredArray(baseGraphObj.data,'data',categories,GraphReference);mockGraph=document.createElement('div');themes.reTileLock=true;return Plotly.plot(mockGraph,filteredData,filteredLayout).then(function(){defaultBaseGraphObj=themes.getGraphObjFromCurrentTab(mockGraph);return handleThemeObj({baseGraphObj:defaultBaseGraphObj,name:'Plotly Defaults',isDefault:true,themeTypes:themes.getThemeTypes(defaultBaseGraphObj.data),idLocal:-1});}).then(function(){themes.reTileLock=false;}).catch(function(err){themes.reTileLock=false;console.error(err);});};themes.applyClick=function(currentTab,themeObj){var graphDiv=Tabs.getGraph();var workspaceDiv=Tabs.getWorkspace();var themesList=themes.getThemesList(workspaceDiv),themeTileDiv=themes.getThemeTileDivByIdLocal(themeObj.idLocal,themesList);if(themeTileDiv.state==='on'){themes.changeTileStates(workspaceDiv,'off');themes.applyTheme(graphDiv,themeObj);}};themes.deleteClick=function deleteClick(clickedElement,currentTab,themeObj){var themesList=themes.getThemesList(currentTab),themeTileDiv=themes.getThemeTileDivByIdLocal(themeObj.idLocal,themesList);if(themeTileDiv.state==='on'){var liElement=clickedElement.parentElement.parentElement;themes.deleteTheme(liElement,currentTab,themeObj);}};themes.applyTheme=function(graphDiv,themeObj,categories,reference){var themeBaseGraphObj=themeObj.baseGraphObj,flatData=[],indices=[],updateObj,flatLayout={},datumType,flatDatum;categories=categories||['style','size'];reference=reference||GraphReference;addMessage('Applying Theme');updateObj=themes.getUpdateGraphObj(graphDiv,themeBaseGraphObj,categories,reference);if(updateObj.hasOwnProperty('layout')){if(!Array.isArray(graphDiv.layout.annotations)||graphDiv.layout.annotations.length===0){delete updateObj.layout.annotations;}else{if(Array.isArray(updateObj.layout.annotations)&&updateObj.layout.annotations.length){updateObj.layout.annotations=updateObj.layout.annotations.slice(0,graphDiv.layout.annotations.length);}}
flatLayout=themes.getFlatGraphObj(updateObj.layout,'layout',GraphReference);}
if(updateObj.hasOwnProperty('data')){for(var i=0;i<updateObj.data.length;i++){if(graphDiv.data[i]===undefined){break;}
datumType=themes.getArrayChildType(updateObj.data[i],'data');themes.wrapColorscale(updateObj.data[i]);flatDatum=themes.getFlatGraphObj(updateObj.data[i],datumType,GraphReference);if(Object.keys(flatDatum).length){flatData.push(flatDatum);indices.push(i);}}}
setTimeout(function(){Plotly.Queue.startSequence(graphDiv);Plotly.relayout(graphDiv,flatLayout);flatData.forEach(function(flatDatum,index){Plotly.restyle(graphDiv,flatDatum,index);});Promise.all(graphDiv._promises||[]).then(function(){delMessage('Applying Theme');Plotly.Queue.stopSequence(graphDiv);}).catch(function(err){console.log(err);});},10);};themes.saveTheme=function(graphDiv,workspaceDiv,categories,reference){categories=categories||['style','plot_info'];reference=reference||GraphReference;var baseGraphObj,themeBaseGraphObj,name,payload;name=themes.getThemeNameFromSaveForm(workspaceDiv);if(name){baseGraphObj=themes.getGraphObjFromCurrentTab(graphDiv);themeBaseGraphObj=themes.extractTheme(baseGraphObj,categories,reference);payload={origin:'saveTheme',name:name,baseGraphObj:JSON.stringify(themeBaseGraphObj)};return themes.postToPlotly(payload).then(function(themeObj){themes.addThemeData([themeObj]);themes.reTile(graphDiv,workspaceDiv);themes.removeSaveForm(Tabs.get());}).catch(function(err){console.log('theme save failed: ',err);});}else{return Promise.resolve();}};themes.removeSaveForm=function(currentTab){var $currentTab=$(currentTab);$currentTab.find('.nameThemeModal').modal('hide');$currentTab.find('.js-theme-input').val('');};themes.getThemeNameFromSaveForm=function(workspaceDiv){var $workspaceDiv=$(workspaceDiv),showMessage,name,errorMessage,message_html;showMessage=function(message){message_html='<p class="js--signup-error error--inline">'+message+'</p>';$workspaceDiv.find('.themeSaveInfo').html(message_html);setTimeout(function removeThemeMsg(){$workspaceDiv.find('.themeSaveInfo').fadeOut(function clearThemeMsg(){$workspaceDiv.find('.themeSaveInfo').html('');$workspaceDiv.find('.themeSaveInfo').show();});},3000);};name=workspaceDiv.querySelector('.js-theme-input').value;errorMessage=themes.validateThemeName(name,themes.themeArray);if(errorMessage){showMessage(errorMessage);name='';}
return name;};themes.validateThemeName=function(name,themeArray){var errorReason='',hasDuplicateName;themeArray.forEach(function checkForDuplicateName(themeObj){if(!themeObj.isDefault&&themeObj.name===name){hasDuplicateName=true;}});if(!name){errorReason='Theme name is empty';}else if(!name.match(/^[\d\w\s\.-]+$/)){errorReason='Theme name contains invalid characters';}else if(hasDuplicateName){errorReason='Theme name already exists';}
return errorReason;};themes.deleteTheme=function(themesListIndexElement,currentTab,themeObj){var idLocal=themeObj.idLocal,themeArrayIndex=themes.themeArray.indexOf(themeObj);themes.themeArray.splice(themeArrayIndex,1);Plotly.Lib.removeElement(themesListIndexElement);return themes.deleteThemeInPlotly(idLocal);};themes.deleteThemeInPlotly=function(idLocal){var payload={origin:'deleteTheme',idLocal:idLocal};return themes.postToPlotly(payload).catch(function(err){console.log('delete theme failed: ',err);});};themes.updateThemeTileDivBaseGraphObj=function(currentTab,themeTileDiv,themeObj){var mergedBaseGraphObj;var defaultPlotTileLayout=themeTileDiv.defaultLayout;mergedBaseGraphObj=themes.getMergedBaseGraphObj(Tabs.get().themes.downSampledUserBaseGraphObj,themeObj.baseGraphObj);for(var field in mergedBaseGraphObj.layout){if(mergedBaseGraphObj.layout.hasOwnProperty(field)){if(themes.isAxisField(field)){mergedBaseGraphObj.layout[field]=themes.getNestedMerge(mergedBaseGraphObj.layout[field],themes.TILE_AXIS_UPDATE);}}}
mergedBaseGraphObj.layout=themes.getScaledGraphObj(mergedBaseGraphObj.layout,'layout',themes.SIZE_SCALE,GraphReference);mergedBaseGraphObj.data=themes.getScaledGraphArray(mergedBaseGraphObj.data,'data',themes.SIZE_SCALE,GraphReference);mergedBaseGraphObj.data.forEach(function(trace){trace.showscale=false;});themeTileDiv.data=mergedBaseGraphObj.data;themeTileDiv.layout=themes.getNestedMerge(mergedBaseGraphObj.layout,defaultPlotTileLayout);};themes.updateThemeTileDiv=function(graphDiv,workspaceDiv,themeTileDiv){function redraw(themeObj){themes.updateThemeTileDivBaseGraphObj(graphDiv,themeTileDiv,themeObj);Plotly.redraw(themeTileDiv);themes.makeThemeTileDivStatic(themeTileDiv);themes.changeTileState(themeTileDiv,'on');}
var idLocal=themes.getThemeTileDivIdLocal(themeTileDiv);if(idLocal===themes.DEFAULT_THEME_ID_LOCAL){themes.getPlotlyDefaultThemeObj(graphDiv,redraw);}else{redraw(themes.getThemeObjByIdLocal(idLocal,themes.themeArray));}};themes.updateThemeTileDivs=function(graphDiv,workspaceDiv,idLocalArray){var themesList=themes.getThemesList(workspaceDiv),themeTileDiv;themes.downSampleAndCopyCurrentGraph(graphDiv).then(function(){idLocalArray.forEach(function(idLocal){themeTileDiv=themes.getThemeTileDivByIdLocal(idLocal,themesList);themes.updateThemeTileDiv(graphDiv,workspaceDiv,themeTileDiv);});}).catch(function(err){console.log(err);});};themes.reTile=function(graphDiv,workspaceDiv){var themesList=workspaceDiv.querySelector('.themes__list'),themesListItems=themesList.children,themeObj,themeTileDiv,applicableIdLocals,currentIdLocals=[],index;themes.clearReTileQueue();if(graphDiv.toolPanel.isPolar(graphDiv)||graphDiv._fullLayout._hasGL3D||graphDiv._fullLayout._hasGeo){themes.closeThemeBar(workspaceDiv);return Promise.resolve();}
if(!themes.reTileLock){themes.changeTileStates(workspaceDiv,'off');applicableIdLocals=themes.getApplicableThemes(graphDiv,themes.themeArray).map(function(themeObj){return themeObj.idLocal;});for(var i=1;i<themesListItems.length;i+=1){themeTileDiv=themesListItems[i].querySelector('.themes__thumb');currentIdLocals.push(themes.getThemeTileDivIdLocal(themeTileDiv));}
currentIdLocals.slice(0).forEach(function(idLocal){if(idLocal!==themes.DEFAULT_THEME_ID_LOCAL&&applicableIdLocals.indexOf(idLocal)===-1){themeTileDiv=themes.getThemeTileDivByIdLocal(idLocal,themesList);var themeParent=themeTileDiv.parentNode;Plotly.Lib.removeElement(themeParent);index=currentIdLocals.indexOf(idLocal);currentIdLocals.splice(index,1);}});themes.updateThemeTileDivs(graphDiv,workspaceDiv,currentIdLocals);applicableIdLocals.forEach(function(idLocal){if(currentIdLocals.indexOf(idLocal)===-1){themeObj=themes.getThemeObjByIdLocal(idLocal,themes.themeArray);themeTileDiv=themes.getThemeTileDiv(graphDiv,themeObj);themes.addThemeTileDivUserInterface(workspaceDiv,themeTileDiv,themeObj);themes.makeThemeTileDivStatic(themeTileDiv);themes.insertThemeTileDivIntoThemesList(themeTileDiv,themesList);themes.changeTileState(themeTileDiv,'on');}});if(currentIdLocals.indexOf(themes.DEFAULT_THEME_ID_LOCAL)===-1){var graphObj=Tabs.get().themes.downSampledUserBaseGraphObj;themes.getPlotlyDefaultThemeObj(graphObj,function(defaultThemeObj){themeTileDiv=themes.getThemeTileDiv(graphDiv,defaultThemeObj);themes.addThemeTileDivUserInterface(workspaceDiv,themeTileDiv,defaultThemeObj);themes.makeThemeTileDivStatic(themeTileDiv);themes.insertThemeTileDivIntoThemesList(themeTileDiv,themesList);});}}
return Promise.resolve();};themes.plotChangeHandler=function(event,attributes){attributes=attributes||{};var currentTab=event.data.currentTab,allKeys=Object.keys(attributes),plotContextIsSafe=currentTab.themes&&currentTab.themes.visible,graphDiv=Tabs.getGraph(),workspaceDiv=Tabs.getWorkspace();function noMatches(attributeString){return!themes.IGNORE_PATTERNS.reduce(function(res,regex){return res||regex.test(attributeString);},false);}
if(event.type==='plotly_redraw'&&plotContextIsSafe&&!themes.reTileLock){themes.reTileManager(graphDiv,workspaceDiv);}else if(plotContextIsSafe&&!themes.reTileLock&&allKeys.filter(noMatches).length){themes.reTileManager(graphDiv,workspaceDiv);}};themes.reTileManager=function(graphDiv,workspaceDiv){themes.clearReTileQueue();themes.changeTileStates(workspaceDiv,'off');themes.reTileQueue.push(setTimeout(function(){themes.reTile(graphDiv,workspaceDiv);},themes.RETILE_DELAY));};themes.clearReTileQueue=function(){themes.reTileQueue.forEach(function(timeout){clearTimeout(timeout);});themes.reTileQueue=[];};themes.changeTileStates=function(workspaceDiv,state){var themesListItems=workspaceDiv.querySelector('.themes__list').children,themeTileDiv;for(var i=1;i<themesListItems.length;i+=1){themeTileDiv=themesListItems[i].querySelector('.themes__thumb');themes.changeTileState(themeTileDiv,state);}};themes.changeTileState=function(themeTileDiv,state){themes.enforceThis(state).isIn(['on','off']);themes.enforceThis(themeTileDiv.state).isIn(['on','off']);if(state!==themeTileDiv.state){themeTileDiv.state=state;themes.updateThemeTileDivOpacity(themeTileDiv);}};themes.updateThemeTileDivOpacity=function(themeTileDiv){var opacity=themeTileDiv.state==='on'?1:0.4;$(themeTileDiv).fadeTo(1000,opacity);};return themes;})(GraphReference);userObj=(function(){function info(){return _info;}
function sync(){return new Promise(function(fulfill,reject){$.post('/user_account_actions',{'payload':JSON.stringify({'action':'user_info'})},function(d){if(d.err===''){_info=$.extend(true,{},_info,d.info);return fulfill()}});});}
var _info={};return{info:info,sync:sync};})();var userSettings=userSettings||(function(){function init(callback){if(typeof(callback)==="undefined"){callback=function(){};}
userObj.sync().then(function(){callback();}).then();}
return{init:init};})();if(window.location.hash.match('chromeStore')){$(window).load(function(){if(navigator.userAgent.match('Chrome')){if(localStorage.getItem('plotlyChromePopup')===null){$('div.chromePopup').fadeIn(100,function(){})
$('a.chromeButton').click(function(){localStorage.setItem('plotlyChromePopup','yes')
$('div.chromePopup').fadeOut(300,function(){launchsocialauth('/login/google-oauth2/')})})
$('a.chromePopupClose').click(function(){localStorage.setItem('plotlyChromePopup','yes')})}}})}
(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.StreamHead=f()}})(function(){var define,module,exports;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){},{}],2:[function(require,module,exports){(function(global){var base64=require('base64-js')
var ieee754=require('ieee754')
var isArray=require('is-array')
exports.Buffer=Buffer
exports.SlowBuffer=SlowBuffer
exports.INSPECT_MAX_BYTES=50
Buffer.poolSize=8192
var rootParent={}
Buffer.TYPED_ARRAY_SUPPORT=global.TYPED_ARRAY_SUPPORT!==undefined?global.TYPED_ARRAY_SUPPORT:typedArraySupport()
function typedArraySupport(){function Bar(){}
try{var arr=new Uint8Array(1)
arr.foo=function(){return 42}
arr.constructor=Bar
return arr.foo()===42&&arr.constructor===Bar&&typeof arr.subarray==='function'&&arr.subarray(1,1).byteLength===0}catch(e){return false}}
function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?0x7fffffff:0x3fffffff}
function Buffer(arg){if(!(this instanceof Buffer)){if(arguments.length>1)return new Buffer(arg,arguments[1])
return new Buffer(arg)}
this.length=0
this.parent=undefined
if(typeof arg==='number'){return fromNumber(this,arg)}
if(typeof arg==='string'){return fromString(this,arg,arguments.length>1?arguments[1]:'utf8')}
return fromObject(this,arg)}
function fromNumber(that,length){that=allocate(that,length<0?0:checked(length)|0)
if(!Buffer.TYPED_ARRAY_SUPPORT){for(var i=0;i<length;i++){that[i]=0}}
return that}
function fromString(that,string,encoding){if(typeof encoding!=='string'||encoding==='')encoding='utf8'
var length=byteLength(string,encoding)|0
that=allocate(that,length)
that.write(string,encoding)
return that}
function fromObject(that,object){if(Buffer.isBuffer(object))return fromBuffer(that,object)
if(isArray(object))return fromArray(that,object)
if(object==null){throw new TypeError('must start with number, buffer, array or string')}
if(typeof ArrayBuffer!=='undefined'){if(object.buffer instanceof ArrayBuffer){return fromTypedArray(that,object)}
if(object instanceof ArrayBuffer){return fromArrayBuffer(that,object)}}
if(object.length)return fromArrayLike(that,object)
return fromJsonObject(that,object)}
function fromBuffer(that,buffer){var length=checked(buffer.length)|0
that=allocate(that,length)
buffer.copy(that,0,0,length)
return that}
function fromArray(that,array){var length=checked(array.length)|0
that=allocate(that,length)
for(var i=0;i<length;i+=1){that[i]=array[i]&255}
return that}
function fromTypedArray(that,array){var length=checked(array.length)|0
that=allocate(that,length)
for(var i=0;i<length;i+=1){that[i]=array[i]&255}
return that}
function fromArrayBuffer(that,array){if(Buffer.TYPED_ARRAY_SUPPORT){array.byteLength
that=Buffer._augment(new Uint8Array(array))}else{that=fromTypedArray(that,new Uint8Array(array))}
return that}
function fromArrayLike(that,array){var length=checked(array.length)|0
that=allocate(that,length)
for(var i=0;i<length;i+=1){that[i]=array[i]&255}
return that}
function fromJsonObject(that,object){var array
var length=0
if(object.type==='Buffer'&&isArray(object.data)){array=object.data
length=checked(array.length)|0}
that=allocate(that,length)
for(var i=0;i<length;i+=1){that[i]=array[i]&255}
return that}
if(Buffer.TYPED_ARRAY_SUPPORT){Buffer.prototype.__proto__=Uint8Array.prototype
Buffer.__proto__=Uint8Array}
function allocate(that,length){if(Buffer.TYPED_ARRAY_SUPPORT){that=Buffer._augment(new Uint8Array(length))
that.__proto__=Buffer.prototype}else{that.length=length
that._isBuffer=true}
var fromPool=length!==0&&length<=Buffer.poolSize>>>1
if(fromPool)that.parent=rootParent
return that}
function checked(length){if(length>=kMaxLength()){throw new RangeError('Attempt to allocate Buffer larger than maximum '+'size: 0x'+kMaxLength().toString(16)+' bytes')}
return length|0}
function SlowBuffer(subject,encoding){if(!(this instanceof SlowBuffer))return new SlowBuffer(subject,encoding)
var buf=new Buffer(subject,encoding)
delete buf.parent
return buf}
Buffer.isBuffer=function isBuffer(b){return!!(b!=null&&b._isBuffer)}
Buffer.compare=function compare(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError('Arguments must be Buffers')}
if(a===b)return 0
var x=a.length
var y=b.length
var i=0
var len=Math.min(x,y)
while(i<len){if(a[i]!==b[i])break
++i}
if(i!==len){x=a[i]
y=b[i]}
if(x<y)return-1
if(y<x)return 1
return 0}
Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case'hex':case'utf8':case'utf-8':case'ascii':case'binary':case'base64':case'raw':case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return true
default:return false}}
Buffer.concat=function concat(list,length){if(!isArray(list))throw new TypeError('list argument must be an Array of Buffers.')
if(list.length===0){return new Buffer(0)}
var i
if(length===undefined){length=0
for(i=0;i<list.length;i++){length+=list[i].length}}
var buf=new Buffer(length)
var pos=0
for(i=0;i<list.length;i++){var item=list[i]
item.copy(buf,pos)
pos+=item.length}
return buf}
function byteLength(string,encoding){if(typeof string!=='string')string=''+string
var len=string.length
if(len===0)return 0
var loweredCase=false
for(;;){switch(encoding){case'ascii':case'binary':case'raw':case'raws':return len
case'utf8':case'utf-8':return utf8ToBytes(string).length
case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return len*2
case'hex':return len>>>1
case'base64':return base64ToBytes(string).length
default:if(loweredCase)return utf8ToBytes(string).length
encoding=(''+encoding).toLowerCase()
loweredCase=true}}}
Buffer.byteLength=byteLength
Buffer.prototype.length=undefined
Buffer.prototype.parent=undefined
function slowToString(encoding,start,end){var loweredCase=false
start=start|0
end=end===undefined||end===Infinity?this.length:end|0
if(!encoding)encoding='utf8'
if(start<0)start=0
if(end>this.length)end=this.length
if(end<=start)return''
while(true){switch(encoding){case'hex':return hexSlice(this,start,end)
case'utf8':case'utf-8':return utf8Slice(this,start,end)
case'ascii':return asciiSlice(this,start,end)
case'binary':return binarySlice(this,start,end)
case'base64':return base64Slice(this,start,end)
case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return utf16leSlice(this,start,end)
default:if(loweredCase)throw new TypeError('Unknown encoding: '+encoding)
encoding=(encoding+'').toLowerCase()
loweredCase=true}}}
Buffer.prototype.toString=function toString(){var length=this.length|0
if(length===0)return''
if(arguments.length===0)return utf8Slice(this,0,length)
return slowToString.apply(this,arguments)}
Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError('Argument must be a Buffer')
if(this===b)return true
return Buffer.compare(this,b)===0}
Buffer.prototype.inspect=function inspect(){var str=''
var max=exports.INSPECT_MAX_BYTES
if(this.length>0){str=this.toString('hex',0,max).match(/.{2}/g).join(' ')
if(this.length>max)str+=' ... '}
return'<Buffer '+str+'>'}
Buffer.prototype.compare=function compare(b){if(!Buffer.isBuffer(b))throw new TypeError('Argument must be a Buffer')
if(this===b)return 0
return Buffer.compare(this,b)}
Buffer.prototype.indexOf=function indexOf(val,byteOffset){if(byteOffset>0x7fffffff)byteOffset=0x7fffffff
else if(byteOffset<-0x80000000)byteOffset=-0x80000000
byteOffset>>=0
if(this.length===0)return-1
if(byteOffset>=this.length)return-1
if(byteOffset<0)byteOffset=Math.max(this.length+byteOffset,0)
if(typeof val==='string'){if(val.length===0)return-1
return String.prototype.indexOf.call(this,val,byteOffset)}
if(Buffer.isBuffer(val)){return arrayIndexOf(this,val,byteOffset)}
if(typeof val==='number'){if(Buffer.TYPED_ARRAY_SUPPORT&&Uint8Array.prototype.indexOf==='function'){return Uint8Array.prototype.indexOf.call(this,val,byteOffset)}
return arrayIndexOf(this,[val],byteOffset)}
function arrayIndexOf(arr,val,byteOffset){var foundIndex=-1
for(var i=0;byteOffset+i<arr.length;i++){if(arr[byteOffset+i]===val[foundIndex===-1?0:i-foundIndex]){if(foundIndex===-1)foundIndex=i
if(i-foundIndex+1===val.length)return byteOffset+foundIndex}else{foundIndex=-1}}
return-1}
throw new TypeError('val must be string, number or Buffer')}
Buffer.prototype.get=function get(offset){console.log('.get() is deprecated. Access using array indexes instead.')
return this.readUInt8(offset)}
Buffer.prototype.set=function set(v,offset){console.log('.set() is deprecated. Access using array indexes instead.')
return this.writeUInt8(v,offset)}
function hexWrite(buf,string,offset,length){offset=Number(offset)||0
var remaining=buf.length-offset
if(!length){length=remaining}else{length=Number(length)
if(length>remaining){length=remaining}}
var strLen=string.length
if(strLen%2!==0)throw new Error('Invalid hex string')
if(length>strLen/2){length=strLen/2}
for(var i=0;i<length;i++){var parsed=parseInt(string.substr(i*2,2),16)
if(isNaN(parsed))throw new Error('Invalid hex string')
buf[offset+i]=parsed}
return i}
function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}
function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}
function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}
function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}
function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}
Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding='utf8'
length=this.length
offset=0}else if(length===undefined&&typeof offset==='string'){encoding=offset
length=this.length
offset=0}else if(isFinite(offset)){offset=offset|0
if(isFinite(length)){length=length|0
if(encoding===undefined)encoding='utf8'}else{encoding=length
length=undefined}}else{var swap=encoding
encoding=offset
offset=length|0
length=swap}
var remaining=this.length-offset
if(length===undefined||length>remaining)length=remaining
if((string.length>0&&(length<0||offset<0))||offset>this.length){throw new RangeError('attempt to write outside buffer bounds')}
if(!encoding)encoding='utf8'
var loweredCase=false
for(;;){switch(encoding){case'hex':return hexWrite(this,string,offset,length)
case'utf8':case'utf-8':return utf8Write(this,string,offset,length)
case'ascii':return asciiWrite(this,string,offset,length)
case'binary':return binaryWrite(this,string,offset,length)
case'base64':return base64Write(this,string,offset,length)
case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return ucs2Write(this,string,offset,length)
default:if(loweredCase)throw new TypeError('Unknown encoding: '+encoding)
encoding=(''+encoding).toLowerCase()
loweredCase=true}}}
Buffer.prototype.toJSON=function toJSON(){return{type:'Buffer',data:Array.prototype.slice.call(this._arr||this,0)}}
function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}
function utf8Slice(buf,start,end){end=Math.min(buf.length,end)
var res=[]
var i=start
while(i<end){var firstByte=buf[i]
var codePoint=null
var bytesPerSequence=(firstByte>0xEF)?4:(firstByte>0xDF)?3:(firstByte>0xBF)?2:1
if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint
switch(bytesPerSequence){case 1:if(firstByte<0x80){codePoint=firstByte}
break
case 2:secondByte=buf[i+1]
if((secondByte&0xC0)===0x80){tempCodePoint=(firstByte&0x1F)<<0x6|(secondByte&0x3F)
if(tempCodePoint>0x7F){codePoint=tempCodePoint}}
break
case 3:secondByte=buf[i+1]
thirdByte=buf[i+2]
if((secondByte&0xC0)===0x80&&(thirdByte&0xC0)===0x80){tempCodePoint=(firstByte&0xF)<<0xC|(secondByte&0x3F)<<0x6|(thirdByte&0x3F)
if(tempCodePoint>0x7FF&&(tempCodePoint<0xD800||tempCodePoint>0xDFFF)){codePoint=tempCodePoint}}
break
case 4:secondByte=buf[i+1]
thirdByte=buf[i+2]
fourthByte=buf[i+3]
if((secondByte&0xC0)===0x80&&(thirdByte&0xC0)===0x80&&(fourthByte&0xC0)===0x80){tempCodePoint=(firstByte&0xF)<<0x12|(secondByte&0x3F)<<0xC|(thirdByte&0x3F)<<0x6|(fourthByte&0x3F)
if(tempCodePoint>0xFFFF&&tempCodePoint<0x110000){codePoint=tempCodePoint}}}}
if(codePoint===null){codePoint=0xFFFD
bytesPerSequence=1}else if(codePoint>0xFFFF){codePoint-=0x10000
res.push(codePoint>>>10&0x3FF|0xD800)
codePoint=0xDC00|codePoint&0x3FF}
res.push(codePoint)
i+=bytesPerSequence}
return decodeCodePointsArray(res)}
var MAX_ARGUMENTS_LENGTH=0x1000
function decodeCodePointsArray(codePoints){var len=codePoints.length
if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}
var res=''
var i=0
while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}
return res}
function asciiSlice(buf,start,end){var ret=''
end=Math.min(buf.length,end)
for(var i=start;i<end;i++){ret+=String.fromCharCode(buf[i]&0x7F)}
return ret}
function binarySlice(buf,start,end){var ret=''
end=Math.min(buf.length,end)
for(var i=start;i<end;i++){ret+=String.fromCharCode(buf[i])}
return ret}
function hexSlice(buf,start,end){var len=buf.length
if(!start||start<0)start=0
if(!end||end<0||end>len)end=len
var out=''
for(var i=start;i<end;i++){out+=toHex(buf[i])}
return out}
function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end)
var res=''
for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}
return res}
Buffer.prototype.slice=function slice(start,end){var len=this.length
start=~~start
end=end===undefined?len:~~end
if(start<0){start+=len
if(start<0)start=0}else if(start>len){start=len}
if(end<0){end+=len
if(end<0)end=0}else if(end>len){end=len}
if(end<start)end=start
var newBuf
if(Buffer.TYPED_ARRAY_SUPPORT){newBuf=Buffer._augment(this.subarray(start,end))}else{var sliceLen=end-start
newBuf=new Buffer(sliceLen,undefined)
for(var i=0;i<sliceLen;i++){newBuf[i]=this[i+start]}}
if(newBuf.length)newBuf.parent=this.parent||this
return newBuf}
function checkOffset(offset,ext,length){if((offset%1)!==0||offset<0)throw new RangeError('offset is not uint')
if(offset+ext>length)throw new RangeError('Trying to access beyond buffer length')}
Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset|0
byteLength=byteLength|0
if(!noAssert)checkOffset(offset,byteLength,this.length)
var val=this[offset]
var mul=1
var i=0
while(++i<byteLength&&(mul*=0x100)){val+=this[offset+i]*mul}
return val}
Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset|0
byteLength=byteLength|0
if(!noAssert){checkOffset(offset,byteLength,this.length)}
var val=this[offset+--byteLength]
var mul=1
while(byteLength>0&&(mul*=0x100)){val+=this[offset+--byteLength]*mul}
return val}
Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length)
return this[offset]}
Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length)
return this[offset]|(this[offset+1]<<8)}
Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length)
return(this[offset]<<8)|this[offset+1]}
Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length)
return((this[offset])|(this[offset+1]<<8)|(this[offset+2]<<16))+
(this[offset+3]*0x1000000)}
Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length)
return(this[offset]*0x1000000)+
((this[offset+1]<<16)|(this[offset+2]<<8)|this[offset+3])}
Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset|0
byteLength=byteLength|0
if(!noAssert)checkOffset(offset,byteLength,this.length)
var val=this[offset]
var mul=1
var i=0
while(++i<byteLength&&(mul*=0x100)){val+=this[offset+i]*mul}
mul*=0x80
if(val>=mul)val-=Math.pow(2,8*byteLength)
return val}
Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset|0
byteLength=byteLength|0
if(!noAssert)checkOffset(offset,byteLength,this.length)
var i=byteLength
var mul=1
var val=this[offset+--i]
while(i>0&&(mul*=0x100)){val+=this[offset+--i]*mul}
mul*=0x80
if(val>=mul)val-=Math.pow(2,8*byteLength)
return val}
Buffer.prototype.readInt8=function readInt8(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length)
if(!(this[offset]&0x80))return(this[offset])
return((0xff-this[offset]+1)*-1)}
Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length)
var val=this[offset]|(this[offset+1]<<8)
return(val&0x8000)?val|0xFFFF0000:val}
Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length)
var val=this[offset+1]|(this[offset]<<8)
return(val&0x8000)?val|0xFFFF0000:val}
Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length)
return(this[offset])|(this[offset+1]<<8)|(this[offset+2]<<16)|(this[offset+3]<<24)}
Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length)
return(this[offset]<<24)|(this[offset+1]<<16)|(this[offset+2]<<8)|(this[offset+3])}
Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length)
return ieee754.read(this,offset,true,23,4)}
Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length)
return ieee754.read(this,offset,false,23,4)}
Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length)
return ieee754.read(this,offset,true,52,8)}
Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length)
return ieee754.read(this,offset,false,52,8)}
function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('buffer must be a Buffer instance')
if(value>max||value<min)throw new RangeError('value is out of bounds')
if(offset+ext>buf.length)throw new RangeError('index out of range')}
Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value
offset=offset|0
byteLength=byteLength|0
if(!noAssert)checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0)
var mul=1
var i=0
this[offset]=value&0xFF
while(++i<byteLength&&(mul*=0x100)){this[offset+i]=(value/mul)&0xFF}
return offset+byteLength}
Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value
offset=offset|0
byteLength=byteLength|0
if(!noAssert)checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0)
var i=byteLength-1
var mul=1
this[offset+i]=value&0xFF
while(--i>=0&&(mul*=0x100)){this[offset+i]=(value/mul)&0xFF}
return offset+byteLength}
Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value
offset=offset|0
if(!noAssert)checkInt(this,value,offset,1,0xff,0)
if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value)
this[offset]=(value&0xff)
return offset+1}
function objectWriteUInt16(buf,value,offset,littleEndian){if(value<0)value=0xffff+value+1
for(var i=0,j=Math.min(buf.length-offset,2);i<j;i++){buf[offset+i]=(value&(0xff<<(8*(littleEndian?i:1-i))))>>>(littleEndian?i:1-i)*8}}
Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value
offset=offset|0
if(!noAssert)checkInt(this,value,offset,2,0xffff,0)
if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=(value&0xff)
this[offset+1]=(value>>>8)}else{objectWriteUInt16(this,value,offset,true)}
return offset+2}
Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value
offset=offset|0
if(!noAssert)checkInt(this,value,offset,2,0xffff,0)
if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=(value>>>8)
this[offset+1]=(value&0xff)}else{objectWriteUInt16(this,value,offset,false)}
return offset+2}
function objectWriteUInt32(buf,value,offset,littleEndian){if(value<0)value=0xffffffff+value+1
for(var i=0,j=Math.min(buf.length-offset,4);i<j;i++){buf[offset+i]=(value>>>(littleEndian?i:3-i)*8)&0xff}}
Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value
offset=offset|0
if(!noAssert)checkInt(this,value,offset,4,0xffffffff,0)
if(Buffer.TYPED_ARRAY_SUPPORT){this[offset+3]=(value>>>24)
this[offset+2]=(value>>>16)
this[offset+1]=(value>>>8)
this[offset]=(value&0xff)}else{objectWriteUInt32(this,value,offset,true)}
return offset+4}
Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value
offset=offset|0
if(!noAssert)checkInt(this,value,offset,4,0xffffffff,0)
if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=(value>>>24)
this[offset+1]=(value>>>16)
this[offset+2]=(value>>>8)
this[offset+3]=(value&0xff)}else{objectWriteUInt32(this,value,offset,false)}
return offset+4}
Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value
offset=offset|0
if(!noAssert){var limit=Math.pow(2,8*byteLength-1)
checkInt(this,value,offset,byteLength,limit-1,-limit)}
var i=0
var mul=1
var sub=value<0?1:0
this[offset]=value&0xFF
while(++i<byteLength&&(mul*=0x100)){this[offset+i]=((value/mul)>>0)-sub&0xFF}
return offset+byteLength}
Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value
offset=offset|0
if(!noAssert){var limit=Math.pow(2,8*byteLength-1)
checkInt(this,value,offset,byteLength,limit-1,-limit)}
var i=byteLength-1
var mul=1
var sub=value<0?1:0
this[offset+i]=value&0xFF
while(--i>=0&&(mul*=0x100)){this[offset+i]=((value/mul)>>0)-sub&0xFF}
return offset+byteLength}
Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value
offset=offset|0
if(!noAssert)checkInt(this,value,offset,1,0x7f,-0x80)
if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value)
if(value<0)value=0xff+value+1
this[offset]=(value&0xff)
return offset+1}
Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value
offset=offset|0
if(!noAssert)checkInt(this,value,offset,2,0x7fff,-0x8000)
if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=(value&0xff)
this[offset+1]=(value>>>8)}else{objectWriteUInt16(this,value,offset,true)}
return offset+2}
Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value
offset=offset|0
if(!noAssert)checkInt(this,value,offset,2,0x7fff,-0x8000)
if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=(value>>>8)
this[offset+1]=(value&0xff)}else{objectWriteUInt16(this,value,offset,false)}
return offset+2}
Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value
offset=offset|0
if(!noAssert)checkInt(this,value,offset,4,0x7fffffff,-0x80000000)
if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=(value&0xff)
this[offset+1]=(value>>>8)
this[offset+2]=(value>>>16)
this[offset+3]=(value>>>24)}else{objectWriteUInt32(this,value,offset,true)}
return offset+4}
Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value
offset=offset|0
if(!noAssert)checkInt(this,value,offset,4,0x7fffffff,-0x80000000)
if(value<0)value=0xffffffff+value+1
if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=(value>>>24)
this[offset+1]=(value>>>16)
this[offset+2]=(value>>>8)
this[offset+3]=(value&0xff)}else{objectWriteUInt32(this,value,offset,false)}
return offset+4}
function checkIEEE754(buf,value,offset,ext,max,min){if(value>max||value<min)throw new RangeError('value is out of bounds')
if(offset+ext>buf.length)throw new RangeError('index out of range')
if(offset<0)throw new RangeError('index out of range')}
function writeFloat(buf,value,offset,littleEndian,noAssert){if(!noAssert){checkIEEE754(buf,value,offset,4,3.4028234663852886e+38,-3.4028234663852886e+38)}
ieee754.write(buf,value,offset,littleEndian,23,4)
return offset+4}
Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)}
Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)}
function writeDouble(buf,value,offset,littleEndian,noAssert){if(!noAssert){checkIEEE754(buf,value,offset,8,1.7976931348623157E+308,-1.7976931348623157E+308)}
ieee754.write(buf,value,offset,littleEndian,52,8)
return offset+8}
Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)}
Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)}
Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!start)start=0
if(!end&&end!==0)end=this.length
if(targetStart>=target.length)targetStart=target.length
if(!targetStart)targetStart=0
if(end>0&&end<start)end=start
if(end===start)return 0
if(target.length===0||this.length===0)return 0
if(targetStart<0){throw new RangeError('targetStart out of bounds')}
if(start<0||start>=this.length)throw new RangeError('sourceStart out of bounds')
if(end<0)throw new RangeError('sourceEnd out of bounds')
if(end>this.length)end=this.length
if(target.length-targetStart<end-start){end=target.length-targetStart+start}
var len=end-start
var i
if(this===target&&start<targetStart&&targetStart<end){for(i=len-1;i>=0;i--){target[i+targetStart]=this[i+start]}}else if(len<1000||!Buffer.TYPED_ARRAY_SUPPORT){for(i=0;i<len;i++){target[i+targetStart]=this[i+start]}}else{target._set(this.subarray(start,start+len),targetStart)}
return len}
Buffer.prototype.fill=function fill(value,start,end){if(!value)value=0
if(!start)start=0
if(!end)end=this.length
if(end<start)throw new RangeError('end < start')
if(end===start)return
if(this.length===0)return
if(start<0||start>=this.length)throw new RangeError('start out of bounds')
if(end<0||end>this.length)throw new RangeError('end out of bounds')
var i
if(typeof value==='number'){for(i=start;i<end;i++){this[i]=value}}else{var bytes=utf8ToBytes(value.toString())
var len=bytes.length
for(i=start;i<end;i++){this[i]=bytes[i%len]}}
return this}
Buffer.prototype.toArrayBuffer=function toArrayBuffer(){if(typeof Uint8Array!=='undefined'){if(Buffer.TYPED_ARRAY_SUPPORT){return(new Buffer(this)).buffer}else{var buf=new Uint8Array(this.length)
for(var i=0,len=buf.length;i<len;i+=1){buf[i]=this[i]}
return buf.buffer}}else{throw new TypeError('Buffer.toArrayBuffer not supported in this browser')}}
var BP=Buffer.prototype
Buffer._augment=function _augment(arr){arr.constructor=Buffer
arr._isBuffer=true
arr._set=arr.set
arr.get=BP.get
arr.set=BP.set
arr.write=BP.write
arr.toString=BP.toString
arr.toLocaleString=BP.toString
arr.toJSON=BP.toJSON
arr.equals=BP.equals
arr.compare=BP.compare
arr.indexOf=BP.indexOf
arr.copy=BP.copy
arr.slice=BP.slice
arr.readUIntLE=BP.readUIntLE
arr.readUIntBE=BP.readUIntBE
arr.readUInt8=BP.readUInt8
arr.readUInt16LE=BP.readUInt16LE
arr.readUInt16BE=BP.readUInt16BE
arr.readUInt32LE=BP.readUInt32LE
arr.readUInt32BE=BP.readUInt32BE
arr.readIntLE=BP.readIntLE
arr.readIntBE=BP.readIntBE
arr.readInt8=BP.readInt8
arr.readInt16LE=BP.readInt16LE
arr.readInt16BE=BP.readInt16BE
arr.readInt32LE=BP.readInt32LE
arr.readInt32BE=BP.readInt32BE
arr.readFloatLE=BP.readFloatLE
arr.readFloatBE=BP.readFloatBE
arr.readDoubleLE=BP.readDoubleLE
arr.readDoubleBE=BP.readDoubleBE
arr.writeUInt8=BP.writeUInt8
arr.writeUIntLE=BP.writeUIntLE
arr.writeUIntBE=BP.writeUIntBE
arr.writeUInt16LE=BP.writeUInt16LE
arr.writeUInt16BE=BP.writeUInt16BE
arr.writeUInt32LE=BP.writeUInt32LE
arr.writeUInt32BE=BP.writeUInt32BE
arr.writeIntLE=BP.writeIntLE
arr.writeIntBE=BP.writeIntBE
arr.writeInt8=BP.writeInt8
arr.writeInt16LE=BP.writeInt16LE
arr.writeInt16BE=BP.writeInt16BE
arr.writeInt32LE=BP.writeInt32LE
arr.writeInt32BE=BP.writeInt32BE
arr.writeFloatLE=BP.writeFloatLE
arr.writeFloatBE=BP.writeFloatBE
arr.writeDoubleLE=BP.writeDoubleLE
arr.writeDoubleBE=BP.writeDoubleBE
arr.fill=BP.fill
arr.inspect=BP.inspect
arr.toArrayBuffer=BP.toArrayBuffer
return arr}
var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g
function base64clean(str){str=stringtrim(str).replace(INVALID_BASE64_RE,'')
if(str.length<2)return''
while(str.length%4!==0){str=str+'='}
return str}
function stringtrim(str){if(str.trim)return str.trim()
return str.replace(/^\s+|\s+$/g,'')}
function toHex(n){if(n<16)return'0'+n.toString(16)
return n.toString(16)}
function utf8ToBytes(string,units){units=units||Infinity
var codePoint
var length=string.length
var leadSurrogate=null
var bytes=[]
for(var i=0;i<length;i++){codePoint=string.charCodeAt(i)
if(codePoint>0xD7FF&&codePoint<0xE000){if(!leadSurrogate){if(codePoint>0xDBFF){if((units-=3)>-1)bytes.push(0xEF,0xBF,0xBD)
continue}else if(i+1===length){if((units-=3)>-1)bytes.push(0xEF,0xBF,0xBD)
continue}
leadSurrogate=codePoint
continue}
if(codePoint<0xDC00){if((units-=3)>-1)bytes.push(0xEF,0xBF,0xBD)
leadSurrogate=codePoint
continue}
codePoint=leadSurrogate-0xD800<<10|codePoint-0xDC00|0x10000}else if(leadSurrogate){if((units-=3)>-1)bytes.push(0xEF,0xBF,0xBD)}
leadSurrogate=null
if(codePoint<0x80){if((units-=1)<0)break
bytes.push(codePoint)}else if(codePoint<0x800){if((units-=2)<0)break
bytes.push(codePoint>>0x6|0xC0,codePoint&0x3F|0x80)}else if(codePoint<0x10000){if((units-=3)<0)break
bytes.push(codePoint>>0xC|0xE0,codePoint>>0x6&0x3F|0x80,codePoint&0x3F|0x80)}else if(codePoint<0x110000){if((units-=4)<0)break
bytes.push(codePoint>>0x12|0xF0,codePoint>>0xC&0x3F|0x80,codePoint>>0x6&0x3F|0x80,codePoint&0x3F|0x80)}else{throw new Error('Invalid code point')}}
return bytes}
function asciiToBytes(str){var byteArray=[]
for(var i=0;i<str.length;i++){byteArray.push(str.charCodeAt(i)&0xFF)}
return byteArray}
function utf16leToBytes(str,units){var c,hi,lo
var byteArray=[]
for(var i=0;i<str.length;i++){if((units-=2)<0)break
c=str.charCodeAt(i)
hi=c>>8
lo=c%256
byteArray.push(lo)
byteArray.push(hi)}
return byteArray}
function base64ToBytes(str){return base64.toByteArray(base64clean(str))}
function blitBuffer(src,dst,offset,length){for(var i=0;i<length;i++){if((i+offset>=dst.length)||(i>=src.length))break
dst[i+offset]=src[i]}
return i}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"base64-js":3,"ieee754":4,"is-array":5}],3:[function(require,module,exports){var lookup='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';;(function(exports){'use strict';var Arr=(typeof Uint8Array!=='undefined')?Uint8Array:Array
var PLUS='+'.charCodeAt(0)
var SLASH='/'.charCodeAt(0)
var NUMBER='0'.charCodeAt(0)
var LOWER='a'.charCodeAt(0)
var UPPER='A'.charCodeAt(0)
var PLUS_URL_SAFE='-'.charCodeAt(0)
var SLASH_URL_SAFE='_'.charCodeAt(0)
function decode(elt){var code=elt.charCodeAt(0)
if(code===PLUS||code===PLUS_URL_SAFE)
return 62
if(code===SLASH||code===SLASH_URL_SAFE)
return 63
if(code<NUMBER)
return-1
if(code<NUMBER+10)
return code-NUMBER+26+26
if(code<UPPER+26)
return code-UPPER
if(code<LOWER+26)
return code-LOWER+26}
function b64ToByteArray(b64){var i,j,l,tmp,placeHolders,arr
if(b64.length%4>0){throw new Error('Invalid string. Length must be a multiple of 4')}
var len=b64.length
placeHolders='='===b64.charAt(len-2)?2:'='===b64.charAt(len-1)?1:0
arr=new Arr(b64.length*3/4-placeHolders)
l=placeHolders>0?b64.length-4:b64.length
var L=0
function push(v){arr[L++]=v}
for(i=0,j=0;i<l;i+=4,j+=3){tmp=(decode(b64.charAt(i))<<18)|(decode(b64.charAt(i+1))<<12)|(decode(b64.charAt(i+2))<<6)|decode(b64.charAt(i+3))
push((tmp&0xFF0000)>>16)
push((tmp&0xFF00)>>8)
push(tmp&0xFF)}
if(placeHolders===2){tmp=(decode(b64.charAt(i))<<2)|(decode(b64.charAt(i+1))>>4)
push(tmp&0xFF)}else if(placeHolders===1){tmp=(decode(b64.charAt(i))<<10)|(decode(b64.charAt(i+1))<<4)|(decode(b64.charAt(i+2))>>2)
push((tmp>>8)&0xFF)
push(tmp&0xFF)}
return arr}
function uint8ToBase64(uint8){var i,extraBytes=uint8.length%3,output="",temp,length
function encode(num){return lookup.charAt(num)}
function tripletToBase64(num){return encode(num>>18&0x3F)+encode(num>>12&0x3F)+encode(num>>6&0x3F)+encode(num&0x3F)}
for(i=0,length=uint8.length-extraBytes;i<length;i+=3){temp=(uint8[i]<<16)+(uint8[i+1]<<8)+(uint8[i+2])
output+=tripletToBase64(temp)}
switch(extraBytes){case 1:temp=uint8[uint8.length-1]
output+=encode(temp>>2)
output+=encode((temp<<4)&0x3F)
output+='=='
break
case 2:temp=(uint8[uint8.length-2]<<8)+(uint8[uint8.length-1])
output+=encode(temp>>10)
output+=encode((temp>>4)&0x3F)
output+=encode((temp<<2)&0x3F)
output+='='
break}
return output}
exports.toByteArray=b64ToByteArray
exports.fromByteArray=uint8ToBase64}(typeof exports==='undefined'?(this.base64js={}):exports))},{}],4:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m
var eLen=nBytes*8-mLen-1
var eMax=(1<<eLen)-1
var eBias=eMax>>1
var nBits=-7
var i=isLE?(nBytes-1):0
var d=isLE?-1:1
var s=buffer[offset+i]
i+=d
e=s&((1<<(-nBits))-1)
s>>=(-nBits)
nBits+=eLen
for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}
m=e&((1<<(-nBits))-1)
e>>=(-nBits)
nBits+=mLen
for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}
if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:((s?-1:1)*Infinity)}else{m=m+Math.pow(2,mLen)
e=e-eBias}
return(s?-1:1)*m*Math.pow(2,e-mLen)}
exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c
var eLen=nBytes*8-mLen-1
var eMax=(1<<eLen)-1
var eBias=eMax>>1
var rt=(mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0)
var i=isLE?0:(nBytes-1)
var d=isLE?1:-1
var s=value<0||(value===0&&1/value<0)?1:0
value=Math.abs(value)
if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0
e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2)
if(value*(c=Math.pow(2,-e))<1){e--
c*=2}
if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}
if(value*c>=2){e++
c/=2}
if(e+eBias>=eMax){m=0
e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen)
e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen)
e=0}}
for(;mLen>=8;buffer[offset+i]=m&0xff,i+=d,m/=256,mLen-=8){}
e=(e<<mLen)|m
eLen+=mLen
for(;eLen>0;buffer[offset+i]=e&0xff,i+=d,e/=256,eLen-=8){}
buffer[offset+i-d]|=s*128}},{}],5:[function(require,module,exports){var isArray=Array.isArray;var str=Object.prototype.toString;module.exports=isArray||function(val){return!!val&&'[object Array]'==str.call(val);};},{}],6:[function(require,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined;}
module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))
throw TypeError('n must be a positive number');this._maxListeners=n;return this;};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)
this._events={};if(type==='error'){if(!this._events.error||(isObject(this._events.error)&&!this._events.error.length)){er=arguments[1];if(er instanceof Error){throw er;}
throw TypeError('Uncaught, unspecified "error" event.');}}
handler=this._events[type];if(isUndefined(handler))
return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)
args[i-1]=arguments[i];handler.apply(this,args);}}else if(isObject(handler)){len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)
args[i-1]=arguments[i];listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)
listeners[i].apply(this,args);}
return true;};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))
throw TypeError('listener must be a function');if(!this._events)
this._events={};if(this._events.newListener)
this.emit('newListener',type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])
this._events[type]=listener;else if(isObject(this._events[type]))
this._events[type].push(listener);else
this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){var m;if(!isUndefined(this._maxListeners)){m=this._maxListeners;}else{m=EventEmitter.defaultMaxListeners;}
if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error('(node) warning: possible EventEmitter memory '+'leak detected. %d listeners added. '+'Use emitter.setMaxListeners() to increase limit.',this._events[type].length);if(typeof console.trace==='function'){console.trace();}}}
return this;};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))
throw TypeError('listener must be a function');var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments);}}
g.listener=listener;this.on(type,g);return this;};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))
throw TypeError('listener must be a function');if(!this._events||!this._events[type])
return this;list=this._events[type];length=list.length;position=-1;if(list===listener||(isFunction(list.listener)&&list.listener===listener)){delete this._events[type];if(this._events.removeListener)
this.emit('removeListener',type,listener);}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||(list[i].listener&&list[i].listener===listener)){position=i;break;}}
if(position<0)
return this;if(list.length===1){list.length=0;delete this._events[type];}else{list.splice(position,1);}
if(this._events.removeListener)
this.emit('removeListener',type,listener);}
return this;};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)
return this;if(!this._events.removeListener){if(arguments.length===0)
this._events={};else if(this._events[type])
delete this._events[type];return this;}
if(arguments.length===0){for(key in this._events){if(key==='removeListener')continue;this.removeAllListeners(key);}
this.removeAllListeners('removeListener');this._events={};return this;}
listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners);}else{while(listeners.length)
this.removeListener(type,listeners[listeners.length-1]);}
delete this._events[type];return this;};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])
ret=[];else if(isFunction(this._events[type]))
ret=[this._events[type]];else
ret=this._events[type].slice();return ret;};EventEmitter.listenerCount=function(emitter,type){var ret;if(!emitter._events||!emitter._events[type])
ret=0;else if(isFunction(emitter._events[type]))
ret=1;else
ret=emitter._events[type].length;return ret;};function isFunction(arg){return typeof arg==='function';}
function isNumber(arg){return typeof arg==='number';}
function isObject(arg){return typeof arg==='object'&&arg!==null;}
function isUndefined(arg){return arg===void 0;}},{}],7:[function(require,module,exports){if(typeof Object.create==='function'){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor
ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}});};}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor
var TempCtor=function(){}
TempCtor.prototype=superCtor.prototype
ctor.prototype=new TempCtor()
ctor.prototype.constructor=ctor}}},{}],8:[function(require,module,exports){module.exports=function(obj){return!!(obj!=null&&(obj._isBuffer||(obj.constructor&&typeof obj.constructor.isBuffer==='function'&&obj.constructor.isBuffer(obj))))}},{}],9:[function(require,module,exports){module.exports=Array.isArray||function(arr){return Object.prototype.toString.call(arr)=='[object Array]';};},{}],10:[function(require,module,exports){var process=module.exports={};var queue=[];var draining=false;function drainQueue(){if(draining){return;}
draining=true;var currentQueue;var len=queue.length;while(len){currentQueue=queue;queue=[];var i=-1;while(++i<len){currentQueue[i]();}
len=queue.length;}
draining=false;}
process.nextTick=function(fun){queue.push(fun);if(!draining){setTimeout(drainQueue,0);}};process.title='browser';process.browser=true;process.env={};process.argv=[];process.version='';process.versions={};function noop(){}
process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error('process.binding is not supported');};process.cwd=function(){return'/'};process.chdir=function(dir){throw new Error('process.chdir is not supported');};process.umask=function(){return 0;};},{}],11:[function(require,module,exports){module.exports=require("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":12}],12:[function(require,module,exports){(function(process){module.exports=Duplex;var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys;}
var util=require('core-util-is');util.inherits=require('inherits');var Readable=require('./_stream_readable');var Writable=require('./_stream_writable');util.inherits(Duplex,Readable);forEach(objectKeys(Writable.prototype),function(method){if(!Duplex.prototype[method])
Duplex.prototype[method]=Writable.prototype[method];});function Duplex(options){if(!(this instanceof Duplex))
return new Duplex(options);Readable.call(this,options);Writable.call(this,options);if(options&&options.readable===false)
this.readable=false;if(options&&options.writable===false)
this.writable=false;this.allowHalfOpen=true;if(options&&options.allowHalfOpen===false)
this.allowHalfOpen=false;this.once('end',onend);}
function onend(){if(this.allowHalfOpen||this._writableState.ended)
return;process.nextTick(this.end.bind(this));}
function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i);}}}).call(this,require('_process'))},{"./_stream_readable":14,"./_stream_writable":16,"_process":10,"core-util-is":17,"inherits":7}],13:[function(require,module,exports){module.exports=PassThrough;var Transform=require('./_stream_transform');var util=require('core-util-is');util.inherits=require('inherits');util.inherits(PassThrough,Transform);function PassThrough(options){if(!(this instanceof PassThrough))
return new PassThrough(options);Transform.call(this,options);}
PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk);};},{"./_stream_transform":15,"core-util-is":17,"inherits":7}],14:[function(require,module,exports){(function(process){module.exports=Readable;var isArray=require('isarray');var Buffer=require('buffer').Buffer;Readable.ReadableState=ReadableState;var EE=require('events').EventEmitter;if(!EE.listenerCount)EE.listenerCount=function(emitter,type){return emitter.listeners(type).length;};var Stream=require('stream');var util=require('core-util-is');util.inherits=require('inherits');var StringDecoder;var debug=require('util');if(debug&&debug.debuglog){debug=debug.debuglog('stream');}else{debug=function(){};}
util.inherits(Readable,Stream);function ReadableState(options,stream){var Duplex=require('./_stream_duplex');options=options||{};var hwm=options.highWaterMark;var defaultHwm=options.objectMode?16:16*1024;this.highWaterMark=(hwm||hwm===0)?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.buffer=[];this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.objectMode=!!options.objectMode;if(stream instanceof Duplex)
this.objectMode=this.objectMode||!!options.readableObjectMode;this.defaultEncoding=options.defaultEncoding||'utf8';this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)
StringDecoder=require('string_decoder/').StringDecoder;this.decoder=new StringDecoder(options.encoding);this.encoding=options.encoding;}}
function Readable(options){var Duplex=require('./_stream_duplex');if(!(this instanceof Readable))
return new Readable(options);this._readableState=new ReadableState(options,this);this.readable=true;Stream.call(this);}
Readable.prototype.push=function(chunk,encoding){var state=this._readableState;if(util.isString(chunk)&&!state.objectMode){encoding=encoding||state.defaultEncoding;if(encoding!==state.encoding){chunk=new Buffer(chunk,encoding);encoding='';}}
return readableAddChunk(this,state,chunk,encoding,false);};Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,'',true);};function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er){stream.emit('error',er);}else if(util.isNullOrUndefined(chunk)){state.reading=false;if(!state.ended)
onEofChunk(stream,state);}else if(state.objectMode||chunk&&chunk.length>0){if(state.ended&&!addToFront){var e=new Error('stream.push() after EOF');stream.emit('error',e);}else if(state.endEmitted&&addToFront){var e=new Error('stream.unshift() after end event');stream.emit('error',e);}else{if(state.decoder&&!addToFront&&!encoding)
chunk=state.decoder.write(chunk);if(!addToFront)
state.reading=false;if(state.flowing&&state.length===0&&!state.sync){stream.emit('data',chunk);stream.read(0);}else{state.length+=state.objectMode?1:chunk.length;if(addToFront)
state.buffer.unshift(chunk);else
state.buffer.push(chunk);if(state.needReadable)
emitReadable(stream);}
maybeReadMore(stream,state);}}else if(!addToFront){state.reading=false;}
return needMoreData(state);}
function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||state.length===0);}
Readable.prototype.setEncoding=function(enc){if(!StringDecoder)
StringDecoder=require('string_decoder/').StringDecoder;this._readableState.decoder=new StringDecoder(enc);this._readableState.encoding=enc;return this;};var MAX_HWM=0x800000;function roundUpToNextPowerOf2(n){if(n>=MAX_HWM){n=MAX_HWM;}else{n--;for(var p=1;p<32;p<<=1)n|=n>>p;n++;}
return n;}
function howMuchToRead(n,state){if(state.length===0&&state.ended)
return 0;if(state.objectMode)
return n===0?0:1;if(isNaN(n)||util.isNull(n)){if(state.flowing&&state.buffer.length)
return state.buffer[0].length;else
return state.length;}
if(n<=0)
return 0;if(n>state.highWaterMark)
state.highWaterMark=roundUpToNextPowerOf2(n);if(n>state.length){if(!state.ended){state.needReadable=true;return 0;}else
return state.length;}
return n;}
Readable.prototype.read=function(n){debug('read',n);var state=this._readableState;var nOrig=n;if(!util.isNumber(n)||n>0)
state.emittedReadable=false;if(n===0&&state.needReadable&&(state.length>=state.highWaterMark||state.ended)){debug('read: emitReadable',state.length,state.ended);if(state.length===0&&state.ended)
endReadable(this);else
emitReadable(this);return null;}
n=howMuchToRead(n,state);if(n===0&&state.ended){if(state.length===0)
endReadable(this);return null;}
var doRead=state.needReadable;debug('need readable',doRead);if(state.length===0||state.length-n<state.highWaterMark){doRead=true;debug('length less than watermark',doRead);}
if(state.ended||state.reading){doRead=false;debug('reading or ended',doRead);}
if(doRead){debug('do read');state.reading=true;state.sync=true;if(state.length===0)
state.needReadable=true;this._read(state.highWaterMark);state.sync=false;}
if(doRead&&!state.reading)
n=howMuchToRead(nOrig,state);var ret;if(n>0)
ret=fromList(n,state);else
ret=null;if(util.isNull(ret)){state.needReadable=true;n=0;}
state.length-=n;if(state.length===0&&!state.ended)
state.needReadable=true;if(nOrig!==n&&state.ended&&state.length===0)
endReadable(this);if(!util.isNull(ret))
this.emit('data',ret);return ret;};function chunkInvalid(state,chunk){var er=null;if(!util.isBuffer(chunk)&&!util.isString(chunk)&&!util.isNullOrUndefined(chunk)&&!state.objectMode){er=new TypeError('Invalid non-string/buffer chunk');}
return er;}
function onEofChunk(stream,state){if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length){state.buffer.push(chunk);state.length+=state.objectMode?1:chunk.length;}}
state.ended=true;emitReadable(stream);}
function emitReadable(stream){var state=stream._readableState;state.needReadable=false;if(!state.emittedReadable){debug('emitReadable',state.flowing);state.emittedReadable=true;if(state.sync)
process.nextTick(function(){emitReadable_(stream);});else
emitReadable_(stream);}}
function emitReadable_(stream){debug('emit readable');stream.emit('readable');flow(stream);}
function maybeReadMore(stream,state){if(!state.readingMore){state.readingMore=true;process.nextTick(function(){maybeReadMore_(stream,state);});}}
function maybeReadMore_(stream,state){var len=state.length;while(!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark){debug('maybeReadMore read 0');stream.read(0);if(len===state.length)
break;else
len=state.length;}
state.readingMore=false;}
Readable.prototype._read=function(n){this.emit('error',new Error('not implemented'));};Readable.prototype.pipe=function(dest,pipeOpts){var src=this;var state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest);break;}
state.pipesCount+=1;debug('pipe count=%d opts=%j',state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:cleanup;if(state.endEmitted)
process.nextTick(endFn);else
src.once('end',endFn);dest.on('unpipe',onunpipe);function onunpipe(readable){debug('onunpipe');if(readable===src){cleanup();}}
function onend(){debug('onend');dest.end();}
var ondrain=pipeOnDrain(src);dest.on('drain',ondrain);function cleanup(){debug('cleanup');dest.removeListener('close',onclose);dest.removeListener('finish',onfinish);dest.removeListener('drain',ondrain);dest.removeListener('error',onerror);dest.removeListener('unpipe',onunpipe);src.removeListener('end',onend);src.removeListener('end',cleanup);src.removeListener('data',ondata);if(state.awaitDrain&&(!dest._writableState||dest._writableState.needDrain))
ondrain();}
src.on('data',ondata);function ondata(chunk){debug('ondata');var ret=dest.write(chunk);if(false===ret){debug('false write response, pause',src._readableState.awaitDrain);src._readableState.awaitDrain++;src.pause();}}
function onerror(er){debug('onerror',er);unpipe();dest.removeListener('error',onerror);if(EE.listenerCount(dest,'error')===0)
dest.emit('error',er);}
if(!dest._events||!dest._events.error)
dest.on('error',onerror);else if(isArray(dest._events.error))
dest._events.error.unshift(onerror);else
dest._events.error=[onerror,dest._events.error];function onclose(){dest.removeListener('finish',onfinish);unpipe();}
dest.once('close',onclose);function onfinish(){debug('onfinish');dest.removeListener('close',onclose);unpipe();}
dest.once('finish',onfinish);function unpipe(){debug('unpipe');src.unpipe(dest);}
dest.emit('pipe',src);if(!state.flowing){debug('pipe resume');src.resume();}
return dest;};function pipeOnDrain(src){return function(){var state=src._readableState;debug('pipeOnDrain',state.awaitDrain);if(state.awaitDrain)
state.awaitDrain--;if(state.awaitDrain===0&&EE.listenerCount(src,'data')){state.flowing=true;flow(src);}};}
Readable.prototype.unpipe=function(dest){var state=this._readableState;if(state.pipesCount===0)
return this;if(state.pipesCount===1){if(dest&&dest!==state.pipes)
return this;if(!dest)
dest=state.pipes;state.pipes=null;state.pipesCount=0;state.flowing=false;if(dest)
dest.emit('unpipe',this);return this;}
if(!dest){var dests=state.pipes;var len=state.pipesCount;state.pipes=null;state.pipesCount=0;state.flowing=false;for(var i=0;i<len;i++)
dests[i].emit('unpipe',this);return this;}
var i=indexOf(state.pipes,dest);if(i===-1)
return this;state.pipes.splice(i,1);state.pipesCount-=1;if(state.pipesCount===1)
state.pipes=state.pipes[0];dest.emit('unpipe',this);return this;};Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if(ev==='data'&&false!==this._readableState.flowing){this.resume();}
if(ev==='readable'&&this.readable){var state=this._readableState;if(!state.readableListening){state.readableListening=true;state.emittedReadable=false;state.needReadable=true;if(!state.reading){var self=this;process.nextTick(function(){debug('readable nexttick read 0');self.read(0);});}else if(state.length){emitReadable(this,state);}}}
return res;};Readable.prototype.addListener=Readable.prototype.on;Readable.prototype.resume=function(){var state=this._readableState;if(!state.flowing){debug('resume');state.flowing=true;if(!state.reading){debug('resume read 0');this.read(0);}
resume(this,state);}
return this;};function resume(stream,state){if(!state.resumeScheduled){state.resumeScheduled=true;process.nextTick(function(){resume_(stream,state);});}}
function resume_(stream,state){state.resumeScheduled=false;stream.emit('resume');flow(stream);if(state.flowing&&!state.reading)
stream.read(0);}
Readable.prototype.pause=function(){debug('call pause flowing=%j',this._readableState.flowing);if(false!==this._readableState.flowing){debug('pause');this._readableState.flowing=false;this.emit('pause');}
return this;};function flow(stream){var state=stream._readableState;debug('flow',state.flowing);if(state.flowing){do{var chunk=stream.read();}while(null!==chunk&&state.flowing);}}
Readable.prototype.wrap=function(stream){var state=this._readableState;var paused=false;var self=this;stream.on('end',function(){debug('wrapped end');if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length)
self.push(chunk);}
self.push(null);});stream.on('data',function(chunk){debug('wrapped data');if(state.decoder)
chunk=state.decoder.write(chunk);if(!chunk||!state.objectMode&&!chunk.length)
return;var ret=self.push(chunk);if(!ret){paused=true;stream.pause();}});for(var i in stream){if(util.isFunction(stream[i])&&util.isUndefined(this[i])){this[i]=function(method){return function(){return stream[method].apply(stream,arguments);}}(i);}}
var events=['error','close','destroy','pause','resume'];forEach(events,function(ev){stream.on(ev,self.emit.bind(self,ev));});self._read=function(n){debug('wrapped _read',n);if(paused){paused=false;stream.resume();}};return self;};Readable._fromList=fromList;function fromList(n,state){var list=state.buffer;var length=state.length;var stringMode=!!state.decoder;var objectMode=!!state.objectMode;var ret;if(list.length===0)
return null;if(length===0)
ret=null;else if(objectMode)
ret=list.shift();else if(!n||n>=length){if(stringMode)
ret=list.join('');else
ret=Buffer.concat(list,length);list.length=0;}else{if(n<list[0].length){var buf=list[0];ret=buf.slice(0,n);list[0]=buf.slice(n);}else if(n===list[0].length){ret=list.shift();}else{if(stringMode)
ret='';else
ret=new Buffer(n);var c=0;for(var i=0,l=list.length;i<l&&c<n;i++){var buf=list[0];var cpy=Math.min(n-c,buf.length);if(stringMode)
ret+=buf.slice(0,cpy);else
buf.copy(ret,c,0,cpy);if(cpy<buf.length)
list[0]=buf.slice(cpy);else
list.shift();c+=cpy;}}}
return ret;}
function endReadable(stream){var state=stream._readableState;if(state.length>0)
throw new Error('endReadable called on non-empty stream');if(!state.endEmitted){state.ended=true;process.nextTick(function(){if(!state.endEmitted&&state.length===0){state.endEmitted=true;stream.readable=false;stream.emit('end');}});}}
function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i);}}
function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x)return i;}
return-1;}}).call(this,require('_process'))},{"./_stream_duplex":12,"_process":10,"buffer":2,"core-util-is":17,"events":6,"inherits":7,"isarray":9,"stream":22,"string_decoder/":23,"util":1}],15:[function(require,module,exports){module.exports=Transform;var Duplex=require('./_stream_duplex');var util=require('core-util-is');util.inherits=require('inherits');util.inherits(Transform,Duplex);function TransformState(options,stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data);};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null;}
function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=false;var cb=ts.writecb;if(!cb)
return stream.emit('error',new Error('no writecb in Transform class'));ts.writechunk=null;ts.writecb=null;if(!util.isNullOrUndefined(data))
stream.push(data);if(cb)
cb(er);var rs=stream._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark){stream._read(rs.highWaterMark);}}
function Transform(options){if(!(this instanceof Transform))
return new Transform(options);Duplex.call(this,options);this._transformState=new TransformState(options,this);var stream=this;this._readableState.needReadable=true;this._readableState.sync=false;this.once('prefinish',function(){if(util.isFunction(this._flush))
this._flush(function(er){done(stream,er);});else
done(stream);});}
Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding);};Transform.prototype._transform=function(chunk,encoding,cb){throw new Error('not implemented');};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)
this._read(rs.highWaterMark);}};Transform.prototype._read=function(n){var ts=this._transformState;if(!util.isNull(ts.writechunk)&&ts.writecb&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform);}else{ts.needTransform=true;}};function done(stream,er){if(er)
return stream.emit('error',er);var ws=stream._writableState;var ts=stream._transformState;if(ws.length)
throw new Error('calling transform done when ws.length != 0');if(ts.transforming)
throw new Error('calling transform done when still transforming');return stream.push(null);}},{"./_stream_duplex":12,"core-util-is":17,"inherits":7}],16:[function(require,module,exports){(function(process){module.exports=Writable;var Buffer=require('buffer').Buffer;Writable.WritableState=WritableState;var util=require('core-util-is');util.inherits=require('inherits');var Stream=require('stream');util.inherits(Writable,Stream);function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb;}
function WritableState(options,stream){var Duplex=require('./_stream_duplex');options=options||{};var hwm=options.highWaterMark;var defaultHwm=options.objectMode?16:16*1024;this.highWaterMark=(hwm||hwm===0)?hwm:defaultHwm;this.objectMode=!!options.objectMode;if(stream instanceof Duplex)
this.objectMode=this.objectMode||!!options.writableObjectMode;this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||'utf8';this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er);};this.writecb=null;this.writelen=0;this.buffer=[];this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;}
function Writable(options){var Duplex=require('./_stream_duplex');if(!(this instanceof Writable)&&!(this instanceof Duplex))
return new Writable(options);this._writableState=new WritableState(options,this);this.writable=true;Stream.call(this);}
Writable.prototype.pipe=function(){this.emit('error',new Error('Cannot pipe. Not readable.'));};function writeAfterEnd(stream,state,cb){var er=new Error('write after end');stream.emit('error',er);process.nextTick(function(){cb(er);});}
function validChunk(stream,state,chunk,cb){var valid=true;if(!util.isBuffer(chunk)&&!util.isString(chunk)&&!util.isNullOrUndefined(chunk)&&!state.objectMode){var er=new TypeError('Invalid non-string/buffer chunk');stream.emit('error',er);process.nextTick(function(){cb(er);});valid=false;}
return valid;}
Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState;var ret=false;if(util.isFunction(encoding)){cb=encoding;encoding=null;}
if(util.isBuffer(chunk))
encoding='buffer';else if(!encoding)
encoding=state.defaultEncoding;if(!util.isFunction(cb))
cb=function(){};if(state.ended)
writeAfterEnd(this,state,cb);else if(validChunk(this,state,chunk,cb)){state.pendingcb++;ret=writeOrBuffer(this,state,chunk,encoding,cb);}
return ret;};Writable.prototype.cork=function(){var state=this._writableState;state.corked++;};Writable.prototype.uncork=function(){var state=this._writableState;if(state.corked){state.corked--;if(!state.writing&&!state.corked&&!state.finished&&!state.bufferProcessing&&state.buffer.length)
clearBuffer(this,state);}};function decodeChunk(state,chunk,encoding){if(!state.objectMode&&state.decodeStrings!==false&&util.isString(chunk)){chunk=new Buffer(chunk,encoding);}
return chunk;}
function writeOrBuffer(stream,state,chunk,encoding,cb){chunk=decodeChunk(state,chunk,encoding);if(util.isBuffer(chunk))
encoding='buffer';var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(!ret)
state.needDrain=true;if(state.writing||state.corked)
state.buffer.push(new WriteReq(chunk,encoding,cb));else
doWrite(stream,state,false,len,chunk,encoding,cb);return ret;}
function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len;state.writecb=cb;state.writing=true;state.sync=true;if(writev)
stream._writev(chunk,state.onwrite);else
stream._write(chunk,encoding,state.onwrite);state.sync=false;}
function onwriteError(stream,state,sync,er,cb){if(sync)
process.nextTick(function(){state.pendingcb--;cb(er);});else{state.pendingcb--;cb(er);}
stream._writableState.errorEmitted=true;stream.emit('error',er);}
function onwriteStateUpdate(state){state.writing=false;state.writecb=null;state.length-=state.writelen;state.writelen=0;}
function onwrite(stream,er){var state=stream._writableState;var sync=state.sync;var cb=state.writecb;onwriteStateUpdate(state);if(er)
onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(stream,state);if(!finished&&!state.corked&&!state.bufferProcessing&&state.buffer.length){clearBuffer(stream,state);}
if(sync){process.nextTick(function(){afterWrite(stream,state,finished,cb);});}else{afterWrite(stream,state,finished,cb);}}}
function afterWrite(stream,state,finished,cb){if(!finished)
onwriteDrain(stream,state);state.pendingcb--;cb();finishMaybe(stream,state);}
function onwriteDrain(stream,state){if(state.length===0&&state.needDrain){state.needDrain=false;stream.emit('drain');}}
function clearBuffer(stream,state){state.bufferProcessing=true;if(stream._writev&&state.buffer.length>1){var cbs=[];for(var c=0;c<state.buffer.length;c++)
cbs.push(state.buffer[c].callback);state.pendingcb++;doWrite(stream,state,true,state.length,state.buffer,'',function(err){for(var i=0;i<cbs.length;i++){state.pendingcb--;cbs[i](err);}});state.buffer=[];}else{for(var c=0;c<state.buffer.length;c++){var entry=state.buffer[c];var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state.objectMode?1:chunk.length;doWrite(stream,state,false,len,chunk,encoding,cb);if(state.writing){c++;break;}}
if(c<state.buffer.length)
state.buffer=state.buffer.slice(c);else
state.buffer.length=0;}
state.bufferProcessing=false;}
Writable.prototype._write=function(chunk,encoding,cb){cb(new Error('not implemented'));};Writable.prototype._writev=null;Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;if(util.isFunction(chunk)){cb=chunk;chunk=null;encoding=null;}else if(util.isFunction(encoding)){cb=encoding;encoding=null;}
if(!util.isNullOrUndefined(chunk))
this.write(chunk,encoding);if(state.corked){state.corked=1;this.uncork();}
if(!state.ending&&!state.finished)
endWritable(this,state,cb);};function needFinish(stream,state){return(state.ending&&state.length===0&&!state.finished&&!state.writing);}
function prefinish(stream,state){if(!state.prefinished){state.prefinished=true;stream.emit('prefinish');}}
function finishMaybe(stream,state){var need=needFinish(stream,state);if(need){if(state.pendingcb===0){prefinish(stream,state);state.finished=true;stream.emit('finish');}else
prefinish(stream,state);}
return need;}
function endWritable(stream,state,cb){state.ending=true;finishMaybe(stream,state);if(cb){if(state.finished)
process.nextTick(cb);else
stream.once('finish',cb);}
state.ended=true;}}).call(this,require('_process'))},{"./_stream_duplex":12,"_process":10,"buffer":2,"core-util-is":17,"inherits":7,"stream":22}],17:[function(require,module,exports){(function(Buffer){function isArray(ar){return Array.isArray(ar);}
exports.isArray=isArray;function isBoolean(arg){return typeof arg==='boolean';}
exports.isBoolean=isBoolean;function isNull(arg){return arg===null;}
exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null;}
exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==='number';}
exports.isNumber=isNumber;function isString(arg){return typeof arg==='string';}
exports.isString=isString;function isSymbol(arg){return typeof arg==='symbol';}
exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0;}
exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==='[object RegExp]';}
exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==='object'&&arg!==null;}
exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==='[object Date]';}
exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==='[object Error]'||e instanceof Error);}
exports.isError=isError;function isFunction(arg){return typeof arg==='function';}
exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==='boolean'||typeof arg==='number'||typeof arg==='string'||typeof arg==='symbol'||typeof arg==='undefined';}
exports.isPrimitive=isPrimitive;function isBuffer(arg){return Buffer.isBuffer(arg);}
exports.isBuffer=isBuffer;function objectToString(o){return Object.prototype.toString.call(o);}}).call(this,{"isBuffer":require("../../../../insert-module-globals/node_modules/is-buffer/index.js")})},{"../../../../insert-module-globals/node_modules/is-buffer/index.js":8}],18:[function(require,module,exports){module.exports=require("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":13}],19:[function(require,module,exports){exports=module.exports=require('./lib/_stream_readable.js');exports.Stream=require('stream');exports.Readable=exports;exports.Writable=require('./lib/_stream_writable.js');exports.Duplex=require('./lib/_stream_duplex.js');exports.Transform=require('./lib/_stream_transform.js');exports.PassThrough=require('./lib/_stream_passthrough.js');},{"./lib/_stream_duplex.js":12,"./lib/_stream_passthrough.js":13,"./lib/_stream_readable.js":14,"./lib/_stream_transform.js":15,"./lib/_stream_writable.js":16,"stream":22}],20:[function(require,module,exports){module.exports=require("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":15}],21:[function(require,module,exports){module.exports=require("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":16}],22:[function(require,module,exports){module.exports=Stream;var EE=require('events').EventEmitter;var inherits=require('inherits');inherits(Stream,EE);Stream.Readable=require('readable-stream/readable.js');Stream.Writable=require('readable-stream/writable.js');Stream.Duplex=require('readable-stream/duplex.js');Stream.Transform=require('readable-stream/transform.js');Stream.PassThrough=require('readable-stream/passthrough.js');Stream.Stream=Stream;function Stream(){EE.call(this);}
Stream.prototype.pipe=function(dest,options){var source=this;function ondata(chunk){if(dest.writable){if(false===dest.write(chunk)&&source.pause){source.pause();}}}
source.on('data',ondata);function ondrain(){if(source.readable&&source.resume){source.resume();}}
dest.on('drain',ondrain);if(!dest._isStdio&&(!options||options.end!==false)){source.on('end',onend);source.on('close',onclose);}
var didOnEnd=false;function onend(){if(didOnEnd)return;didOnEnd=true;dest.end();}
function onclose(){if(didOnEnd)return;didOnEnd=true;if(typeof dest.destroy==='function')dest.destroy();}
function onerror(er){cleanup();if(EE.listenerCount(this,'error')===0){throw er;}}
source.on('error',onerror);dest.on('error',onerror);function cleanup(){source.removeListener('data',ondata);dest.removeListener('drain',ondrain);source.removeListener('end',onend);source.removeListener('close',onclose);source.removeListener('error',onerror);dest.removeListener('error',onerror);source.removeListener('end',cleanup);source.removeListener('close',cleanup);dest.removeListener('close',cleanup);}
source.on('end',cleanup);source.on('close',cleanup);dest.on('close',cleanup);dest.emit('pipe',source);return dest;};},{"events":6,"inherits":7,"readable-stream/duplex.js":11,"readable-stream/passthrough.js":18,"readable-stream/readable.js":19,"readable-stream/transform.js":20,"readable-stream/writable.js":21}],23:[function(require,module,exports){var Buffer=require('buffer').Buffer;var isBufferEncoding=Buffer.isEncoding||function(encoding){switch(encoding&&encoding.toLowerCase()){case'hex':case'utf8':case'utf-8':case'ascii':case'binary':case'base64':case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':case'raw':return true;default:return false;}}
function assertEncoding(encoding){if(encoding&&!isBufferEncoding(encoding)){throw new Error('Unknown encoding: '+encoding);}}
var StringDecoder=exports.StringDecoder=function(encoding){this.encoding=(encoding||'utf8').toLowerCase().replace(/[-_]/,'');assertEncoding(encoding);switch(this.encoding){case'utf8':this.surrogateSize=3;break;case'ucs2':case'utf16le':this.surrogateSize=2;this.detectIncompleteChar=utf16DetectIncompleteChar;break;case'base64':this.surrogateSize=3;this.detectIncompleteChar=base64DetectIncompleteChar;break;default:this.write=passThroughWrite;return;}
this.charBuffer=new Buffer(6);this.charReceived=0;this.charLength=0;};StringDecoder.prototype.write=function(buffer){var charStr='';while(this.charLength){var available=(buffer.length>=this.charLength-this.charReceived)?this.charLength-this.charReceived:buffer.length;buffer.copy(this.charBuffer,this.charReceived,0,available);this.charReceived+=available;if(this.charReceived<this.charLength){return'';}
buffer=buffer.slice(available,buffer.length);charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(charCode>=0xD800&&charCode<=0xDBFF){this.charLength+=this.surrogateSize;charStr='';continue;}
this.charReceived=this.charLength=0;if(buffer.length===0){return charStr;}
break;}
this.detectIncompleteChar(buffer);var end=buffer.length;if(this.charLength){buffer.copy(this.charBuffer,0,buffer.length-this.charReceived,end);end-=this.charReceived;}
charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1;var charCode=charStr.charCodeAt(end);if(charCode>=0xD800&&charCode<=0xDBFF){var size=this.surrogateSize;this.charLength+=size;this.charReceived+=size;this.charBuffer.copy(this.charBuffer,size,0,size);buffer.copy(this.charBuffer,0,0,size);return charStr.substring(0,end);}
return charStr;};StringDecoder.prototype.detectIncompleteChar=function(buffer){var i=(buffer.length>=3)?3:buffer.length;for(;i>0;i--){var c=buffer[buffer.length-i];if(i==1&&c>>5==0x06){this.charLength=2;break;}
if(i<=2&&c>>4==0x0E){this.charLength=3;break;}
if(i<=3&&c>>3==0x1E){this.charLength=4;break;}}
this.charReceived=i;};StringDecoder.prototype.end=function(buffer){var res='';if(buffer&&buffer.length)
res=this.write(buffer);if(this.charReceived){var cr=this.charReceived;var buf=this.charBuffer;var enc=this.encoding;res+=buf.slice(0,cr).toString(enc);}
return res;};function passThroughWrite(buffer){return buffer.toString(this.encoding);}
function utf16DetectIncompleteChar(buffer){this.charReceived=buffer.length%2;this.charLength=this.charReceived?2:0;}
function base64DetectIncompleteChar(buffer){this.charReceived=buffer.length%3;this.charLength=this.charReceived?3:0;}},{"buffer":2}],24:[function(require,module,exports){module.exports=function isBuffer(arg){return arg&&typeof arg==='object'&&typeof arg.copy==='function'&&typeof arg.fill==='function'&&typeof arg.readUInt8==='function';}},{}],25:[function(require,module,exports){(function(process,global){var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]));}
return objects.join(' ');}
var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,function(x){if(x==='%%')return'%';if(i>=len)return x;switch(x){case'%s':return String(args[i++]);case'%d':return Number(args[i++]);case'%j':try{return JSON.stringify(args[i++]);}catch(_){return'[Circular]';}
default:return x;}});for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=' '+x;}else{str+=' '+inspect(x);}}
return str;};exports.deprecate=function(fn,msg){if(isUndefined(global.process)){return function(){return exports.deprecate(fn,msg).apply(this,arguments);};}
if(process.noDeprecation===true){return fn;}
var warned=false;function deprecated(){if(!warned){if(process.throwDeprecation){throw new Error(msg);}else if(process.traceDeprecation){console.trace(msg);}else{console.error(msg);}
warned=true;}
return fn.apply(this,arguments);}
return deprecated;};var debugs={};var debugEnviron;exports.debuglog=function(set){if(isUndefined(debugEnviron))
debugEnviron=process.env.NODE_DEBUG||'';set=set.toUpperCase();if(!debugs[set]){if(new RegExp('\\b'+set+'\\b','i').test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error('%s %d: %s',set,pid,msg);};}else{debugs[set]=function(){};}}
return debugs[set];};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts;}else if(opts){exports._extend(ctx,opts);}
if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth);}
exports.inspect=inspect;inspect.colors={'bold':[1,22],'italic':[3,23],'underline':[4,24],'inverse':[7,27],'white':[37,39],'grey':[90,39],'black':[30,39],'blue':[34,39],'cyan':[36,39],'green':[32,39],'magenta':[35,39],'red':[31,39],'yellow':[33,39]};inspect.styles={'special':'cyan','number':'yellow','boolean':'yellow','undefined':'grey','null':'bold','string':'green','date':'magenta','regexp':'red'};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return'\u001b['+inspect.colors[style][0]+'m'+str+'\u001b['+inspect.colors[style][1]+'m';}else{return str;}}
function stylizeNoColor(str,styleType){return str;}
function arrayToHash(array){var hash={};array.forEach(function(val,idx){hash[val]=true;});return hash;}
function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes);}
return ret;}
var primitive=formatPrimitive(ctx,value);if(primitive){return primitive;}
var keys=Object.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=Object.getOwnPropertyNames(value);}
if(isError(value)&&(keys.indexOf('message')>=0||keys.indexOf('description')>=0)){return formatError(value);}
if(keys.length===0){if(isFunction(value)){var name=value.name?': '+value.name:'';return ctx.stylize('[Function'+name+']','special');}
if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),'regexp');}
if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),'date');}
if(isError(value)){return formatError(value);}}
var base='',array=false,braces=['{','}'];if(isArray(value)){array=true;braces=['[',']'];}
if(isFunction(value)){var n=value.name?': '+value.name:'';base=' [Function'+n+']';}
if(isRegExp(value)){base=' '+RegExp.prototype.toString.call(value);}
if(isDate(value)){base=' '+Date.prototype.toUTCString.call(value);}
if(isError(value)){base=' '+formatError(value);}
if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1];}
if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),'regexp');}else{return ctx.stylize('[Object]','special');}}
ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys);}else{output=keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array);});}
ctx.seen.pop();return reduceToSingleString(output,base,braces);}
function formatPrimitive(ctx,value){if(isUndefined(value))
return ctx.stylize('undefined','undefined');if(isString(value)){var simple='\''+JSON.stringify(value).replace(/^"|"$/g,'').replace(/'/g,"\\'").replace(/\\"/g,'"')+'\'';return ctx.stylize(simple,'string');}
if(isNumber(value))
return ctx.stylize(''+value,'number');if(isBoolean(value))
return ctx.stylize(''+value,'boolean');if(isNull(value))
return ctx.stylize('null','null');}
function formatError(value){return'['+Error.prototype.toString.call(value)+']';}
function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true));}else{output.push('');}}
keys.forEach(function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true));}});return output;}
function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize('[Getter/Setter]','special');}else{str=ctx.stylize('[Getter]','special');}}else{if(desc.set){str=ctx.stylize('[Setter]','special');}}
if(!hasOwnProperty(visibleKeys,key)){name='['+key+']';}
if(!str){if(ctx.seen.indexOf(desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null);}else{str=formatValue(ctx,desc.value,recurseTimes-1);}
if(str.indexOf('\n')>-1){if(array){str=str.split('\n').map(function(line){return'  '+line;}).join('\n').substr(2);}else{str='\n'+str.split('\n').map(function(line){return'   '+line;}).join('\n');}}}else{str=ctx.stylize('[Circular]','special');}}
if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str;}
name=JSON.stringify(''+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,'name');}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,'string');}}
return name+': '+str;}
function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=output.reduce(function(prev,cur){numLinesEst++;if(cur.indexOf('\n')>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,'').length+1;},0);if(length>60){return braces[0]+
(base===''?'':base+'\n ')+' '+
output.join(',\n  ')+' '+
braces[1];}
return braces[0]+base+' '+output.join(', ')+' '+braces[1];}
function isArray(ar){return Array.isArray(ar);}
exports.isArray=isArray;function isBoolean(arg){return typeof arg==='boolean';}
exports.isBoolean=isBoolean;function isNull(arg){return arg===null;}
exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null;}
exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==='number';}
exports.isNumber=isNumber;function isString(arg){return typeof arg==='string';}
exports.isString=isString;function isSymbol(arg){return typeof arg==='symbol';}
exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0;}
exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==='[object RegExp]';}
exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==='object'&&arg!==null;}
exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==='[object Date]';}
exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==='[object Error]'||e instanceof Error);}
exports.isError=isError;function isFunction(arg){return typeof arg==='function';}
exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==='boolean'||typeof arg==='number'||typeof arg==='string'||typeof arg==='symbol'||typeof arg==='undefined';}
exports.isPrimitive=isPrimitive;exports.isBuffer=require('./support/isBuffer');function objectToString(o){return Object.prototype.toString.call(o);}
function pad(n){return n<10?'0'+n.toString(10):n.toString(10);}
var months=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];function timestamp(){var d=new Date();var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(':');return[d.getDate(),months[d.getMonth()],time].join(' ');}
exports.log=function(){console.log('%s - %s',timestamp(),exports.format.apply(exports,arguments));};exports.inherits=require('inherits');exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=Object.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]];}
return origin;};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop);}}).call(this,require('_process'),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":24,"_process":10,"inherits":7}],26:[function(require,module,exports){var inject=require('./inject')
var serializer=require('stream-serializer')
module.exports=inject(function(stream,opts){return serializer(opts&&opts.wrapper)(stream)})},{"./inject":27,"stream-serializer":29}],27:[function(require,module,exports){'use strict';var through=require('through'),extend=require('xtend'),duplex=require('duplex')
module.exports=function(wrap){function MuxDemux(opts,onConnection){if('function'===typeof opts)
onConnection=opts,opts=null
opts=opts||{}
function createID(){return(Math.random().toString(16).slice(2)+
Math.random().toString(16).slice(2))}
var streams={},streamCount=0
var md=duplex()
md.on('_data',function(data){if(!(Array.isArray(data)&&'string'===typeof data[0]&&'__proto__'!==data[0]&&'string'===typeof data[1]&&'__proto__'!==data[1]))return
var id=data.shift()
var event=data[0]
var s=streams[id]
if(!s){if(event=='close')
return
if(event!='new')
return outer.emit('unknown',id)
md.emit('connection',createStream(id,data[1].meta,data[1].opts))}
else if(event==='pause')
s.paused=true
else if(event==='resume'){var p=s.paused
s.paused=false
if(p)s.emit('drain')}
else if(event==='error'){var error=data[1]
if(typeof error==='string'){s.emit('error',new Error(error))}else if(typeof error.message==='string'){var e=new Error(error.message)
extend(e,error)
s.emit('error',e)}else{s.emit('error',error)}}
else{s.emit.apply(s,data)}}).on('_end',function(){destroyAll()
md._end()})
function destroyAll(_err){md.removeListener('end',destroyAll)
md.removeListener('error',destroyAll)
md.removeListener('close',destroyAll)
var err=_err||new Error('unexpected disconnection')
for(var i in streams){var s=streams[i]
s.destroyed=true
if(opts.error!==true){s.end()}else{s.emit('error',err)
s.destroy()}}}
function createStream(id,meta,opts){streamCount++
var s=through(function(data){if(!this.writable){var err=Error('stream is not writable: '+id)
err.stream=this
return outer.emit("error",err)}
md._data([s.id,'data',data])},function(){md._data([s.id,'end'])
if(this.readable&&!opts.allowHalfOpen&&!this.ended){this.emit("end")}})
s.pause=function(){md._data([s.id,'pause'])}
s.resume=function(){md._data([s.id,'resume'])}
s.error=function(message){md._data([s.id,'error',message])}
s.once('close',function(){delete streams[id]
streamCount--
md._data([s.id,'close'])
if(streamCount===0)
md.emit('zero')})
s.writable=opts.writable
s.readable=opts.readable
streams[s.id=id]=s
s.meta=meta
return s}
var outer=wrap(md,opts)
if(md!==outer){md.on('connection',function(stream){outer.emit('connection',stream)})}
outer.close=function(cb){md.once('zero',function(){md._end()
if(cb)cb()})
return this}
if(onConnection)
outer.on('connection',onConnection)
outer.on('connection',function(stream){if(outer.listeners('connection').length===1)
stream.error('remote end lacks connection listener '
+outer.listeners('connection').length)})
var pipe=outer.pipe
outer.pipe=function(dest,opts){pipe.call(outer,dest,opts)
md.on('end',destroyAll)
md.on('close',destroyAll)
md.on('error',destroyAll)
return dest}
outer.createStream=function(meta,opts){opts=opts||{}
if(!opts.writable&&!opts.readable)
opts.readable=opts.writable=true
var s=createStream(createID(),meta,opts)
var _opts={writable:opts.readable,readable:opts.writable}
md._data([s.id,'new',{meta:meta,opts:_opts}])
return s}
outer.createWriteStream=function(meta){return outer.createStream(meta,{writable:true,readable:false})}
outer.createReadStream=function(meta){return outer.createStream(meta,{writable:false,readable:true})}
return outer}
return MuxDemux}},{"duplex":28,"through":30,"xtend":31}],28:[function(require,module,exports){(function(process){var Stream=require('stream')
module.exports=function(write,end){var stream=new Stream()
var buffer=[],ended=false,destroyed=false,emitEnd
stream.writable=stream.readable=true
stream.paused=false
stream._paused=false
stream.buffer=buffer
stream.on('pause',function(){stream._paused=true}).on('drain',function(){stream._paused=false})
function destroySoon(){process.nextTick(stream.destroy.bind(stream))}
if(write)
stream.on('_data',write)
if(end)
stream.on('_end',end)
stream.once('end',function(){stream.readable=false
if(!stream.writable){process.nextTick(function(){stream.destroy()})}})
stream.once('_end',function(){stream.writable=false
if(!stream.readable)
stream.destroy()})
stream._data=function(data){if(!stream.paused&&!buffer.length)
stream.emit('data',data)
else
buffer.push(data)
return!(stream.paused||buffer.length)}
stream._end=function(data){if(data)stream._data(data)
if(emitEnd)return
emitEnd=true
stream.drain()}
stream.write=function(data){stream.emit('_data',data)
return!stream._paused}
stream.end=function(){stream.writable=false
if(stream.ended)return
stream.ended=true
stream.emit('_end')}
stream.drain=function(){if(!buffer.length&&!emitEnd)return
while(!stream.paused){if(buffer.length){stream.emit('data',buffer.shift())
if(buffer.length==0){stream.emit('_drain')}}
else if(emitEnd&&stream.readable){stream.readable=false
stream.emit('end')
return}else{return true}}}
var started=false
stream.resume=function(){started=true
stream.paused=false
stream.drain()
return stream}
stream.destroy=function(){if(destroyed)return
destroyed=ended=true
buffer.length=0
stream.emit('close')}
var pauseCalled=false
stream.pause=function(){started=true
stream.paused=true
stream.emit('_pause')
return stream}
stream._pause=function(){if(!stream._paused){stream._paused=true
stream.emit('pause')}
return this}
stream.paused=true
process.nextTick(function(){if(started)return
stream.resume()})
return stream}}).call(this,require('_process'))},{"_process":10,"stream":22}],29:[function(require,module,exports){var EventEmitter=require('events').EventEmitter
exports=module.exports=function(wrapper){if('function'==typeof wrapper)
return wrapper
return exports[wrapper]||exports.json}
exports.json=function(stream,_JSON){_JSON=_JSON||JSON
var write=stream.write
var soFar=''
function parse(line){var js
try{js=_JSON.parse(line)}catch(err){err.line=line
return stream.emit('error',err)}
if(js!==undefined)
write.call(stream,js)}
function onData(data){var lines=(soFar+data).split('\n')
soFar=lines.pop()
while(lines.length){parse(lines.shift())}}
stream.write=onData
var end=stream.end
stream.end=function(data){if(data)
stream.write(data)
if(soFar){parse(soFar)}
return end.call(stream)}
stream.emit=function(event,data){if(event=='data'){data=_JSON.stringify(data)+'\n'}
EventEmitter.prototype.emit.call(stream,event,data)}
return stream}
exports.raw=function(stream){return stream}},{"events":6}],30:[function(require,module,exports){(function(process){var Stream=require('stream')
exports=module.exports=through
through.through=through
function through(write,end,opts){write=write||function(data){this.queue(data)}
end=end||function(){this.queue(null)}
var ended=false,destroyed=false,buffer=[],_ended=false
var stream=new Stream()
stream.readable=stream.writable=true
stream.paused=false
stream.autoDestroy=!(opts&&opts.autoDestroy===false)
stream.write=function(data){write.call(this,data)
return!stream.paused}
function drain(){while(buffer.length&&!stream.paused){var data=buffer.shift()
if(null===data)
return stream.emit('end')
else
stream.emit('data',data)}}
stream.queue=stream.push=function(data){if(_ended)return stream
if(data===null)_ended=true
buffer.push(data)
drain()
return stream}
stream.on('end',function(){stream.readable=false
if(!stream.writable&&stream.autoDestroy)
process.nextTick(function(){stream.destroy()})})
function _end(){stream.writable=false
end.call(stream)
if(!stream.readable&&stream.autoDestroy)
stream.destroy()}
stream.end=function(data){if(ended)return
ended=true
if(arguments.length)stream.write(data)
_end()
return stream}
stream.destroy=function(){if(destroyed)return
destroyed=true
ended=true
buffer.length=0
stream.writable=stream.readable=false
stream.emit('close')
return stream}
stream.pause=function(){if(stream.paused)return
stream.paused=true
return stream}
stream.resume=function(){if(stream.paused){stream.paused=false
stream.emit('resume')}
drain()
if(!stream.paused)
stream.emit('drain')
return stream}
return stream}}).call(this,require('_process'))},{"_process":10,"stream":22}],31:[function(require,module,exports){module.exports=extend
function extend(target){for(var i=1;i<arguments.length;i++){var source=arguments[i],keys=Object.keys(source)
for(var j=0;j<keys.length;j++){var name=keys[j]
target[name]=source[name]}}
return target}},{}],32:[function(require,module,exports){(function(process,Buffer){var stream=require('readable-stream')
var eos=require('end-of-stream')
var util=require('util')
var SIGNAL_FLUSH=new Buffer([0])
var onuncork=function(self,fn){if(self._corked)self.once('uncork',fn)
else fn()}
var destroyer=function(self,end){return function(err){if(err)self.destroy(err.message==='premature close'?null:err)
else if(end&&!self._ended)self.end()}}
var end=function(ws,fn){if(!ws)return fn()
if(ws._writableState&&ws._writableState.finished)return fn()
if(ws._writableState)return ws.end(fn)
ws.end()
fn()}
var toStreams2=function(rs){return new(stream.Readable)({objectMode:true,highWaterMark:16}).wrap(rs)}
var Duplexify=function(writable,readable,opts){if(!(this instanceof Duplexify))return new Duplexify(writable,readable,opts)
stream.Duplex.call(this,opts)
this._writable=null
this._readable=null
this._readable2=null
this._forwardDestroy=!opts||opts.destroy!==false
this._forwardEnd=!opts||opts.end!==false
this._corked=1
this._ondrain=null
this._drained=false
this._forwarding=false
this._unwrite=null
this._unread=null
this._ended=false
this.destroyed=false
if(writable)this.setWritable(writable)
if(readable)this.setReadable(readable)}
util.inherits(Duplexify,stream.Duplex)
Duplexify.obj=function(writable,readable,opts){if(!opts)opts={}
opts.objectMode=true
opts.highWaterMark=16
return new Duplexify(writable,readable,opts)}
Duplexify.prototype.cork=function(){if(++this._corked===1)this.emit('cork')}
Duplexify.prototype.uncork=function(){if(this._corked&&--this._corked===0)this.emit('uncork')}
Duplexify.prototype.setWritable=function(writable){if(this._unwrite)this._unwrite()
if(this.destroyed){if(writable&&writable.destroy)writable.destroy()
return}
if(writable===null||writable===false){this.end()
return}
var self=this
var unend=eos(writable,{writable:true,readable:false},destroyer(this,this._forwardEnd))
var ondrain=function(){var ondrain=self._ondrain
self._ondrain=null
if(ondrain)ondrain()}
var clear=function(){self._writable.removeListener('drain',ondrain)
unend()}
if(this._unwrite)process.nextTick(ondrain)
this._writable=writable
this._writable.on('drain',ondrain)
this._unwrite=clear
this.uncork()}
Duplexify.prototype.setReadable=function(readable){if(this._unread)this._unread()
if(this.destroyed){if(readable&&readable.destroy)readable.destroy()
return}
if(readable===null||readable===false){this.push(null)
this.resume()
return}
var self=this
var unend=eos(readable,{writable:false,readable:true},destroyer(this))
var onreadable=function(){self._forward()}
var onend=function(){self.push(null)}
var clear=function(){self._readable2.removeListener('readable',onreadable)
self._readable2.removeListener('end',onend)
unend()}
this._drained=true
this._readable=readable
this._readable2=readable._readableState?readable:toStreams2(readable)
this._readable2.on('readable',onreadable)
this._readable2.on('end',onend)
this._unread=clear
this._forward()}
Duplexify.prototype._read=function(){this._drained=true
this._forward()}
Duplexify.prototype._forward=function(){if(this._forwarding||!this._readable2||!this._drained)return
this._forwarding=true
var data
var state=this._readable2._readableState
while((data=this._readable2.read(state.buffer.length?state.buffer[0].length:state.length))!==null){this._drained=this.push(data)}
this._forwarding=false}
Duplexify.prototype.destroy=function(err){if(this.destroyed)return
this.destroyed=true
var self=this
process.nextTick(function(){self._destroy(err)})}
Duplexify.prototype._destroy=function(err){if(err){var ondrain=this._ondrain
this._ondrain=null
if(ondrain)ondrain(err)
else this.emit('error',err)}
if(this._forwardDestroy){if(this._readable&&this._readable.destroy)this._readable.destroy()
if(this._writable&&this._writable.destroy)this._writable.destroy()}
this.emit('close')}
Duplexify.prototype._write=function(data,enc,cb){if(this.destroyed)return cb()
if(this._corked)return onuncork(this,this._write.bind(this,data,enc,cb))
if(data===SIGNAL_FLUSH)return this._finish(cb)
if(!this._writable)return cb()
if(this._writable.write(data)===false)this._ondrain=cb
else cb()}
Duplexify.prototype._finish=function(cb){var self=this
this.emit('preend')
onuncork(this,function(){end(self._forwardEnd&&self._writable,function(){if(self._writableState.prefinished===false)self._writableState.prefinished=true
self.emit('prefinish')
onuncork(self,cb)})})}
Duplexify.prototype.end=function(data,enc,cb){if(typeof data==='function')return this.end(null,null,data)
if(typeof enc==='function')return this.end(data,null,enc)
this._ended=true
if(data)this.write(data)
if(!this._writableState.ending)this.write(SIGNAL_FLUSH)
return stream.Writable.prototype.end.call(this,cb)}
module.exports=Duplexify}).call(this,require('_process'),require("buffer").Buffer)},{"_process":10,"buffer":2,"end-of-stream":33,"readable-stream":46,"util":25}],33:[function(require,module,exports){var once=require('once');var noop=function(){};var isRequest=function(stream){return stream.setHeader&&typeof stream.abort==='function';};var eos=function(stream,opts,callback){if(typeof opts==='function')return eos(stream,null,opts);if(!opts)opts={};callback=once(callback||noop);var ws=stream._writableState;var rs=stream._readableState;var readable=opts.readable||(opts.readable!==false&&stream.readable);var writable=opts.writable||(opts.writable!==false&&stream.writable);var onlegacyfinish=function(){if(!stream.writable)onfinish();};var onfinish=function(){writable=false;if(!readable)callback();};var onend=function(){readable=false;if(!writable)callback();};var onclose=function(){if(readable&&!(rs&&rs.ended))return callback(new Error('premature close'));if(writable&&!(ws&&ws.ended))return callback(new Error('premature close'));};var onrequest=function(){stream.req.on('finish',onfinish);};if(isRequest(stream)){stream.on('complete',onfinish);stream.on('abort',onclose);if(stream.req)onrequest();else stream.on('request',onrequest);}else if(writable&&!ws){stream.on('end',onlegacyfinish);stream.on('close',onlegacyfinish);}
stream.on('end',onend);stream.on('finish',onfinish);if(opts.error!==false)stream.on('error',callback);stream.on('close',onclose);return function(){stream.removeListener('complete',onfinish);stream.removeListener('abort',onclose);stream.removeListener('request',onrequest);if(stream.req)stream.req.removeListener('finish',onfinish);stream.removeListener('end',onlegacyfinish);stream.removeListener('close',onlegacyfinish);stream.removeListener('finish',onfinish);stream.removeListener('end',onend);stream.removeListener('error',callback);stream.removeListener('close',onclose);};};module.exports=eos;},{"once":35}],34:[function(require,module,exports){module.exports=wrappy
function wrappy(fn,cb){if(fn&&cb)return wrappy(fn)(cb)
if(typeof fn!=='function')
throw new TypeError('need wrapper function')
Object.keys(fn).forEach(function(k){wrapper[k]=fn[k]})
return wrapper
function wrapper(){var args=new Array(arguments.length)
for(var i=0;i<args.length;i++){args[i]=arguments[i]}
var ret=fn.apply(this,args)
var cb=args[args.length-1]
if(typeof ret==='function'&&ret!==cb){Object.keys(cb).forEach(function(k){ret[k]=cb[k]})}
return ret}}},{}],35:[function(require,module,exports){var wrappy=require('wrappy')
module.exports=wrappy(once)
once.proto=once(function(){Object.defineProperty(Function.prototype,'once',{value:function(){return once(this)},configurable:true})})
function once(fn){var f=function(){if(f.called)return f.value
f.called=true
return f.value=fn.apply(this,arguments)}
f.called=false
return f}},{"wrappy":34}],36:[function(require,module,exports){'use strict';var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys;}
module.exports=Duplex;var processNextTick=require('process-nextick-args');var util=require('core-util-is');util.inherits=require('inherits');var Readable=require('./_stream_readable');var Writable=require('./_stream_writable');util.inherits(Duplex,Readable);var keys=objectKeys(Writable.prototype);for(var v=0;v<keys.length;v++){var method=keys[v];if(!Duplex.prototype[method])
Duplex.prototype[method]=Writable.prototype[method];}
function Duplex(options){if(!(this instanceof Duplex))
return new Duplex(options);Readable.call(this,options);Writable.call(this,options);if(options&&options.readable===false)
this.readable=false;if(options&&options.writable===false)
this.writable=false;this.allowHalfOpen=true;if(options&&options.allowHalfOpen===false)
this.allowHalfOpen=false;this.once('end',onend);}
function onend(){if(this.allowHalfOpen||this._writableState.ended)
return;processNextTick(onEndNT,this);}
function onEndNT(self){self.end();}
function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i);}}},{"./_stream_readable":38,"./_stream_writable":40,"core-util-is":41,"inherits":47,"process-nextick-args":43}],37:[function(require,module,exports){'use strict';module.exports=PassThrough;var Transform=require('./_stream_transform');var util=require('core-util-is');util.inherits=require('inherits');util.inherits(PassThrough,Transform);function PassThrough(options){if(!(this instanceof PassThrough))
return new PassThrough(options);Transform.call(this,options);}
PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk);};},{"./_stream_transform":39,"core-util-is":41,"inherits":47}],38:[function(require,module,exports){(function(process){'use strict';module.exports=Readable;var processNextTick=require('process-nextick-args');var isArray=require('isarray');var Buffer=require('buffer').Buffer;Readable.ReadableState=ReadableState;var EE=require('events');var EElistenerCount=function(emitter,type){return emitter.listeners(type).length;};var Stream;(function(){try{Stream=require('st'+'ream');}catch(_){}finally{if(!Stream)
Stream=require('events').EventEmitter;}}())
var Buffer=require('buffer').Buffer;var util=require('core-util-is');util.inherits=require('inherits');var debugUtil=require('util');var debug;if(debugUtil&&debugUtil.debuglog){debug=debugUtil.debuglog('stream');}else{debug=function(){};}
var StringDecoder;util.inherits(Readable,Stream);function ReadableState(options,stream){var Duplex=require('./_stream_duplex');options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)
this.objectMode=this.objectMode||!!options.readableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=(hwm||hwm===0)?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.buffer=[];this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.defaultEncoding=options.defaultEncoding||'utf8';this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)
StringDecoder=require('string_decoder/').StringDecoder;this.decoder=new StringDecoder(options.encoding);this.encoding=options.encoding;}}
function Readable(options){var Duplex=require('./_stream_duplex');if(!(this instanceof Readable))
return new Readable(options);this._readableState=new ReadableState(options,this);this.readable=true;if(options&&typeof options.read==='function')
this._read=options.read;Stream.call(this);}
Readable.prototype.push=function(chunk,encoding){var state=this._readableState;if(!state.objectMode&&typeof chunk==='string'){encoding=encoding||state.defaultEncoding;if(encoding!==state.encoding){chunk=new Buffer(chunk,encoding);encoding='';}}
return readableAddChunk(this,state,chunk,encoding,false);};Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,'',true);};Readable.prototype.isPaused=function(){return this._readableState.flowing===false;};function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er){stream.emit('error',er);}else if(chunk===null){state.reading=false;onEofChunk(stream,state);}else if(state.objectMode||chunk&&chunk.length>0){if(state.ended&&!addToFront){var e=new Error('stream.push() after EOF');stream.emit('error',e);}else if(state.endEmitted&&addToFront){var e=new Error('stream.unshift() after end event');stream.emit('error',e);}else{if(state.decoder&&!addToFront&&!encoding)
chunk=state.decoder.write(chunk);if(!addToFront)
state.reading=false;if(state.flowing&&state.length===0&&!state.sync){stream.emit('data',chunk);stream.read(0);}else{state.length+=state.objectMode?1:chunk.length;if(addToFront)
state.buffer.unshift(chunk);else
state.buffer.push(chunk);if(state.needReadable)
emitReadable(stream);}
maybeReadMore(stream,state);}}else if(!addToFront){state.reading=false;}
return needMoreData(state);}
function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||state.length===0);}
Readable.prototype.setEncoding=function(enc){if(!StringDecoder)
StringDecoder=require('string_decoder/').StringDecoder;this._readableState.decoder=new StringDecoder(enc);this._readableState.encoding=enc;return this;};var MAX_HWM=0x800000;function computeNewHighWaterMark(n){if(n>=MAX_HWM){n=MAX_HWM;}else{n--;n|=n>>>1;n|=n>>>2;n|=n>>>4;n|=n>>>8;n|=n>>>16;n++;}
return n;}
function howMuchToRead(n,state){if(state.length===0&&state.ended)
return 0;if(state.objectMode)
return n===0?0:1;if(n===null||isNaN(n)){if(state.flowing&&state.buffer.length)
return state.buffer[0].length;else
return state.length;}
if(n<=0)
return 0;if(n>state.highWaterMark)
state.highWaterMark=computeNewHighWaterMark(n);if(n>state.length){if(!state.ended){state.needReadable=true;return 0;}else{return state.length;}}
return n;}
Readable.prototype.read=function(n){debug('read',n);var state=this._readableState;var nOrig=n;if(typeof n!=='number'||n>0)
state.emittedReadable=false;if(n===0&&state.needReadable&&(state.length>=state.highWaterMark||state.ended)){debug('read: emitReadable',state.length,state.ended);if(state.length===0&&state.ended)
endReadable(this);else
emitReadable(this);return null;}
n=howMuchToRead(n,state);if(n===0&&state.ended){if(state.length===0)
endReadable(this);return null;}
var doRead=state.needReadable;debug('need readable',doRead);if(state.length===0||state.length-n<state.highWaterMark){doRead=true;debug('length less than watermark',doRead);}
if(state.ended||state.reading){doRead=false;debug('reading or ended',doRead);}
if(doRead){debug('do read');state.reading=true;state.sync=true;if(state.length===0)
state.needReadable=true;this._read(state.highWaterMark);state.sync=false;}
if(doRead&&!state.reading)
n=howMuchToRead(nOrig,state);var ret;if(n>0)
ret=fromList(n,state);else
ret=null;if(ret===null){state.needReadable=true;n=0;}
state.length-=n;if(state.length===0&&!state.ended)
state.needReadable=true;if(nOrig!==n&&state.ended&&state.length===0)
endReadable(this);if(ret!==null)
this.emit('data',ret);return ret;};function chunkInvalid(state,chunk){var er=null;if(!(Buffer.isBuffer(chunk))&&typeof chunk!=='string'&&chunk!==null&&chunk!==undefined&&!state.objectMode){er=new TypeError('Invalid non-string/buffer chunk');}
return er;}
function onEofChunk(stream,state){if(state.ended)return;if(state.decoder){var chunk=state.decoder.end();if(chunk&&chunk.length){state.buffer.push(chunk);state.length+=state.objectMode?1:chunk.length;}}
state.ended=true;emitReadable(stream);}
function emitReadable(stream){var state=stream._readableState;state.needReadable=false;if(!state.emittedReadable){debug('emitReadable',state.flowing);state.emittedReadable=true;if(state.sync)
processNextTick(emitReadable_,stream);else
emitReadable_(stream);}}
function emitReadable_(stream){debug('emit readable');stream.emit('readable');flow(stream);}
function maybeReadMore(stream,state){if(!state.readingMore){state.readingMore=true;processNextTick(maybeReadMore_,stream,state);}}
function maybeReadMore_(stream,state){var len=state.length;while(!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark){debug('maybeReadMore read 0');stream.read(0);if(len===state.length)
break;else
len=state.length;}
state.readingMore=false;}
Readable.prototype._read=function(n){this.emit('error',new Error('not implemented'));};Readable.prototype.pipe=function(dest,pipeOpts){var src=this;var state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest);break;}
state.pipesCount+=1;debug('pipe count=%d opts=%j',state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:cleanup;if(state.endEmitted)
processNextTick(endFn);else
src.once('end',endFn);dest.on('unpipe',onunpipe);function onunpipe(readable){debug('onunpipe');if(readable===src){cleanup();}}
function onend(){debug('onend');dest.end();}
var ondrain=pipeOnDrain(src);dest.on('drain',ondrain);var cleanedUp=false;function cleanup(){debug('cleanup');dest.removeListener('close',onclose);dest.removeListener('finish',onfinish);dest.removeListener('drain',ondrain);dest.removeListener('error',onerror);dest.removeListener('unpipe',onunpipe);src.removeListener('end',onend);src.removeListener('end',cleanup);src.removeListener('data',ondata);cleanedUp=true;if(state.awaitDrain&&(!dest._writableState||dest._writableState.needDrain))
ondrain();}
src.on('data',ondata);function ondata(chunk){debug('ondata');var ret=dest.write(chunk);if(false===ret){if(state.pipesCount===1&&state.pipes[0]===dest&&src.listenerCount('data')===1&&!cleanedUp){debug('false write response, pause',src._readableState.awaitDrain);src._readableState.awaitDrain++;}
src.pause();}}
function onerror(er){debug('onerror',er);unpipe();dest.removeListener('error',onerror);if(EElistenerCount(dest,'error')===0)
dest.emit('error',er);}
if(!dest._events||!dest._events.error)
dest.on('error',onerror);else if(isArray(dest._events.error))
dest._events.error.unshift(onerror);else
dest._events.error=[onerror,dest._events.error];function onclose(){dest.removeListener('finish',onfinish);unpipe();}
dest.once('close',onclose);function onfinish(){debug('onfinish');dest.removeListener('close',onclose);unpipe();}
dest.once('finish',onfinish);function unpipe(){debug('unpipe');src.unpipe(dest);}
dest.emit('pipe',src);if(!state.flowing){debug('pipe resume');src.resume();}
return dest;};function pipeOnDrain(src){return function(){var state=src._readableState;debug('pipeOnDrain',state.awaitDrain);if(state.awaitDrain)
state.awaitDrain--;if(state.awaitDrain===0&&EElistenerCount(src,'data')){state.flowing=true;flow(src);}};}
Readable.prototype.unpipe=function(dest){var state=this._readableState;if(state.pipesCount===0)
return this;if(state.pipesCount===1){if(dest&&dest!==state.pipes)
return this;if(!dest)
dest=state.pipes;state.pipes=null;state.pipesCount=0;state.flowing=false;if(dest)
dest.emit('unpipe',this);return this;}
if(!dest){var dests=state.pipes;var len=state.pipesCount;state.pipes=null;state.pipesCount=0;state.flowing=false;for(var i=0;i<len;i++)
dests[i].emit('unpipe',this);return this;}
var i=indexOf(state.pipes,dest);if(i===-1)
return this;state.pipes.splice(i,1);state.pipesCount-=1;if(state.pipesCount===1)
state.pipes=state.pipes[0];dest.emit('unpipe',this);return this;};Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if(ev==='data'&&false!==this._readableState.flowing){this.resume();}
if(ev==='readable'&&this.readable){var state=this._readableState;if(!state.readableListening){state.readableListening=true;state.emittedReadable=false;state.needReadable=true;if(!state.reading){processNextTick(nReadingNextTick,this);}else if(state.length){emitReadable(this,state);}}}
return res;};Readable.prototype.addListener=Readable.prototype.on;function nReadingNextTick(self){debug('readable nexttick read 0');self.read(0);}
Readable.prototype.resume=function(){var state=this._readableState;if(!state.flowing){debug('resume');state.flowing=true;resume(this,state);}
return this;};function resume(stream,state){if(!state.resumeScheduled){state.resumeScheduled=true;processNextTick(resume_,stream,state);}}
function resume_(stream,state){if(!state.reading){debug('resume read 0');stream.read(0);}
state.resumeScheduled=false;stream.emit('resume');flow(stream);if(state.flowing&&!state.reading)
stream.read(0);}
Readable.prototype.pause=function(){debug('call pause flowing=%j',this._readableState.flowing);if(false!==this._readableState.flowing){debug('pause');this._readableState.flowing=false;this.emit('pause');}
return this;};function flow(stream){var state=stream._readableState;debug('flow',state.flowing);if(state.flowing){do{var chunk=stream.read();}while(null!==chunk&&state.flowing);}}
Readable.prototype.wrap=function(stream){var state=this._readableState;var paused=false;var self=this;stream.on('end',function(){debug('wrapped end');if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length)
self.push(chunk);}
self.push(null);});stream.on('data',function(chunk){debug('wrapped data');if(state.decoder)
chunk=state.decoder.write(chunk);if(state.objectMode&&(chunk===null||chunk===undefined))
return;else if(!state.objectMode&&(!chunk||!chunk.length))
return;var ret=self.push(chunk);if(!ret){paused=true;stream.pause();}});for(var i in stream){if(this[i]===undefined&&typeof stream[i]==='function'){this[i]=function(method){return function(){return stream[method].apply(stream,arguments);};}(i);}}
var events=['error','close','destroy','pause','resume'];forEach(events,function(ev){stream.on(ev,self.emit.bind(self,ev));});self._read=function(n){debug('wrapped _read',n);if(paused){paused=false;stream.resume();}};return self;};Readable._fromList=fromList;function fromList(n,state){var list=state.buffer;var length=state.length;var stringMode=!!state.decoder;var objectMode=!!state.objectMode;var ret;if(list.length===0)
return null;if(length===0)
ret=null;else if(objectMode)
ret=list.shift();else if(!n||n>=length){if(stringMode)
ret=list.join('');else if(list.length===1)
ret=list[0];else
ret=Buffer.concat(list,length);list.length=0;}else{if(n<list[0].length){var buf=list[0];ret=buf.slice(0,n);list[0]=buf.slice(n);}else if(n===list[0].length){ret=list.shift();}else{if(stringMode)
ret='';else
ret=new Buffer(n);var c=0;for(var i=0,l=list.length;i<l&&c<n;i++){var buf=list[0];var cpy=Math.min(n-c,buf.length);if(stringMode)
ret+=buf.slice(0,cpy);else
buf.copy(ret,c,0,cpy);if(cpy<buf.length)
list[0]=buf.slice(cpy);else
list.shift();c+=cpy;}}}
return ret;}
function endReadable(stream){var state=stream._readableState;if(state.length>0)
throw new Error('endReadable called on non-empty stream');if(!state.endEmitted){state.ended=true;processNextTick(endReadableNT,state,stream);}}
function endReadableNT(state,stream){if(!state.endEmitted&&state.length===0){state.endEmitted=true;stream.readable=false;stream.emit('end');}}
function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i);}}
function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x)return i;}
return-1;}}).call(this,require('_process'))},{"./_stream_duplex":36,"_process":10,"buffer":2,"core-util-is":41,"events":6,"inherits":47,"isarray":42,"process-nextick-args":43,"string_decoder/":44,"util":1}],39:[function(require,module,exports){'use strict';module.exports=Transform;var Duplex=require('./_stream_duplex');var util=require('core-util-is');util.inherits=require('inherits');util.inherits(Transform,Duplex);function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data);};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null;}
function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=false;var cb=ts.writecb;if(!cb)
return stream.emit('error',new Error('no writecb in Transform class'));ts.writechunk=null;ts.writecb=null;if(data!==null&&data!==undefined)
stream.push(data);if(cb)
cb(er);var rs=stream._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark){stream._read(rs.highWaterMark);}}
function Transform(options){if(!(this instanceof Transform))
return new Transform(options);Duplex.call(this,options);this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=true;this._readableState.sync=false;if(options){if(typeof options.transform==='function')
this._transform=options.transform;if(typeof options.flush==='function')
this._flush=options.flush;}
this.once('prefinish',function(){if(typeof this._flush==='function')
this._flush(function(er){done(stream,er);});else
done(stream);});}
Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding);};Transform.prototype._transform=function(chunk,encoding,cb){throw new Error('not implemented');};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)
this._read(rs.highWaterMark);}};Transform.prototype._read=function(n){var ts=this._transformState;if(ts.writechunk!==null&&ts.writecb&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform);}else{ts.needTransform=true;}};function done(stream,er){if(er)
return stream.emit('error',er);var ws=stream._writableState;var ts=stream._transformState;if(ws.length)
throw new Error('calling transform done when ws.length != 0');if(ts.transforming)
throw new Error('calling transform done when still transforming');return stream.push(null);}},{"./_stream_duplex":36,"core-util-is":41,"inherits":47}],40:[function(require,module,exports){'use strict';module.exports=Writable;var processNextTick=require('process-nextick-args');var Buffer=require('buffer').Buffer;Writable.WritableState=WritableState;var util=require('core-util-is');util.inherits=require('inherits');var internalUtil={deprecate:require('util-deprecate')};var Stream;(function(){try{Stream=require('st'+'ream');}catch(_){}finally{if(!Stream)
Stream=require('events').EventEmitter;}}())
var Buffer=require('buffer').Buffer;util.inherits(Writable,Stream);function nop(){}
function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb;this.next=null;}
function WritableState(options,stream){var Duplex=require('./_stream_duplex');options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)
this.objectMode=this.objectMode||!!options.writableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=(hwm||hwm===0)?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||'utf8';this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er);};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;}
WritableState.prototype.getBuffer=function writableStateGetBuffer(){var current=this.bufferedRequest;var out=[];while(current){out.push(current);current=current.next;}
return out;};(function(){try{Object.defineProperty(WritableState.prototype,'buffer',{get:internalUtil.deprecate(function(){return this.getBuffer();},'_writableState.buffer is deprecated. Use _writableState.getBuffer '+'instead.')});}catch(_){}}());function Writable(options){var Duplex=require('./_stream_duplex');if(!(this instanceof Writable)&&!(this instanceof Duplex))
return new Writable(options);this._writableState=new WritableState(options,this);this.writable=true;if(options){if(typeof options.write==='function')
this._write=options.write;if(typeof options.writev==='function')
this._writev=options.writev;}
Stream.call(this);}
Writable.prototype.pipe=function(){this.emit('error',new Error('Cannot pipe. Not readable.'));};function writeAfterEnd(stream,cb){var er=new Error('write after end');stream.emit('error',er);processNextTick(cb,er);}
function validChunk(stream,state,chunk,cb){var valid=true;if(!(Buffer.isBuffer(chunk))&&typeof chunk!=='string'&&chunk!==null&&chunk!==undefined&&!state.objectMode){var er=new TypeError('Invalid non-string/buffer chunk');stream.emit('error',er);processNextTick(cb,er);valid=false;}
return valid;}
Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState;var ret=false;if(typeof encoding==='function'){cb=encoding;encoding=null;}
if(Buffer.isBuffer(chunk))
encoding='buffer';else if(!encoding)
encoding=state.defaultEncoding;if(typeof cb!=='function')
cb=nop;if(state.ended)
writeAfterEnd(this,cb);else if(validChunk(this,state,chunk,cb)){state.pendingcb++;ret=writeOrBuffer(this,state,chunk,encoding,cb);}
return ret;};Writable.prototype.cork=function(){var state=this._writableState;state.corked++;};Writable.prototype.uncork=function(){var state=this._writableState;if(state.corked){state.corked--;if(!state.writing&&!state.corked&&!state.finished&&!state.bufferProcessing&&state.bufferedRequest)
clearBuffer(this,state);}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(encoding){if(typeof encoding==='string')
encoding=encoding.toLowerCase();if(!(['hex','utf8','utf-8','ascii','binary','base64','ucs2','ucs-2','utf16le','utf-16le','raw'].indexOf((encoding+'').toLowerCase())>-1))
throw new TypeError('Unknown encoding: '+encoding);this._writableState.defaultEncoding=encoding;};function decodeChunk(state,chunk,encoding){if(!state.objectMode&&state.decodeStrings!==false&&typeof chunk==='string'){chunk=new Buffer(chunk,encoding);}
return chunk;}
function writeOrBuffer(stream,state,chunk,encoding,cb){chunk=decodeChunk(state,chunk,encoding);if(Buffer.isBuffer(chunk))
encoding='buffer';var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(!ret)
state.needDrain=true;if(state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest=new WriteReq(chunk,encoding,cb);if(last){last.next=state.lastBufferedRequest;}else{state.bufferedRequest=state.lastBufferedRequest;}}else{doWrite(stream,state,false,len,chunk,encoding,cb);}
return ret;}
function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len;state.writecb=cb;state.writing=true;state.sync=true;if(writev)
stream._writev(chunk,state.onwrite);else
stream._write(chunk,encoding,state.onwrite);state.sync=false;}
function onwriteError(stream,state,sync,er,cb){--state.pendingcb;if(sync)
processNextTick(cb,er);else
cb(er);stream._writableState.errorEmitted=true;stream.emit('error',er);}
function onwriteStateUpdate(state){state.writing=false;state.writecb=null;state.length-=state.writelen;state.writelen=0;}
function onwrite(stream,er){var state=stream._writableState;var sync=state.sync;var cb=state.writecb;onwriteStateUpdate(state);if(er)
onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state);if(!finished&&!state.corked&&!state.bufferProcessing&&state.bufferedRequest){clearBuffer(stream,state);}
if(sync){processNextTick(afterWrite,stream,state,finished,cb);}else{afterWrite(stream,state,finished,cb);}}}
function afterWrite(stream,state,finished,cb){if(!finished)
onwriteDrain(stream,state);state.pendingcb--;cb();finishMaybe(stream,state);}
function onwriteDrain(stream,state){if(state.length===0&&state.needDrain){state.needDrain=false;stream.emit('drain');}}
function clearBuffer(stream,state){state.bufferProcessing=true;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var buffer=[];var cbs=[];while(entry){cbs.push(entry.callback);buffer.push(entry);entry=entry.next;}
state.pendingcb++;state.lastBufferedRequest=null;doWrite(stream,state,true,state.length,buffer,'',function(err){for(var i=0;i<cbs.length;i++){state.pendingcb--;cbs[i](err);}});}else{while(entry){var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state.objectMode?1:chunk.length;doWrite(stream,state,false,len,chunk,encoding,cb);entry=entry.next;if(state.writing){break;}}
if(entry===null)
state.lastBufferedRequest=null;}
state.bufferedRequest=entry;state.bufferProcessing=false;}
Writable.prototype._write=function(chunk,encoding,cb){cb(new Error('not implemented'));};Writable.prototype._writev=null;Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;if(typeof chunk==='function'){cb=chunk;chunk=null;encoding=null;}else if(typeof encoding==='function'){cb=encoding;encoding=null;}
if(chunk!==null&&chunk!==undefined)
this.write(chunk,encoding);if(state.corked){state.corked=1;this.uncork();}
if(!state.ending&&!state.finished)
endWritable(this,state,cb);};function needFinish(state){return(state.ending&&state.length===0&&state.bufferedRequest===null&&!state.finished&&!state.writing);}
function prefinish(stream,state){if(!state.prefinished){state.prefinished=true;stream.emit('prefinish');}}
function finishMaybe(stream,state){var need=needFinish(state);if(need){if(state.pendingcb===0){prefinish(stream,state);state.finished=true;stream.emit('finish');}else{prefinish(stream,state);}}
return need;}
function endWritable(stream,state,cb){state.ending=true;finishMaybe(stream,state);if(cb){if(state.finished)
processNextTick(cb);else
stream.once('finish',cb);}
state.ended=true;}},{"./_stream_duplex":36,"buffer":2,"core-util-is":41,"events":6,"inherits":47,"process-nextick-args":43,"util-deprecate":45}],41:[function(require,module,exports){(function(Buffer){function isArray(ar){return Array.isArray(ar);}
exports.isArray=isArray;function isBoolean(arg){return typeof arg==='boolean';}
exports.isBoolean=isBoolean;function isNull(arg){return arg===null;}
exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null;}
exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==='number';}
exports.isNumber=isNumber;function isString(arg){return typeof arg==='string';}
exports.isString=isString;function isSymbol(arg){return typeof arg==='symbol';}
exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0;}
exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==='[object RegExp]';}
exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==='object'&&arg!==null;}
exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==='[object Date]';}
exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==='[object Error]'||e instanceof Error);}
exports.isError=isError;function isFunction(arg){return typeof arg==='function';}
exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==='boolean'||typeof arg==='number'||typeof arg==='string'||typeof arg==='symbol'||typeof arg==='undefined';}
exports.isPrimitive=isPrimitive;function isBuffer(arg){return Buffer.isBuffer(arg);}
exports.isBuffer=isBuffer;function objectToString(o){return Object.prototype.toString.call(o);}}).call(this,{"isBuffer":require("../../../../../../../../../../../../../node_modules/browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js")})},{"../../../../../../../../../../../../../node_modules/browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js":8}],42:[function(require,module,exports){arguments[4][9][0].apply(exports,arguments)},{"dup":9}],43:[function(require,module,exports){(function(process){'use strict';module.exports=nextTick;function nextTick(fn){var args=new Array(arguments.length-1);var i=0;while(i<args.length){args[i++]=arguments[i];}
process.nextTick(function afterTick(){fn.apply(null,args);});}}).call(this,require('_process'))},{"_process":10}],44:[function(require,module,exports){arguments[4][23][0].apply(exports,arguments)},{"buffer":2,"dup":23}],45:[function(require,module,exports){(function(global){module.exports=deprecate;function deprecate(fn,msg){if(config('noDeprecation')){return fn;}
var warned=false;function deprecated(){if(!warned){if(config('throwDeprecation')){throw new Error(msg);}else if(config('traceDeprecation')){console.trace(msg);}else{console.warn(msg);}
warned=true;}
return fn.apply(this,arguments);}
return deprecated;}
function config(name){try{if(!global.localStorage)return false;}catch(_){return false;}
var val=global.localStorage[name];if(null==val)return false;return String(val).toLowerCase()==='true';}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],46:[function(require,module,exports){var Stream=(function(){try{return require('st'+'ream');}catch(_){}}());exports=module.exports=require('./lib/_stream_readable.js');exports.Stream=Stream||exports;exports.Readable=exports;exports.Writable=require('./lib/_stream_writable.js');exports.Duplex=require('./lib/_stream_duplex.js');exports.Transform=require('./lib/_stream_transform.js');exports.PassThrough=require('./lib/_stream_passthrough.js');},{"./lib/_stream_duplex.js":36,"./lib/_stream_passthrough.js":37,"./lib/_stream_readable.js":38,"./lib/_stream_transform.js":39,"./lib/_stream_writable.js":40}],47:[function(require,module,exports){arguments[4][7][0].apply(exports,arguments)},{"dup":7}],48:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments)},{"./_stream_readable":49,"./_stream_writable":51,"_process":10,"core-util-is":52,"dup":12,"inherits":47}],49:[function(require,module,exports){(function(process){module.exports=Readable;var isArray=require('isarray');var Buffer=require('buffer').Buffer;Readable.ReadableState=ReadableState;var EE=require('events').EventEmitter;if(!EE.listenerCount)EE.listenerCount=function(emitter,type){return emitter.listeners(type).length;};var Stream=require('stream');var util=require('core-util-is');util.inherits=require('inherits');var StringDecoder;util.inherits(Readable,Stream);function ReadableState(options,stream){options=options||{};var hwm=options.highWaterMark;this.highWaterMark=(hwm||hwm===0)?hwm:16*1024;this.highWaterMark=~~this.highWaterMark;this.buffer=[];this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=false;this.ended=false;this.endEmitted=false;this.reading=false;this.calledRead=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.objectMode=!!options.objectMode;this.defaultEncoding=options.defaultEncoding||'utf8';this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)
StringDecoder=require('string_decoder/').StringDecoder;this.decoder=new StringDecoder(options.encoding);this.encoding=options.encoding;}}
function Readable(options){if(!(this instanceof Readable))
return new Readable(options);this._readableState=new ReadableState(options,this);this.readable=true;Stream.call(this);}
Readable.prototype.push=function(chunk,encoding){var state=this._readableState;if(typeof chunk==='string'&&!state.objectMode){encoding=encoding||state.defaultEncoding;if(encoding!==state.encoding){chunk=new Buffer(chunk,encoding);encoding='';}}
return readableAddChunk(this,state,chunk,encoding,false);};Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,'',true);};function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er){stream.emit('error',er);}else if(chunk===null||chunk===undefined){state.reading=false;if(!state.ended)
onEofChunk(stream,state);}else if(state.objectMode||chunk&&chunk.length>0){if(state.ended&&!addToFront){var e=new Error('stream.push() after EOF');stream.emit('error',e);}else if(state.endEmitted&&addToFront){var e=new Error('stream.unshift() after end event');stream.emit('error',e);}else{if(state.decoder&&!addToFront&&!encoding)
chunk=state.decoder.write(chunk);state.length+=state.objectMode?1:chunk.length;if(addToFront){state.buffer.unshift(chunk);}else{state.reading=false;state.buffer.push(chunk);}
if(state.needReadable)
emitReadable(stream);maybeReadMore(stream,state);}}else if(!addToFront){state.reading=false;}
return needMoreData(state);}
function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||state.length===0);}
Readable.prototype.setEncoding=function(enc){if(!StringDecoder)
StringDecoder=require('string_decoder/').StringDecoder;this._readableState.decoder=new StringDecoder(enc);this._readableState.encoding=enc;};var MAX_HWM=0x800000;function roundUpToNextPowerOf2(n){if(n>=MAX_HWM){n=MAX_HWM;}else{n--;for(var p=1;p<32;p<<=1)n|=n>>p;n++;}
return n;}
function howMuchToRead(n,state){if(state.length===0&&state.ended)
return 0;if(state.objectMode)
return n===0?0:1;if(n===null||isNaN(n)){if(state.flowing&&state.buffer.length)
return state.buffer[0].length;else
return state.length;}
if(n<=0)
return 0;if(n>state.highWaterMark)
state.highWaterMark=roundUpToNextPowerOf2(n);if(n>state.length){if(!state.ended){state.needReadable=true;return 0;}else
return state.length;}
return n;}
Readable.prototype.read=function(n){var state=this._readableState;state.calledRead=true;var nOrig=n;var ret;if(typeof n!=='number'||n>0)
state.emittedReadable=false;if(n===0&&state.needReadable&&(state.length>=state.highWaterMark||state.ended)){emitReadable(this);return null;}
n=howMuchToRead(n,state);if(n===0&&state.ended){ret=null;if(state.length>0&&state.decoder){ret=fromList(n,state);state.length-=ret.length;}
if(state.length===0)
endReadable(this);return ret;}
var doRead=state.needReadable;if(state.length-n<=state.highWaterMark)
doRead=true;if(state.ended||state.reading)
doRead=false;if(doRead){state.reading=true;state.sync=true;if(state.length===0)
state.needReadable=true;this._read(state.highWaterMark);state.sync=false;}
if(doRead&&!state.reading)
n=howMuchToRead(nOrig,state);if(n>0)
ret=fromList(n,state);else
ret=null;if(ret===null){state.needReadable=true;n=0;}
state.length-=n;if(state.length===0&&!state.ended)
state.needReadable=true;if(state.ended&&!state.endEmitted&&state.length===0)
endReadable(this);return ret;};function chunkInvalid(state,chunk){var er=null;if(!Buffer.isBuffer(chunk)&&'string'!==typeof chunk&&chunk!==null&&chunk!==undefined&&!state.objectMode){er=new TypeError('Invalid non-string/buffer chunk');}
return er;}
function onEofChunk(stream,state){if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length){state.buffer.push(chunk);state.length+=state.objectMode?1:chunk.length;}}
state.ended=true;if(state.length>0)
emitReadable(stream);else
endReadable(stream);}
function emitReadable(stream){var state=stream._readableState;state.needReadable=false;if(state.emittedReadable)
return;state.emittedReadable=true;if(state.sync)
process.nextTick(function(){emitReadable_(stream);});else
emitReadable_(stream);}
function emitReadable_(stream){stream.emit('readable');}
function maybeReadMore(stream,state){if(!state.readingMore){state.readingMore=true;process.nextTick(function(){maybeReadMore_(stream,state);});}}
function maybeReadMore_(stream,state){var len=state.length;while(!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark){stream.read(0);if(len===state.length)
break;else
len=state.length;}
state.readingMore=false;}
Readable.prototype._read=function(n){this.emit('error',new Error('not implemented'));};Readable.prototype.pipe=function(dest,pipeOpts){var src=this;var state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest);break;}
state.pipesCount+=1;var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:cleanup;if(state.endEmitted)
process.nextTick(endFn);else
src.once('end',endFn);dest.on('unpipe',onunpipe);function onunpipe(readable){if(readable!==src)return;cleanup();}
function onend(){dest.end();}
var ondrain=pipeOnDrain(src);dest.on('drain',ondrain);function cleanup(){dest.removeListener('close',onclose);dest.removeListener('finish',onfinish);dest.removeListener('drain',ondrain);dest.removeListener('error',onerror);dest.removeListener('unpipe',onunpipe);src.removeListener('end',onend);src.removeListener('end',cleanup);if(!dest._writableState||dest._writableState.needDrain)
ondrain();}
function onerror(er){unpipe();dest.removeListener('error',onerror);if(EE.listenerCount(dest,'error')===0)
dest.emit('error',er);}
if(!dest._events||!dest._events.error)
dest.on('error',onerror);else if(isArray(dest._events.error))
dest._events.error.unshift(onerror);else
dest._events.error=[onerror,dest._events.error];function onclose(){dest.removeListener('finish',onfinish);unpipe();}
dest.once('close',onclose);function onfinish(){dest.removeListener('close',onclose);unpipe();}
dest.once('finish',onfinish);function unpipe(){src.unpipe(dest);}
dest.emit('pipe',src);if(!state.flowing){this.on('readable',pipeOnReadable);state.flowing=true;process.nextTick(function(){flow(src);});}
return dest;};function pipeOnDrain(src){return function(){var dest=this;var state=src._readableState;state.awaitDrain--;if(state.awaitDrain===0)
flow(src);};}
function flow(src){var state=src._readableState;var chunk;state.awaitDrain=0;function write(dest,i,list){var written=dest.write(chunk);if(false===written){state.awaitDrain++;}}
while(state.pipesCount&&null!==(chunk=src.read())){if(state.pipesCount===1)
write(state.pipes,0,null);else
forEach(state.pipes,write);src.emit('data',chunk);if(state.awaitDrain>0)
return;}
if(state.pipesCount===0){state.flowing=false;if(EE.listenerCount(src,'data')>0)
emitDataEvents(src);return;}
state.ranOut=true;}
function pipeOnReadable(){if(this._readableState.ranOut){this._readableState.ranOut=false;flow(this);}}
Readable.prototype.unpipe=function(dest){var state=this._readableState;if(state.pipesCount===0)
return this;if(state.pipesCount===1){if(dest&&dest!==state.pipes)
return this;if(!dest)
dest=state.pipes;state.pipes=null;state.pipesCount=0;this.removeListener('readable',pipeOnReadable);state.flowing=false;if(dest)
dest.emit('unpipe',this);return this;}
if(!dest){var dests=state.pipes;var len=state.pipesCount;state.pipes=null;state.pipesCount=0;this.removeListener('readable',pipeOnReadable);state.flowing=false;for(var i=0;i<len;i++)
dests[i].emit('unpipe',this);return this;}
var i=indexOf(state.pipes,dest);if(i===-1)
return this;state.pipes.splice(i,1);state.pipesCount-=1;if(state.pipesCount===1)
state.pipes=state.pipes[0];dest.emit('unpipe',this);return this;};Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if(ev==='data'&&!this._readableState.flowing)
emitDataEvents(this);if(ev==='readable'&&this.readable){var state=this._readableState;if(!state.readableListening){state.readableListening=true;state.emittedReadable=false;state.needReadable=true;if(!state.reading){this.read(0);}else if(state.length){emitReadable(this,state);}}}
return res;};Readable.prototype.addListener=Readable.prototype.on;Readable.prototype.resume=function(){emitDataEvents(this);this.read(0);this.emit('resume');};Readable.prototype.pause=function(){emitDataEvents(this,true);this.emit('pause');};function emitDataEvents(stream,startPaused){var state=stream._readableState;if(state.flowing){throw new Error('Cannot switch to old mode now.');}
var paused=startPaused||false;var readable=false;stream.readable=true;stream.pipe=Stream.prototype.pipe;stream.on=stream.addListener=Stream.prototype.on;stream.on('readable',function(){readable=true;var c;while(!paused&&(null!==(c=stream.read())))
stream.emit('data',c);if(c===null){readable=false;stream._readableState.needReadable=true;}});stream.pause=function(){paused=true;this.emit('pause');};stream.resume=function(){paused=false;if(readable)
process.nextTick(function(){stream.emit('readable');});else
this.read(0);this.emit('resume');};stream.emit('readable');}
Readable.prototype.wrap=function(stream){var state=this._readableState;var paused=false;var self=this;stream.on('end',function(){if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length)
self.push(chunk);}
self.push(null);});stream.on('data',function(chunk){if(state.decoder)
chunk=state.decoder.write(chunk);if(state.objectMode&&(chunk===null||chunk===undefined))
return;else if(!state.objectMode&&(!chunk||!chunk.length))
return;var ret=self.push(chunk);if(!ret){paused=true;stream.pause();}});for(var i in stream){if(typeof stream[i]==='function'&&typeof this[i]==='undefined'){this[i]=function(method){return function(){return stream[method].apply(stream,arguments);}}(i);}}
var events=['error','close','destroy','pause','resume'];forEach(events,function(ev){stream.on(ev,self.emit.bind(self,ev));});self._read=function(n){if(paused){paused=false;stream.resume();}};return self;};Readable._fromList=fromList;function fromList(n,state){var list=state.buffer;var length=state.length;var stringMode=!!state.decoder;var objectMode=!!state.objectMode;var ret;if(list.length===0)
return null;if(length===0)
ret=null;else if(objectMode)
ret=list.shift();else if(!n||n>=length){if(stringMode)
ret=list.join('');else
ret=Buffer.concat(list,length);list.length=0;}else{if(n<list[0].length){var buf=list[0];ret=buf.slice(0,n);list[0]=buf.slice(n);}else if(n===list[0].length){ret=list.shift();}else{if(stringMode)
ret='';else
ret=new Buffer(n);var c=0;for(var i=0,l=list.length;i<l&&c<n;i++){var buf=list[0];var cpy=Math.min(n-c,buf.length);if(stringMode)
ret+=buf.slice(0,cpy);else
buf.copy(ret,c,0,cpy);if(cpy<buf.length)
list[0]=buf.slice(cpy);else
list.shift();c+=cpy;}}}
return ret;}
function endReadable(stream){var state=stream._readableState;if(state.length>0)
throw new Error('endReadable called on non-empty stream');if(!state.endEmitted&&state.calledRead){state.ended=true;process.nextTick(function(){if(!state.endEmitted&&state.length===0){state.endEmitted=true;stream.readable=false;stream.emit('end');}});}}
function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i);}}
function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x)return i;}
return-1;}}).call(this,require('_process'))},{"_process":10,"buffer":2,"core-util-is":52,"events":6,"inherits":47,"isarray":53,"stream":22,"string_decoder/":54}],50:[function(require,module,exports){module.exports=Transform;var Duplex=require('./_stream_duplex');var util=require('core-util-is');util.inherits=require('inherits');util.inherits(Transform,Duplex);function TransformState(options,stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data);};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null;}
function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=false;var cb=ts.writecb;if(!cb)
return stream.emit('error',new Error('no writecb in Transform class'));ts.writechunk=null;ts.writecb=null;if(data!==null&&data!==undefined)
stream.push(data);if(cb)
cb(er);var rs=stream._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark){stream._read(rs.highWaterMark);}}
function Transform(options){if(!(this instanceof Transform))
return new Transform(options);Duplex.call(this,options);var ts=this._transformState=new TransformState(options,this);var stream=this;this._readableState.needReadable=true;this._readableState.sync=false;this.once('finish',function(){if('function'===typeof this._flush)
this._flush(function(er){done(stream,er);});else
done(stream);});}
Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding);};Transform.prototype._transform=function(chunk,encoding,cb){throw new Error('not implemented');};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)
this._read(rs.highWaterMark);}};Transform.prototype._read=function(n){var ts=this._transformState;if(ts.writechunk!==null&&ts.writecb&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform);}else{ts.needTransform=true;}};function done(stream,er){if(er)
return stream.emit('error',er);var ws=stream._writableState;var rs=stream._readableState;var ts=stream._transformState;if(ws.length)
throw new Error('calling transform done when ws.length != 0');if(ts.transforming)
throw new Error('calling transform done when still transforming');return stream.push(null);}},{"./_stream_duplex":48,"core-util-is":52,"inherits":47}],51:[function(require,module,exports){(function(process){module.exports=Writable;var Buffer=require('buffer').Buffer;Writable.WritableState=WritableState;var util=require('core-util-is');util.inherits=require('inherits');var Stream=require('stream');util.inherits(Writable,Stream);function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb;}
function WritableState(options,stream){options=options||{};var hwm=options.highWaterMark;this.highWaterMark=(hwm||hwm===0)?hwm:16*1024;this.objectMode=!!options.objectMode;this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||'utf8';this.length=0;this.writing=false;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er);};this.writecb=null;this.writelen=0;this.buffer=[];this.errorEmitted=false;}
function Writable(options){var Duplex=require('./_stream_duplex');if(!(this instanceof Writable)&&!(this instanceof Duplex))
return new Writable(options);this._writableState=new WritableState(options,this);this.writable=true;Stream.call(this);}
Writable.prototype.pipe=function(){this.emit('error',new Error('Cannot pipe. Not readable.'));};function writeAfterEnd(stream,state,cb){var er=new Error('write after end');stream.emit('error',er);process.nextTick(function(){cb(er);});}
function validChunk(stream,state,chunk,cb){var valid=true;if(!Buffer.isBuffer(chunk)&&'string'!==typeof chunk&&chunk!==null&&chunk!==undefined&&!state.objectMode){var er=new TypeError('Invalid non-string/buffer chunk');stream.emit('error',er);process.nextTick(function(){cb(er);});valid=false;}
return valid;}
Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState;var ret=false;if(typeof encoding==='function'){cb=encoding;encoding=null;}
if(Buffer.isBuffer(chunk))
encoding='buffer';else if(!encoding)
encoding=state.defaultEncoding;if(typeof cb!=='function')
cb=function(){};if(state.ended)
writeAfterEnd(this,state,cb);else if(validChunk(this,state,chunk,cb))
ret=writeOrBuffer(this,state,chunk,encoding,cb);return ret;};function decodeChunk(state,chunk,encoding){if(!state.objectMode&&state.decodeStrings!==false&&typeof chunk==='string'){chunk=new Buffer(chunk,encoding);}
return chunk;}
function writeOrBuffer(stream,state,chunk,encoding,cb){chunk=decodeChunk(state,chunk,encoding);if(Buffer.isBuffer(chunk))
encoding='buffer';var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(!ret)
state.needDrain=true;if(state.writing)
state.buffer.push(new WriteReq(chunk,encoding,cb));else
doWrite(stream,state,len,chunk,encoding,cb);return ret;}
function doWrite(stream,state,len,chunk,encoding,cb){state.writelen=len;state.writecb=cb;state.writing=true;state.sync=true;stream._write(chunk,encoding,state.onwrite);state.sync=false;}
function onwriteError(stream,state,sync,er,cb){if(sync)
process.nextTick(function(){cb(er);});else
cb(er);stream._writableState.errorEmitted=true;stream.emit('error',er);}
function onwriteStateUpdate(state){state.writing=false;state.writecb=null;state.length-=state.writelen;state.writelen=0;}
function onwrite(stream,er){var state=stream._writableState;var sync=state.sync;var cb=state.writecb;onwriteStateUpdate(state);if(er)
onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(stream,state);if(!finished&&!state.bufferProcessing&&state.buffer.length)
clearBuffer(stream,state);if(sync){process.nextTick(function(){afterWrite(stream,state,finished,cb);});}else{afterWrite(stream,state,finished,cb);}}}
function afterWrite(stream,state,finished,cb){if(!finished)
onwriteDrain(stream,state);cb();if(finished)
finishMaybe(stream,state);}
function onwriteDrain(stream,state){if(state.length===0&&state.needDrain){state.needDrain=false;stream.emit('drain');}}
function clearBuffer(stream,state){state.bufferProcessing=true;for(var c=0;c<state.buffer.length;c++){var entry=state.buffer[c];var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state.objectMode?1:chunk.length;doWrite(stream,state,len,chunk,encoding,cb);if(state.writing){c++;break;}}
state.bufferProcessing=false;if(c<state.buffer.length)
state.buffer=state.buffer.slice(c);else
state.buffer.length=0;}
Writable.prototype._write=function(chunk,encoding,cb){cb(new Error('not implemented'));};Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;if(typeof chunk==='function'){cb=chunk;chunk=null;encoding=null;}else if(typeof encoding==='function'){cb=encoding;encoding=null;}
if(typeof chunk!=='undefined'&&chunk!==null)
this.write(chunk,encoding);if(!state.ending&&!state.finished)
endWritable(this,state,cb);};function needFinish(stream,state){return(state.ending&&state.length===0&&!state.finished&&!state.writing);}
function finishMaybe(stream,state){var need=needFinish(stream,state);if(need){state.finished=true;stream.emit('finish');}
return need;}
function endWritable(stream,state,cb){state.ending=true;finishMaybe(stream,state);if(cb){if(state.finished)
process.nextTick(cb);else
stream.once('finish',cb);}
state.ended=true;}}).call(this,require('_process'))},{"./_stream_duplex":48,"_process":10,"buffer":2,"core-util-is":52,"inherits":47,"stream":22}],52:[function(require,module,exports){arguments[4][41][0].apply(exports,arguments)},{"../../../../../../../../../../../../../node_modules/browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js":8,"dup":41}],53:[function(require,module,exports){arguments[4][9][0].apply(exports,arguments)},{"dup":9}],54:[function(require,module,exports){arguments[4][23][0].apply(exports,arguments)},{"buffer":2,"dup":23}],55:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments)},{"./lib/_stream_transform.js":50,"dup":20}],56:[function(require,module,exports){(function(process){var Transform=require('readable-stream/transform'),inherits=require('util').inherits,xtend=require('xtend')
function DestroyableTransform(opts){Transform.call(this,opts)
this._destroyed=false}
inherits(DestroyableTransform,Transform)
DestroyableTransform.prototype.destroy=function(err){if(this._destroyed)return
this._destroyed=true
var self=this
process.nextTick(function(){if(err)
self.emit('error',err)
self.emit('close')})}
function noop(chunk,enc,callback){callback(null,chunk)}
function through2(construct){return function(options,transform,flush){if(typeof options=='function'){flush=transform
transform=options
options={}}
if(typeof transform!='function')
transform=noop
if(typeof flush!='function')
flush=null
return construct(options,transform,flush)}}
module.exports=through2(function(options,transform,flush){var t2=new DestroyableTransform(options)
t2._transform=transform
if(flush)
t2._flush=flush
return t2})
module.exports.ctor=through2(function(options,transform,flush){function Through2(override){if(!(this instanceof Through2))
return new Through2(override)
this.options=xtend(options,override)
DestroyableTransform.call(this,this.options)}
inherits(Through2,DestroyableTransform)
Through2.prototype._transform=transform
if(flush)
Through2.prototype._flush=flush
return Through2})
module.exports.obj=through2(function(options,transform,flush){var t2=new DestroyableTransform(xtend({objectMode:true,highWaterMark:16},options))
t2._transform=transform
if(flush)
t2._flush=flush
return t2})}).call(this,require('_process'))},{"_process":10,"readable-stream/transform":55,"util":25,"xtend":57}],57:[function(require,module,exports){module.exports=extend
var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){var target={}
for(var i=0;i<arguments.length;i++){var source=arguments[i]
for(var key in source){if(hasOwnProperty.call(source,key)){target[key]=source[key]}}}
return target}},{}],58:[function(require,module,exports){(function(process,Buffer){var through=require('through2')
var duplexify=require('duplexify')
var WS=require('ws')
module.exports=WebSocketStream
function WebSocketStream(target,protocols){var stream,socket
var socketWrite=process.title==='browser'?socketWriteBrowser:socketWriteNode
var proxy=through.obj(socketWrite,socketEnd)
if(typeof target==='object'){socket=target}else{socket=new WS(target,protocols)
socket.binaryType='arraybuffer'}
if(socket.readyState===1){stream=proxy}else{stream=duplexify.obj()
socket.addEventListener("open",onready)}
stream.socket=socket
socket.addEventListener("close",onclose)
socket.addEventListener("error",onerror)
socket.addEventListener("message",onmessage)
proxy.on('close',destroy)
function socketWriteNode(chunk,enc,next){socket.send(chunk,next)}
function socketWriteBrowser(chunk,enc,next){try{socket.send(chunk)}catch(err){return next(err)}
next()}
function socketEnd(done){socket.close()
done()}
function onready(){stream.setReadable(proxy)
stream.setWritable(proxy)
stream.emit('connect')}
function onclose(){stream.end();stream.destroy()}
function onerror(err){stream.destroy(err)}
function onmessage(event){var data=event.data
if(data instanceof ArrayBuffer)data=new Buffer(new Uint8Array(data))
else data=new Buffer(data)
proxy.push(data)}
function destroy(){socket.close()}
return stream}}).call(this,require('_process'),require("buffer").Buffer)},{"_process":10,"buffer":2,"duplexify":32,"through2":56,"ws":59}],59:[function(require,module,exports){var global=(function(){return this;})();var WebSocket=global.WebSocket||global.MozWebSocket;module.exports=WebSocket?ws:null;function ws(uri,protocols,opts){var instance;if(protocols){instance=new WebSocket(uri,protocols);}else{instance=new WebSocket(uri);}
return instance;}
if(WebSocket)ws.prototype=WebSocket.prototype;},{}],60:[function(require,module,exports){'use strict';var StreamHead=require('./streamhead');function StreamHeadClient(Plotly,GD,opts){this.statusCodes={'200':'Active stream - ok','308':'Stream had ended','400':'Invalid meta','404':'Requested token not registered','408':'Stream associated with this token not active','449':'Stream meta information changed, reload client','500':'Server Error','503':'Redis Error'};this.template={x:true,y:true,z:true,text:true,marker:{color:true,size:true},layout:true};this.cycleTime=opts.cycleTime||50;this.iv=null;this.StreamHead=null;this.autoreload=!!opts.autoreload;this.Plotly=Plotly;this.dataStream={};this.GD=GD;}
module.exports=StreamHeadClient;var proto=StreamHeadClient.prototype;proto.init=function init(){var self=this;var GD=this.GD;var fidx=GD.fid.indexOf(':');var dataStream=this.dataStream;var hasStream=false;this.fid=(fidx>-1)?GD.fid.slice(fidx+1):GD.fid;GD.data.forEach(function(data){if('stream'in data){hasStream=true;var token=data.stream.token;dataStream[token]={};dataStream[token].meta={token:token,head:data.stream.head||0,fid:self.fid};dataStream[token].active=false;dataStream[token].trace=data;}});if(!hasStream)return;this.Plotly.plot(GD);this.controlCycle();};proto.connect=function connect(opts){var dataStream=this.dataStream;this.StreamHead=StreamHead(opts).connect('t');var self=this;this.StreamHead.on('connect',function(){var token;for(token in dataStream){var meta=dataStream[token].meta;self.createRouteStream(meta);}});};proto.createRouteStream=function createRouteStream(meta){var self=this;var stream=this.StreamHead.createStream(meta);stream.on('error',function(msg){self.routeMsg(msg,meta);});stream.on('end',function(){self.routeMsg({code:308},meta);});stream.on('data',this.stream2Array(meta));};proto.routeMsg=function routeMsg(msg,meta){if(!('code'in msg))return;this.dataStream[meta.token].active=false;switch(msg.code){case 200:break;case 408:this.createRouteStream(meta);break;case 449:if(this.autoreload){location.reload();}else{this.createRouteStream(meta);}
break;default:break;}};proto.stream2Array=function stream2Array(meta){var self=this,dataStream=this.dataStream,trace=dataStream[meta.token].trace,Plotly=this.Plotly,GD=this.GD,template=this.template;return function(data){try{data=JSON.parse(data);}catch(e){return console.log('unparsable stream data');}
dataStream[meta.token].active=true;if(!self.iv){self.startPlotCycle();}
trace.stream.head=meta.head=data._id;for(var key in template){if(!(key in data)){continue;}
if(key==='marker'){if('color'in data.marker){if(Array.isArray(data.marker.color))trace.marker.color=data.marker.color;else{if(!Array.isArray(trace.marker.color))trace.marker.color=[];trace.marker.color.push(data.marker.color);if(trace.marker.color.length>trace.stream.maxpoints){trace.marker.color.shift();}}}
if('size'in data.marker){if(Array.isArray(data.marker.size))trace.marker.size=data.marker.size;else{if(!Array.isArray(trace.marker.size))trace.marker.size=[];trace.marker.size.push(data.marker.size);if(trace.marker.size.length>trace.stream.maxpoints){trace.marker.size.shift();}}}
continue;}
else if(key==='layout'){Plotly.relayout(GD,data.layout);}
else{if(Array.isArray(data[key]))trace[key]=data[key];else{if(!Array.isArray(trace[key]))trace[key]=[];trace[key].push(data[key]);if(trace[key].length>trace.stream.maxpoints)
trace[key].shift();}}}};};proto.controlCycle=function controlCycle(){var GD=this.GD;var self=this;clearInterval(this.controliv);this.controliv=setInterval(function(){if(GD.layout._hasGL3D)return;var DLEN=0;GD.calcdata.forEach(function(trace){DLEN+=trace.length;});self.cycleTime=Math.min(Math.max(DLEN/4.5,50),2000);if(self.allStreamsUnactive()){self.stopPlotCycle();}},1000);};proto.startPlotCycle=function cyclePlot(){var Plotly=this.Plotly;var GD=this.GD;clearInterval(this.plotiv);this.plotiv=setInterval(function(){GD.calcdata=false;Plotly.plot(GD);},this.cycleTime);};proto.stopPlotCycle=function stopCycle(){clearInterval(this.plotiv);this.plotiv=null;};proto.allStreamsUnactive=function allStreamsUnactive(){var dataStream=this.dataStream;var token,unactive=true;for(token in dataStream){unactive=unactive&&!dataStream[token].active;}
console.log('stream activity:',!unactive);return unactive;};},{"./streamhead":61}],61:[function(require,module,exports){(function(process){'use strict';var websocket=require('websocket-stream'),MuxDemux=require('mux-demux'),util=require('util'),EventEmitter=require('events').EventEmitter;function StreamHead(opts){if(!(this instanceof StreamHead))return new StreamHead(opts);EventEmitter.call(this);if(!opts)opts={};this.PORT=opts.port||10201;this.HOST=opts.host||'localhost';this.WSS=(this.PORT===443)?'wss://':'ws://';this.TIMEOUT=opts.timeout||30*1000;this.heartbeativ=null;this.mockSocket=opts.mockSocket;this._connected=false;}
util.inherits(StreamHead,EventEmitter);module.exports=StreamHead;var proto=StreamHead.prototype;proto.connect=function connect(){var self=this;var ws;if(this._connected)return this;ws=this.ws=websocket(this.WSS+this.HOST+':'+this.PORT);var mx=self.mx=MuxDemux();ws.pipe(mx).pipe(ws);mx.on('error',function(err){ws.destroy();self.close(err);});ws.on('error',function(err){mx.destroy();self.close(err);});ws.on('end',function(){self.close();});process.nextTick(function(){self._connected=true;self.emit('connect');});return self;};proto.close=function close(err){clearInterval(this.heartbeativ);if(!this._connected)return;this._connected=false;this.ws.end();this.mx.close();this.mx.destroy();if(err)this.emit('error',err);else this.emit('close',err);};proto.createStream=function createStream(meta){var stream=this.mx.createStream(meta),heartbeat=false;stream.once('error',function(){clearInterval(stream.heartbeativ);stream.destroy();});stream.once('end',function(){clearInterval(stream.heartbeativ);});stream.on('data',function(){heartbeat=true;});stream.heartbeativ=setInterval(function(){if(!heartbeat){clearInterval(stream.heartbeativ);stream.emit('error',{msg:'timeout',code:408});}else{heartbeat=false;}},this.TIMEOUT);return stream;};}).call(this,require('_process'))},{"_process":10,"events":6,"mux-demux":26,"util":25,"websocket-stream":58}]},{},[60])(60)});